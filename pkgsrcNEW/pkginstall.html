<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Chapter 20. The pkginstall framework</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<style>

.previous {
    text-decoration: none;
    display: inline-block;
    padding: 9px 16px;
    background-color: #f1f1f1;
    color: black;
}
.index {
    text-decoration: none;
    display: inline-block;
    padding: 9px 16px;
    background-color: #f1f1f1;
    color: black;

}
.next {
    text-decoration: none;
    display: inline-block;
    padding: 9px 16px;
    background-color: #FF4500;
    color: white;
    float: right !important;}

#myBtn {
  #display: none; /* Hidden by default */
  position: fixed; /* Fixed/sticky position */
  bottom: 20px; /* Place the button at the bottom of the page */
  right: 30px; /* Place the button 30px from the right */
  z-index: 99; /* Make sure it does not overlap */
  border: none; /* Remove borders */
  outline: none; /* Remove outline */
  background-color: #FF4500; /* Set a background color */
  color: white; /* Text color */
  cursor: pointer; /* Add a mouse pointer on hover */
  padding: 15px; /* Some padding */
  border-radius: 10px; /* Rounded corners */
  font-size: 18px; /* Increase font size */
}

#myBtn:hover {
  background-color: #555; /* Add a dark-grey background on hover */
}

</style>
<script>
//Get the button
var mybutton = document.getElementById("myBtn");

// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>


<a href="https://jaypatelani.github.io/trydocs/pkgsrcNEW/plist.html" class="previous">&laquo; Previous</a>
<a href="https://jaypatelani.github.io/trydocs/pkgsrcNEW/index.html" class="previous">&laquo; Index</a>
<a href="https://jaypatelani.github.io/trydocs/pkgsrcNEW/fixes.html" class="next">Next &raquo;</a>

<button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
<div id="header">
<h1>Chapter 20. The pkginstall framework</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_20_1_files_and_directories_outside_the_installation_prefix">20.1. Files and directories outside the installation prefix</a>
<ul class="sectlevel2">
<li><a href="#_20_1_1_directory_manipulation">20.1.1. Directory manipulation</a></li>
<li><a href="#_20_1_2_file_manipulation">20.1.2. File manipulation</a></li>
</ul>
</li>
<li><a href="#_20_2_configuration_files">20.2. Configuration files</a>
<ul class="sectlevel2">
<li><a href="#_20_2_1_how_pkg_sysconfdir_is_set">20.2.1. How PKG_SYSCONFDIR is set</a></li>
<li><a href="#_20_2_2_telling_the_software_where_configuration_files_are">20.2.2. Telling the software where configuration files are</a></li>
<li><a href="#_20_2_3_patching_installations">20.2.3. Patching installations</a></li>
<li><a href="#_20_2_4_disabling_handling_of_configuration_files">20.2.4. Disabling handling of configuration files</a></li>
</ul>
</li>
<li><a href="#_20_3_system_startup_scripts">20.3. System startup scripts</a>
<ul class="sectlevel2">
<li><a href="#_20_3_1_disabling_handling_of_system_startup_scripts">20.3.1. Disabling handling of system startup scripts</a></li>
</ul>
</li>
<li><a href="#_20_4_system_users_and_groups">20.4. System users and groups</a></li>
<li><a href="#_20_5_system_shells">20.5. System shells</a>
<ul class="sectlevel2">
<li><a href="#_20_5_1_disabling_shell_registration">20.5.1. Disabling shell registration</a></li>
</ul>
</li>
<li><a href="#_20_6_fonts">20.6. Fonts</a>
<ul class="sectlevel2">
<li><a href="#_20_6_1_disabling_automatic_update_of_the_fonts_databases">20.6.1. Disabling automatic update of the fonts databases</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>This chapter describes the framework known as <code>pkginstall</code>, whose key features are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Generic installation and manipulation of directories and files outside the pkgsrc-handled tree, <code>LOCALBASE</code>.</p>
</li>
<li>
<p>Automatic handling of configuration files during installation, provided that packages are correctly designed.</p>
</li>
<li>
<p>Generation and installation of system startup scripts.</p>
</li>
<li>
<p>Registration of system users and groups.</p>
</li>
<li>
<p>Registration of system shells.</p>
</li>
<li>
<p>Automatic updating of fonts databases.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sections inspect each of the above points in detail.</p>
</div>
<div class="paragraph">
<p>You may be thinking that many of the things described here could be easily done with simple code in the package&#8217;s post-installation target (<code>post-install</code>).  <em>This is incorrect</em>, as the code in them is only executed when building from source. Machines using binary packages could not benefit from it at all (as the code itself could be unavailable). Therefore, the only way to achieve any of the items described above is by means of the installation scripts, which are automatically generated by pkginstall.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_20_1_files_and_directories_outside_the_installation_prefix">20.1. Files and directories outside the installation prefix</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As you already know, the <code>PLIST</code> file holds a list of files and directories that belong to a package. The names used in it are relative to the installation prefix (<code>${PREFIX}</code>), which means that it cannot register files outside this directory (absolute path names are not allowed). Despite this restriction, some packages need to install files outside this location; e.g., under <code>${VARBASE}</code> or <code>${PKG_SYSCONFDIR}</code>. The only way to achieve this is to create such files during installation time by using installation scripts.</p>
</div>
<div class="paragraph">
<p>The generic installation scripts are shell scripts that can
contain arbitrary code.  The list of scripts to execute is taken from
the <code>INSTALL_FILE</code> variable, which defaults to
<code>INSTALL</code>.  A similar variable exists for package
removal (<code>DEINSTALL_FILE</code>, whose default is
<code>DEINSTALL</code>).  These scripts can run arbitrary
commands, so they have the potential to create and manage files
anywhere in the file system.</p>
</div>
<div class="paragraph">
<p>Using these general installation files is not recommended, but may be needed in some special cases. One reason for avoiding them is that the user has to trust the packager that there is no unwanted or simply erroneous code included in the installation script. Also, previously there were many similar scripts for the same functionality, and fixing a common error involved finding and changing all of them.</p>
</div>
<div class="paragraph">
<p>The pkginstall framework offers another, standardized way. It provides generic scripts to abstract the manipulation of such files and directories based on variables set in the package&#8217;s <code>Makefile</code>. The rest of this section describes these variables.</p>
</div>
<div class="sect2">
<h3 id="_20_1_1_directory_manipulation">20.1.1. Directory manipulation</h3>
<div class="paragraph">
<p>The following variables can be set to request the creation of directories anywhere in the file system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>MAKE_DIRS</code> and <code>OWN_DIRS</code> contain a list of directories that should be created and should attempt to be destroyed by the installation scripts. The difference between the two is that the latter prompts the administrator to remove any directories that may be left after deinstallation (because they were not empty), while the former does not. Example:</p>
<div class="literalblock">
<div class="content">
<pre>MAKE_DIRS+=             ${VARBASE}/foo/private</pre>
</div>
</div>
</li>
<li>
<p><code>MAKE_DIRS_PERMS</code> and <code>OWN_DIRS_PERMS</code> contain a list of tuples describing which directories should be created and should attempt to be destroyed by the installation scripts. Each tuple holds the following values, separated by spaces: the directory name, its owner, its group and its numerical mode. For example:</p>
<div class="literalblock">
<div class="content">
<pre>MAKE_DIRS_PERMS+=       ${VARBASE}/foo/private \
                        ${REAL_ROOT_USER} ${REAL_ROOT_GROUP} 0700</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The difference between the two is exactly the same as their non-PERMS counterparts.</p>
</div>
</div>
<div class="sect2">
<h3 id="_20_1_2_file_manipulation">20.1.2. File manipulation</h3>
<div class="paragraph">
<p>Creating non-empty files outside the installation prefix is tricky because the <code>PLIST</code> forces all files to be inside it. To overcome this problem, the only solution is to extract the file in the known place (i.e., inside the installation prefix) and copy it to the appropriate location during installation (done by the installation scripts generated by pkginstall). We will call the former the <em>master file</em> in the following paragraphs, which describe the variables that can be used to automatically and consistently handle files outside the installation prefix:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CONF_FILES</code> and <code>REQD_FILES</code> are pairs of master and target files. During installation time, the master file is copied to the target one if and only if the latter does not exist. Upon deinstallation, the target file is removed provided that it was not modified by the installation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The difference between the two is that the latter prompts the administrator to remove any files that may be left after deinstallation (because they were not empty), while the former does not.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CONF_FILES_PERMS</code> and <code>REQD_FILES_PERMS</code> contain tuples describing master files as well as their target locations. For each of them, it also specifies their owner, their group and their numeric permissions, in this order.  For example:</p>
<div class="literalblock">
<div class="content">
<pre>REQD_FILES_PERMS+=      ${PREFIX}/share/somefile ${VARBASE}/somefile \
                        ${REAL_ROOT_USER} ${REAL_ROOT_GROUP} 0700</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The difference between the two is exactly the same as their non-PERMS counterparts.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_20_2_configuration_files">20.2. Configuration files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Configuration files are special in the sense that they are installed in their own specific directory, <code>PKG_SYSCONFDIR</code>, and need special treatment during installation (most of which is automated by pkginstall). The main concept you must bear in mind is that files marked as configuration files are automatically copied to the right place (somewhere inside <code>PKG_SYSCONFDIR</code>) during installation <em>if and only if</em> they didn&#8217;t exist before. Similarly, they will not be removed if they have local modifications. This ensures that administrators never lose any custom changes they may have made.</p>
</div>
<div class="sect2">
<h3 id="_20_2_1_how_pkg_sysconfdir_is_set">20.2.1. How PKG_SYSCONFDIR is set</h3>
<div class="paragraph">
<p>As said before, the <code>PKG_SYSCONFDIR</code> variable specifies where configuration files shall be installed. Its contents are set based upon the following variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PKG_SYSCONFBASE</code>: The configuration&#8217;s root directory. Defaults to <code>${PREFIX}/etc</code> although it may be overridden by the user to point t his preferred location (e.g., <code>/etc</code>, <code>/etc/pkg</code>, etc.). Packages must not use it directly.</p>
</li>
<li>
<p><code>PKG_SYSCONFSUBDIR</code>: A subdirectory of <code>PKG_SYSCONFBASE</code> under which the configuration files for the package being built shall be installed. The definition of this variable only makes sense in the package&#8217;s <code>Makefile</code> (i.e., it is not user-customizable).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As an example, consider the Apache package, <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/www/apache24/index.html"><code>www/apache24</code></a>, which places its configuration files under the <code>httpd/</code> subdirectory of <code>PKG_SYSCONFBASE</code>. This should be set in the package Makefile.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PKG_SYSCONFVAR</code>: Specifies the name of the variable that holds this package&#8217;s configuration directory (if different from <code>PKG_SYSCONFBASE</code>). It defaults to <code>PKGBASE</code>'s value, and is always prefixed with <code>PKG_SYSCONFDIR</code>.</p>
</li>
<li>
<p><code>PKG_SYSCONFDIR.${PKG_SYSCONFVAR}</code>: Holds the directory where the configuration files for the package identified by <code>PKG_SYSCONFVAR</code>'s shall be placed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Based on the above variables, pkginstall determines the value of <code>PKG_SYSCONFDIR</code>, which is the <em>only</em> variable that can be used within a package to refer to its configuration directory. The algorithm used to set its value is basically the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>PKG_SYSCONFDIR.${PKG_SYSCONFVAR}</code> is set, its value is used.</p>
</li>
<li>
<p>If the previous variable is not defined but <code>PKG_SYSCONFSUBDIR</code> is set in the package&#8217;s <code>Makefile</code>, the resulting value is <code>${PKG_SYSCONFBASE}/${PKG_SYSCONFSUBDIR}</code>.</p>
</li>
<li>
<p>Otherwise, it is set to <code>${PKG_SYSCONFBASE}</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It is worth mentioning that <code>${PKG_SYSCONFDIR}</code> is automatically added to <code>OWN_DIRS</code>. See <a href="https://www.netbsd.org/docs/pkgsrc/pkginstall.html#dirs-outside-prefix">Section 20.1.1, “Directory manipulation”</a> what this means. This does not apply to subdirectories of <code>${PKG_SYSCONFDIR}</code>, they still have to be created with OWN_DIRS or MAKE_DIRS.</p>
</div>
</div>
<div class="sect2">
<h3 id="_20_2_2_telling_the_software_where_configuration_files_are">20.2.2. Telling the software where configuration files are</h3>
<div class="paragraph">
<p>Given that pkgsrc (and users!) expect configuration files to be in a known place, you need to teach each package where it shall install its files. In some cases you will have to patch the package Makefiles to achieve it. If you are lucky, though, it may be as easy as passing an extra flag to the configuration script; this is the case of GNU Autoconf- generated files:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CONFIGURE_ARGS+= --sysconfdir=${PKG_SYSCONFDIR}</pre>
</div>
</div>
<div class="paragraph">
<p>Note that this specifies where the package has to <em>look for</em> its configuration files, not where they will be originally installed (although the difference is never explicit, unfortunately).</p>
</div>
</div>
<div class="sect2">
<h3 id="_20_2_3_patching_installations">20.2.3. Patching installations</h3>
<div class="paragraph">
<p>As said before, pkginstall automatically handles configuration files. This means that <strong>the packages themselves must not touch the contents of <code>${PKG_SYSCONFDIR}</code> directly</strong>. Bad news is that many software installation scripts will, out of the box, mess with the contents of that directory. So what is the correct procedure to fix this issue?</p>
</div>
<div class="paragraph">
<p>You must teach the package (usually by manually patching it) to install any configuration files under the examples hierarchy, <code>share/examples/${PKGBASE}/</code>. This way, the <code>PLIST</code> registers them and the administrator always has the original copies available.</p>
</div>
<div class="paragraph">
<p>Once the required configuration files are in place (i.e., under the examples hierarchy), the pkginstall framework can use them as master copies during the package installation to update what is in <code>${PKG_SYSCONFDIR}</code>. To achieve this, the variables <code>CONF_FILES</code> and <code>CONF_FILES_PERMS</code> are used. Check out <a href="https://www.netbsd.org/docs/pkgsrc/pkginstall.html#files-outside-prefix">Section 20.1.2, “File manipulation”</a> for information about their syntax and their purpose.  Here is an example, taken from the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/mail/mutt/index.html"><code>mail/mutt</code></a> package:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>EGDIR=        ${PREFIX}/share/doc/mutt/samples
CONF_FILES=   ${EGDIR}/Muttrc ${PKG_SYSCONFDIR}/Muttrc</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the EGDIR variable is specific to that package and has no meaning outside it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_20_2_4_disabling_handling_of_configuration_files">20.2.4. Disabling handling of configuration files</h3>
<div class="paragraph">
<p>The automatic copying of config files can be toggled by setting the environment variable <code>PKG_CONFIG</code> prior to package installation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_20_3_system_startup_scripts">20.3. System startup scripts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>System startup scripts are special files because they must be installed in a place known by the underlying OS, usually outside the installation prefix. Therefore, the same rules described in <a href="https://www.netbsd.org/docs/pkgsrc/pkginstall.html#files-and-dirs-outside-prefix">Section 20.1, “Files and directories outside the installation prefix”</a> apply, and the same solutions can be used. However, pkginstall provides a special mechanism to handle these files.</p>
</div>
<div class="paragraph">
<p>In order to provide system startup scripts, the package has to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Store the script inside <code>${FILESDIR}</code>, with the <code>.sh</code> suffix appended. Considering the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/print/cups-base/index.html"><code>print/cups-base</code></a> package as an example, it has a <code>cupsd.sh</code> in its files directory.</p>
</li>
<li>
<p>Tell pkginstall to handle it, appending the name of the script, without its extension, to the <code>RCD_SCRIPTS</code> variable. Continuing the previous example:</p>
<div class="literalblock">
<div class="content">
<pre>RCD_SCRIPTS+=   cupsd</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once this is done, pkginstall will do the following steps for each script in an automated fashion:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Process the file found in the files directory applying all the substitutions described in the <code>FILES_SUBST</code> variable.</p>
</li>
<li>
<p>Copy the script from the files directory to the examples hierarchy, <code>${PREFIX}/share/examples/rc.d/</code>. Note that this master file must be explicitly registered in the <code>PLIST</code>.</p>
</li>
<li>
<p>Add code to the installation scripts to copy the startup script from the examples hierarchy into the system-wide startup scripts directory.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_20_3_1_disabling_handling_of_system_startup_scripts">20.3.1. Disabling handling of system startup scripts</h3>
<div class="paragraph">
<p>The automatic copying of config files can be toggled by setting the environment variable <code>PKG_RCD_SCRIPTS</code> prior to package installation. Note that the scripts will be always copied inside the examples hierarchy, <code>${PREFIX}/share/examples/rc.d/</code>, no matter what the value of this variable is.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_20_4_system_users_and_groups">20.4. System users and groups</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If a package needs to create special users and/or groups during installation, it can do so by using the pkginstall framework.</p>
</div>
<div class="paragraph">
<p>Users can be created by adding entries to the <code>PKG_USERS</code> variable. Each entry has the following syntax:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>user:group</pre>
</div>
</div>
<div class="paragraph">
<p>Further specification of user details may be done by setting per-user variables. <code>PKG_UID.<em>user</code></em> is the numeric UID for the user. <code>PKG_GECOS.<em>user</code></em> is the user&#8217;s description or comment. <code>PKG_HOME.<em>user</code></em> is the user&#8217;s home directory, and defaults to <code>/nonexistent</code> if not specified. <code>PKG_SHELL.<em>user</code></em> is the user&#8217;s shell, and defaults to <code>/sbin/nologin</code> if not specified.</p>
</div>
<div class="paragraph">
<p>Similarly, groups can be created by adding entries to the <code>PKG_GROUPS</code> variable, whose syntax is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>group</pre>
</div>
</div>
<div class="paragraph">
<p>The numeric GID of the group may be set by defining <code>PKG_GID.<em>group</code></em>.</p>
</div>
<div class="paragraph">
<p>If a package needs to create the users and groups at an earlier stage, then it can set <code>USERGROUP_PHASE</code> to either <code>configure</code>,<code>build</code>, or <code>pre-install</code> to indicate the phase before which the users and groups are created. In this case, the numeric UIDs and GIDs of the created users and groups are automatically hardcoded into the final installation scripts.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_20_5_system_shells">20.5. System shells</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Packages that install system shells should register them in the shell database, <code>/etc/shells</code>, to make things easier to the administrator. This must be done from the installation scripts to keep binary packages working on any system. pkginstall provides an easy way to accomplish this task.</p>
</div>
<div class="paragraph">
<p>When a package provides a shell interpreter, it has to set the <code>PKG_SHELL</code> variable to its absolute file name. This will add some hooks to the installation scripts to handle it. Consider the following example, taken from <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/shells/zsh/index.html"><code>shells/zsh</code></a>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PKG_SHELL=      ${PREFIX}/bin/zsh</pre>
</div>
</div>
<div class="sect2">
<h3 id="_20_5_1_disabling_shell_registration">20.5.1. Disabling shell registration</h3>
<div class="paragraph">
<p>The automatic registration of shell interpreters can be disabled by the administrator by setting the <code>PKG_REGISTER_SHELLS</code> environment variable to <code>NO</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_20_6_fonts">20.6. Fonts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Packages that install X11 fonts should update the database files that index the fonts within each fonts directory. This can easily be accomplished within the pkginstall framework.</p>
</div>
<div class="paragraph">
<p>When a package installs X11 fonts, it must list the directories in which fonts are installed in the <code>FONTS_DIRS.<em>type</code></em> variables, where <em><code>type</code></em> can be one of “ttf”, “type1” or “x11”.  This will add hooks to the installation scripts to run the appropriate commands to update the fonts database files within each of those directories. For convenience, if the directory path is relative, it is taken to be relative to the package&#8217;s installation prefix. Consider the following example, taken from <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/fonts/dbz-ttf/index.html"><code>fonts/dbz-ttf</code></a>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>FONTS_DIRS.ttf= ${PREFIX}/share/fonts/X11/TTF</pre>
</div>
</div>
<div class="sect2">
<h3 id="_20_6_1_disabling_automatic_update_of_the_fonts_databases">20.6.1. Disabling automatic update of the fonts databases</h3>
<div class="paragraph">
<p>The automatic update of fonts databases can be disabled by the administrator by setting the <code>PKG_UPDATE_FONTS_DB</code> environment variable to <code>NO</code>.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-07-07 06:24:23 UTC
</div>
</div>
</body>
</html>