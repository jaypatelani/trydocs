<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<title>Chapter 14. Creating a new pkgsrc package from scratch</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<style>

.previous {
    text-decoration: none;
    display: inline-block;
    padding: 9px 16px;
    background-color: #f1f1f1;
    color: black;
}
.index {
    text-decoration: none;
    display: inline-block;
    padding: 9px 16px;
    background-color: #f1f1f1;
    color: black;

}
.next {
    text-decoration: none;
    display: inline-block;
    padding: 9px 16px;
    background-color: #FF4500;
    color: white;
    float: right !important;}

#myBtn {
  #display: none; /* Hidden by default */
  position: fixed; /* Fixed/sticky position */
  bottom: 20px; /* Place the button at the bottom of the page */
  right: 30px; /* Place the button 30px from the right */
  z-index: 99; /* Make sure it does not overlap */
  border: none; /* Remove borders */
  outline: none; /* Remove outline */
  background-color: #FF4500; /* Set a background color */
  color: white; /* Text color */
  cursor: pointer; /* Add a mouse pointer on hover */
  padding: 15px; /* Some padding */
  border-radius: 10px; /* Rounded corners */
  font-size: 18px; /* Increase font size */
}

#myBtn:hover {
  background-color: #555; /* Add a dark-grey background on hover */
}

</style>
<script>
//Get the button
var mybutton = document.getElementById("myBtn");

// When the user scrolls down 20px from the top of the document, show the button
window.onscroll = function() {scrollFunction()};

function scrollFunction() {
  if (document.body.scrollTop > 20 || document.documentElement.scrollTop > 20) {
    mybutton.style.display = "block";
  } else {
    mybutton.style.display = "none";
  }
}

// When the user clicks on the button, scroll to the top of the document
function topFunction() {
  document.body.scrollTop = 0;
  document.documentElement.scrollTop = 0;
}
</script>


<a href="https://jaypatelani.github.io/trydocs/pkgsrcNEW/build.html" class="previous">&laquo; Previous</a>
<a href="https://jaypatelani.github.io/trydocs/pkgsrcNEW/index.html" class="previous">&laquo; Index</a>
<a href="https://jaypatelani.github.io/trydocs/pkgsrcNEW/makefile.html" class="next">Next &raquo;</a>

<button onclick="topFunction()" id="myBtn" title="Go to top">Top</button>
<div id="header">
<h1>Chapter 14. Creating a new pkgsrc package from scratch</h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_14_1_common_types_of_packages">14.1. Common types of packages</a>
<ul class="sectlevel2">
<li><a href="#_14_1_1_python_modules_and_programs">14.1.1. Python modules and programs</a></li>
<li><a href="#_14_1_2_r_packages">14.1.2. R packages</a></li>
<li><a href="#_14_1_3_texlive_packages">14.1.3. TeXlive packages</a></li>
</ul>
</li>
<li><a href="#_14_2_examples">14.2. Examples</a>
<ul class="sectlevel2">
<li><a href="#_14_2_1_how_the_wwwnvu_package_came_into_pkgsrc">14.2.1. How the www/nvu package came into pkgsrc</a>
<ul class="sectlevel3">
<li><a href="#_14_2_1_1_the_initial_package">14.2.1.1. The initial package</a></li>
<li><a href="#_14_2_1_2_fixing_all_kinds_of_problems_to_make_the_package_work">14.2.1.2. Fixing all kinds of problems to make the package work</a></li>
<li><a href="#_14_2_1_3_installing_the_package">14.2.1.3. Installing the package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>When you find a package that is not yet in pkgsrc, you most likely have a URL from where you can download the source code. Starting with this URL, creating a package involves only a few steps.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>, set <code>PKG_DEVELOPER=yes</code> to enable the basic quality checks.</p>
</li>
<li>
<p>Install the package <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/meta-pkgs/pkg_developer/index.html"><code>meta-pkgs/pkg_developer</code></a>, which among others will install the utilities <strong>url2pkg</strong>, <strong>pkglint</strong>, <strong>pkgvi</strong> and <strong>mkpatches</strong>:</p>
<div class="literalblock">
<div class="content">
<pre>$ cd /usr/pkgsrc
$ (cd meta-pkgs/pkg_developer &amp;&amp; bmake update)</pre>
</div>
</div>
</li>
<li>
<p>Choose one of the top-level directories as the category in which you want to place your package. You can also create a directory of your own (maybe called <code>local</code>). Change into that category directory:</p>
<div class="literalblock">
<div class="content">
<pre>$ cd category</pre>
</div>
</div>
</li>
<li>
<p>Run the program <strong>url2pkg</strong>, passing as argument the URL of the distribution file (in most cases a <code>.tar.gz</code> file). This will download the distribution file and create the necessary files of the package, based on what&#8217;s in the distribution file:</p>
<div class="literalblock">
<div class="content">
<pre>$ url2pkg https://www.example.org/packages/package-1.0.tar.gz</pre>
</div>
</div>
</li>
<li>
<p>Examine the extracted files to determine the dependencies of your package. Ideally, this is mentioned in some <code>README</code> file, but things may differ. For each of these dependencies, look where it exists in pkgsrc, and if there is a file called <code>buildlink3.mk</code> in that directory, add a line to your package <code>Makefile</code> which includes that file just before the last line. If the <code>buildlink3.mk</code> file does not exist, it must be created first. The <code>buildlink3.mk</code> file makes sure that the package&#8217;s include files and libraries are provided.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you just need binaries from a dependent package, add a <code>DEPENDS</code> line to the Makefile, which specifies the version of the dependency and where it can be found in pkgsrc. This line should be placed in the third paragraph. If the dependency is only needed for building the package, but not when using it, use <code>TOOL_DEPENDS</code> or <code>BUILD_DEPENDS</code> instead of <code>DEPENDS</code>. The difference between <code>TOOL_DEPENDS</code> and <code>BUILD_DEPENDS</code> occurs when cross-compiling: <code>TOOL_DEPENDS</code> are <em>native</em> packages, i.e. packages for the platform where the package is built; <code>BUILD_DEPENDS</code> are <em>target</em> packages, i.e. packages for the platform for which the package is built. There is also <code>TEST_DEPENDS</code>, which specifies a dependency used only for testing the resulting package built, using the upstream project&#8217;s included test suite, on the native platform.
Your package may then look like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[...]
TOOL_DEPENDS+=  libxslt-[0-9]*:../../textproc/libxslt
DEPENDS+=       screen-[0-9]*:../../misc/screen
DEPENDS+=       screen&gt;=4.0:../../misc/screen
[...]
.include "../../category/package/buildlink3.mk"
.include "../../devel/glib2/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"</pre>
</div>
</div>
<div class="paragraph">
<p>6.Run <strong>pkglint</strong> to see what things still need to be done to make your package a “good” one. If you don&#8217;t know what pkglint&#8217;s warnings want to tell you, try <strong>pkglint --explain</strong> or <strong>pkglint -e</strong>, which outputs additional explanations.</p>
</div>
<div class="paragraph">
<p>7.In many cases the package is not yet ready to build. You can find instructions for the most common cases in the next section, <a href="https://www.netbsd.org/docs/pkgsrc/creating.html#creating.common">Section 14.1, “Common types of packages”</a>. After you have followed the instructions over there, you can hopefully continue here.</p>
</div>
<div class="paragraph">
<p>8.Run <strong>bmake clean</strong> to clean the working directory from the extracted files. Besides these files, a lot of cache files and other system information have been saved in the working directory, which may have become outdated after you edited the <code>Makefile</code>.</p>
</div>
<div class="paragraph">
<p>9.Now, run <strong>bmake</strong> to build the package. For the various things that can go wrong in this phase, consult <a href="https://www.netbsd.org/docs/pkgsrc/fixes.html">Chapter 21, Making your package work</a>.</p>
</div>
<div class="paragraph">
<p>If the extracted files from the package need to be fixed, run multiple rounds of these commands:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ bmake
$ pkgvi ${WRKSRC}/some/file/that/does/not/compile
$ mkpatches
$ bmake mps
$ bmake clean</pre>
</div>
</div>
<div class="paragraph">
<p>10.When the package builds fine, the next step is to install the package. Run <strong>bmake install</strong> and hope that everything works.</p>
</div>
<div class="paragraph">
<p>11.Up to now, the file <code>PLIST</code>, which contains a list of the files that are installed by the package, is nearly empty. Run <strong>bmake print-PLIST &gt;PLIST</strong> to generate a probably correct list. Check the file using your preferred text editor to see if the list of files looks plausible.</p>
</div>
<div class="paragraph">
<p>12.Run <strong>pkglint</strong> again to see if the generated <code>PLIST</code> contains garbage or not.</p>
</div>
<div class="paragraph">
<p>13.When you ran <strong>bmake install</strong>, the package had been registered in the database of installed files, but with an empty list of files. To fix this, run <strong>bmake deinstall</strong> and <strong>bmake install</strong> again. Now the package is registered with the list of files from <code>PLIST</code>.</p>
</div>
<div class="paragraph">
<p>14.Run <strong>bmake clean update</strong> to run everything from above again in a single step, making sure that the PLIST is correct and the whole package is created as intended.</p>
</div>
<div class="paragraph">
<p>15.Run <strong>pkglint</strong> to see if there&#8217;s anything left to do.</p>
</div>
<div class="paragraph">
<p>16.Commit the package to pkgsrc-wip or main pkgsrc; see <a href="https://www.netbsd.org/docs/pkgsrc/submit.html">Chapter 23, Submitting and Committing</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_14_1_common_types_of_packages">14.1. Common types of packages</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_14_1_1_python_modules_and_programs">14.1.1. Python modules and programs</h3>
<div class="paragraph">
<p>Python modules and programs packages are easily created using a set of predefined variables.</p>
</div>
<div class="paragraph">
<p>If some Python versions are not supported by the software, set the <code>PYTHON_VERSIONS_INCOMPATIBLE</code> variable to the Python versions that are not supported, e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PYTHON_VERSIONS_INCOMPATIBLE=       27</pre>
</div>
</div>
<div class="paragraph">
<p>If the packaged software is a Python module, include one of <code>../../lang/python/egg.mk</code> or <code>../../lang/python/extension.mk</code>.</p>
</div>
<div class="paragraph">
<p>Most Python packages use setuptools (“eggs”). If the packaged software is using setuptools, you only need to include “<code>../../lang/python/egg.mk</code>”.</p>
</div>
<div class="paragraph">
<p>Either way, the package directory should be called “py-software” and <code>PKGNAME</code> should be set to “${PYPKGPREFIX}-${DISTNAME}”, e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTNAME=   foopymodule-1.2.10
PKGNAME=    ${PYPKGPREFIX}-${DISTNAME}</pre>
</div>
</div>
<div class="paragraph">
<p>If it is an application, include “<code>../../lang/python/application.mk</code>”. In order to correctly set the path to the Python interpreter, use the <code>REPLACE_PYTHON</code> variable and set it to the list of files (paths relative to <code>WRKSRC</code>) that must be corrected. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>REPLACE_PYTHON=   *.py</pre>
</div>
</div>
<div class="paragraph">
<p>Some Python modules have separate distributions for Python-2.x and Python-3.x support. In pkgsrc this is handled by the <code>versioned_dependencies.mk</code> file. Set <code>PYTHON_VERSIONED_DEPENDENCIES</code> to the list of packages that should be depended upon and include “<code>../../lang/python/versioned_dependencies.mk</code>”, then the pkgsrc infrastructure will depend on the appropriate package version. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PYTHON_VERSIONED_DEPENDENCIES=dialog</pre>
</div>
</div>
<div class="paragraph">
<p>Look inside <code>versioned_dependencies.mk</code> for a list of supported packages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_14_1_2_r_packages">14.1.2. R packages</h3>
<div class="paragraph">
<p>Simple R packages from <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html">CRAN</a> are handled automatically by <strong>R2pkg</strong>, which is available in <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/R2pkg/index.html"><code>pkgtools/R2pkg</code></a>. Individual packages (and optionally their dependencies) may be created and updated. R packages generally follow the same form, and most of the relevant information needed is contained in a <code>DESCRIPTION</code> file as part of each R package on <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html">CRAN</a>. Consequently, <strong>R2pkg</strong> downloads that information and creates or updates a package in the canonical form. The resulting package should be reviewed for correctness.</p>
</div>
</div>
<div class="sect2">
<h3 id="_14_1_3_texlive_packages">14.1.3. TeXlive packages</h3>
<div class="paragraph">
<p>TeXlive packages from <a href="https://www.ctan.org/">CTAN</a> are handled automatically by <strong>texlive2pkg</strong>, which is available in <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/texlive2pkg/index.html"><code>pkgtools/texlive2pkg</code></a>.</p>
</div>
<div class="paragraph">
<p>If the TeXlive package name is not known, it may be useful to search <a href="https://www.ctan.org/">CTAN</a>. A “Contained in” field on the package page typically identifies the basename of the package file in the <a href="https://www.ctan.org/tex-archive/systems/texlive/tlnet/archive">TeXlive
archive</a>.</p>
</div>
<div class="paragraph">
<p>If the TeXlive package name is known, download the files from the <a href="https://www.ctan.org/tex-archive/systems/texlive/tlnet/archive">TeXlive
archive</a>. For package <code>foo</code>, you will need to download <code>foo.tar.xz</code>. Most TeXlive packages also have associated documentation packages, so download <code>foo.doc.tar.xz</code> at the same time. These files should be placed in the appropriate category directory, which is often but not always <code>print</code>. Then run the following command in the category directory.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>texlive2pkg foo.tar.xz foo.doc.tar.xz</pre>
</div>
</div>
<div class="paragraph">
<p>This will create two packages, <code>tex-foo</code> and <code>tex-foo-doc</code>. Be sure to check that both packages are correct.</p>
</div>
<div class="paragraph">
<p>Finally, <a href="https://www.ctan.org/">CTAN</a> currently does not include version information in package filenames and changes their contents periodically when updates occur. Consequently, pkgsrc avoids downloading distfiles directly from <a href="https://www.ctan.org/">CTAN</a> and instead relies on the pkgsrc archives. For each new or updated TeXlive package, e.g., the main one and the corresponding documentation, upload the distfiles with the following command in each package directory.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>make upload-distfiles</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_14_2_examples">14.2. Examples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_14_2_1_how_the_wwwnvu_package_came_into_pkgsrc">14.2.1. How the www/nvu package came into pkgsrc</h3>
<div class="sect3">
<h4 id="_14_2_1_1_the_initial_package">14.2.1.1. The initial package</h4>
<div class="paragraph">
<p>Looking at the file <code>pkgsrc/doc/TODO</code>, I saw that the “nvu” package has not yet been imported into pkgsrc. As the description says it has to do with the web, the obvious choice for the category is “www”.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ mkdir www/nvu
$ cd www/nvu</pre>
</div>
</div>
<div class="paragraph">
<p>The web site says that the sources are available as a tar file, so I fed that URL to the <strong>url2pkg</strong> program:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ url2pkg http://cvs.nvu.com/download/nvu-1.0-sources.tar.bz2</pre>
</div>
</div>
<div class="paragraph">
<p>My editor popped up, and I added a <code>PKGNAME</code> line below the <code>DISTNAME</code> line, as the package name should not have the word “sources” in it. I also filled in the <code>MAINTAINER</code>, <code>HOMEPAGE</code> and <code>COMMENT</code> fields. Then the package <code>Makefile</code> looked like that:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># $NetBSD $
#
DISTNAME=       nvu-1.0-sources
PKGNAME=        nvu-1.0
CATEGORIES=     www
MASTER_SITES=   http://cvs.nvu.com/download/
EXTRACT_SUFX=   .tar.bz2
 MAINTAINER=     rillig@NetBSD.org
HOMEPAGE=       http://cvs.nvu.com/
COMMENT=        Web Authoring System
 # url2pkg-marker (please do not remove this line.)
.include "../../mk/bsd.pkg.mk"</pre>
</div>
</div>
<div class="paragraph">
<p>On the first line of output above, an artificial space has been added between NetBSD and $, this is a workaround to prevent CVS expanding to the filename of the guide.</p>
</div>
<div class="paragraph">
<p>Then, I quit the editor and watched pkgsrc downloading a large source archive:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>url2pkg&gt; Running "make makesum" ...
=&gt; Required installed package digest&gt;=20010302: digest-20060826 found
=&gt; Fetching nvu-1.0-sources.tar.bz2
Requesting http://cvs.nvu.com/download/nvu-1.0-sources.tar.bz2
100% |*************************************| 28992 KB  150.77 KB/s00:00 ETA
29687976 bytes retrieved in 03:12 (150.77 KB/s)
url2pkg&gt; Running "make extract" ...
=&gt; Required installed package digest&gt;=20010302: digest-20060826 found
=&gt; Checksum SHA1 OK for nvu-1.0-sources.tar.bz2
=&gt; Checksum RMD160 OK for nvu-1.0-sources.tar.bz2
work.bacc -&gt; /tmp/roland/pkgsrc/www/nvu/work.bacc
===&gt; Installing dependencies for nvu-1.0
===&gt; Overriding tools for nvu-1.0
===&gt; Extracting for nvu-1.0
url2pkg&gt; Adjusting the Makefile.
Remember to correct CATEGORIES, HOMEPAGE, COMMENT, and DESCR when you're done!
Good luck! (See pkgsrc/doc/pkgsrc.txt for some more help :-)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_14_2_1_2_fixing_all_kinds_of_problems_to_make_the_package_work">14.2.1.2. Fixing all kinds of problems to make the package work</h4>
<div class="paragraph">
<p>Now that the package has been extracted, let&#8217;s see what&#8217;s inside it. The package has a <code>README.txt</code>, but that only says something about mozilla, so it&#8217;s probably useless for seeing what dependencies this package has. But since there is a GNU configure script in the package, let&#8217;s hope that it will complain about everything it needs.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ bmake
=&gt; Required installed package digest&gt;=20010302: digest-20060826 found
=&gt; Checksum SHA1 OK for nvu-1.0-sources.tar.bz2
=&gt; Checksum RMD160 OK for nvu-1.0-sources.tar.bz2
===&gt; Patching for nvu-1.0
===&gt; Creating toolchain wrappers for nvu-1.0
===&gt; Configuring for nvu-1.0
[...]
configure: error: Perl 5.004 or higher is required.
[...]
WARNING: Please add USE_TOOLS+=perl to the package Makefile.
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>That worked quite well. So I opened the package Makefile in my editor, and since it already has a <code>USE_TOOLS</code> line, I just appended “perl” to it. Since the dependencies of the package have changed now, and since a perl wrapper is automatically installed in the “tools” phase, I need to build the package from scratch.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ bmake clean
===&gt; Cleaning for nvu-1.0
$ bmake
[...]
*** /tmp/roland/pkgsrc/www/nvu/work.bacc/.tools/bin/make is not \
GNU Make.  You will not be able to build Mozilla without GNU Make.
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>So I added “gmake” to the <code>USE_TOOLS</code> line and tried again (from scratch).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[...]
checking for GTK - version &gt;= 1.2.0... no
*** Could not run GTK test program, checking why...
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>Now to the other dependencies. The first question is: Where is the GTK package hidden in pkgsrc?</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ echo ../../*/gtk*
[many packages ...]
$ echo ../../*/gtk
../../x11/gtk
$ echo ../../*/gtk2
../../x11/gtk2
$ echo ../../*/gtk2/bui*
../../x11/gtk2/buildlink3.mk</pre>
</div>
</div>
<div class="paragraph">
<p>The first try was definitely too broad. The second one had exactly one result, which is very good. But there is one pitfall with GNOME packages. Before GNOME 2 had been released, there were already many GNOME 1 packages in pkgsrc. To be able to continue to use these packages, the GNOME 2 packages were imported as separate packages, and their names usually have a “2” appended. So I checked whether this was the case here, and indeed it was.</p>
</div>
<div class="paragraph">
<p>Since the GTK2 package has a <code>buildlink3.mk</code> file, adding the dependency is very easy. I just inserted an <code>.include</code> line before the last line of the package <code>Makefile</code>, so that it now looks like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[...]
.include "../../x11/gtk2/buildlink3.mk"
.include "../../mk/bsd.pkg.mk</pre>
</div>
</div>
<div class="paragraph">
<p>After another <strong>bmake clean &amp;&amp; bmake</strong>, the answer was:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[...]
checking for gtk-config... /home/roland/pkg/bin/gtk-config
checking for GTK - version &gt;= 1.2.0... no
*** Could not run GTK test program, checking why...
*** The test program failed to compile or link. See the file config.log for the
*** exact error that occured. This usually means GTK was incorrectly installed
*** or that you have moved GTK since it was installed. In the latter case, you
*** may want to edit the gtk-config script: /home/roland/pkg/bin/gtk-config
configure: error: Test for GTK failed.
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>In this particular case, the assumption that “every package prefers GNOME 2” had been wrong. The first of the lines above told me that this package really wanted to have the GNOME 1 version of GTK. If the package had looked for GTK2, it would have looked for <strong>pkg-config</strong> instead of <strong>gtk-config</strong>. So I changed the <code>x11/gtk2</code> to <code>x11/gtk</code> in the package <code>Makefile</code>, and tried again.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[...]
cc -o xpidl.o -c -DOSTYPE=\"NetBSD3\" -DOSARCH=\"NetBSD\"  [...]
In file included from xpidl.c:42:
xpidl.h:53:24: libIDL/IDL.h: No such file or directory
In file included from xpidl.c:42:
xpidl.h:132: error: parse error before "IDL_ns"
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>The package still does not find all of its dependencies. Now the question is: Which package provides the <code>libIDL/IDL.h</code> header file?</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ echo ../../*/*idl*
../../devel/py-idle ../../wip/idled ../../x11/acidlaunch
$ echo ../../*/*IDL*
../../net/libIDL</pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take the one from the second try. So I included the <code>../../net/libIDL/buildlink3.mk</code> file and tried again. But the error didn&#8217;t change. After digging through some of the code, I concluded that the build process of the package was broken and couldn&#8217;t have ever worked, but since the Mozilla source tree is quite large, I didn&#8217;t want to fix it. So I added the following to the package <code>Makefile</code> and tried again:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CPPFLAGS+=      -I${BUILDLINK_PREFIX.libIDL}/include/libIDL-2.0
BUILDLINK_TRANSFORM+=   l:IDL:IDL-2</pre>
</div>
</div>
<div class="paragraph">
<p>The latter line is needed because the package expects the library <code>libIDL.so</code>, but only <code>libIDL-2.so</code> is available. So I told the compiler wrapper to rewrite that on the fly.</p>
</div>
<div class="paragraph">
<p>The next problem was related to a recent change of the FreeType interface. I looked up in <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/www/seamonkey/index.html"><code>www/seamonkey</code></a> which patch files were relevant for this issue and copied them to the <code>patches</code> directory. Then I retried, fixed the patches so that they applied cleanly and retried again. This time, everything worked.</p>
</div>
</div>
<div class="sect3">
<h4 id="_14_2_1_3_installing_the_package">14.2.1.3. Installing the package</h4>
<div class="literalblock">
<div class="content">
<pre>$ bmake CHECK_FILES=no install
[...]
$ bmake print-PLIST &gt;PLIST
$ bmake deinstall
$ bmake install</pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-07-07 06:24:23 UTC
</div>
</div>
</body>
</html>