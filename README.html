<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.17">
<meta name="author" content="The pkgsrc Developers">
<title>The pkgsrc guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;outline:none;-webkit-tap-highlight-color:transparent}
details>summary::-webkit-details-marker{display:none}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos,pre.pygments .linenos{border-right:1px solid;opacity:.35;padding-right:.5em;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}
pre.pygments span.linenos{display:inline-block;margin-right:.75em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all>*>tr,table.stripes-odd>*>tr:nth-of-type(odd),table.stripes-even>*>tr:nth-of-type(even),table.stripes-hover>*>tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
li>p:empty:only-child::before{content:"";display:inline-block}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1>The pkgsrc guide</h1>
<div class="details">
<span id="author" class="author">The pkgsrc Developers</span><br>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel0">
<li><a href="#_chapter_1_what_is_pkgsrc">Chapter 1. What is pkgsrc?</a>
<ul class="sectlevel1">
<li><a href="#_1_1_introduction">1.1. Introduction</a>
<ul class="sectlevel2">
<li><a href="#_1_1_1_why_pkgsrc">1.1.1. Why pkgsrc?</a></li>
<li><a href="#_1_1_2_supported_platforms">1.1.2. Supported platforms</a></li>
</ul>
</li>
<li><a href="#_1_2_overview">1.2. Overview</a></li>
<li><a href="#_1_3_terminology">1.3. Terminology</a>
<ul class="sectlevel2">
<li><a href="#_1_3_1_roles_involved_in_pkgsrc">1.3.1. Roles involved in pkgsrc</a></li>
</ul>
</li>
<li><a href="#_1_4_typography">1.4. Typography</a></li>
</ul>
</li>
<li><a href="#_chapter_2_getting_help">Chapter 2. Getting help</a></li>
<li><a href="#_chapter_3_where_to_get_pkgsrc_and_how_to_keep_it_up_to_date">Chapter 3. Where to get pkgsrc and how to keep it up-to-date</a>
<ul class="sectlevel1">
<li><a href="#_3_1_getting_pkgsrc_for_the_first_time">3.1. Getting pkgsrc for the first time</a>
<ul class="sectlevel2">
<li><a href="#_3_1_1_as_tar_archive">3.1.1. As tar archive</a></li>
<li><a href="#_3_1_2_via_anonymous_cvs">3.1.2. Via anonymous CVS</a></li>
</ul>
</li>
<li><a href="#_3_2_keeping_pkgsrc_up_to_date">3.2. Keeping pkgsrc up-to-date</a>
<ul class="sectlevel2">
<li><a href="#_3_2_1_via_tar_files">3.2.1. Via tar files</a></li>
<li><a href="#_3_2_2_via_cvs">3.2.2. Via CVS</a>
<ul class="sectlevel3">
<li><a href="#_3_2_2_1_switching_between_different_pkgsrc_branches">3.2.2.1. Switching between different pkgsrc branches</a></li>
<li><a href="#_3_2_2_2_what_happens_to_my_changes_when_updating">3.2.2.2. What happens to my changes when updating?</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_chapter_4_using_pkgsrc_on_systems_other_than_netbsd">Chapter 4. Using pkgsrc on systems other than NetBSD</a>
<ul class="sectlevel1">
<li><a href="#_4_1_binary_distribution">4.1. Binary distribution</a></li>
<li><a href="#_4_2_bootstrapping_pkgsrc">4.2. Bootstrapping pkgsrc</a></li>
</ul>
</li>
<li><a href="#_chapter_5_using_pkgsrc">Chapter 5. Using pkgsrc</a>
<ul class="sectlevel1">
<li><a href="#_5_1_using_binary_packages">5.1. Using binary packages</a>
<ul class="sectlevel2">
<li><a href="#_5_1_1_finding_binary_packages">5.1.1. Finding binary packages</a></li>
<li><a href="#_5_1_2_installing_binary_packages">5.1.2. Installing binary packages</a></li>
<li><a href="#_5_1_3_updating_packages">5.1.3. Updating packages</a></li>
<li><a href="#_5_1_4_deinstalling_packages">5.1.4. Deinstalling packages</a></li>
<li><a href="#_5_1_5_getting_information_about_installed_packages">5.1.5. Getting information about installed packages</a></li>
<li><a href="#_5_1_6_checking_for_security_vulnerabilities_in_installed_packages">5.1.6. Checking for security vulnerabilities in installed packages</a></li>
<li><a href="#_5_1_7_finding_if_newer_versions_of_your_installed_packages_are_in_pkgsrc">5.1.7. Finding if newer versions of your installed packages are in pkgsrc</a></li>
<li><a href="#_5_1_8_other_administrative_functions">5.1.8. Other administrative functions</a></li>
</ul>
</li>
<li><a href="#_5_2_building_packages_from_source">5.2. Building packages from source</a>
<ul class="sectlevel2">
<li><a href="#_5_2_1_requirements">5.2.1. Requirements</a></li>
<li><a href="#_5_2_2_fetching_distfiles">5.2.2. Fetching distfiles</a></li>
<li><a href="#_5_2_3_how_to_build_and_install">5.2.3. How to build and install</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_chapter_6_configuring_pkgsrc">Chapter 6. Configuring pkgsrc</a>
<ul class="sectlevel1">
<li><a href="#_6_1_general_configuration">6.1. General configuration</a></li>
<li><a href="#_6_2_variables_affecting_the_build_process">6.2. Variables affecting the build process</a></li>
<li><a href="#_6_3_variables_affecting_the_installation_process">6.3. Variables affecting the installation process</a></li>
<li><a href="#_6_4_selecting_and_configuring_the_compiler">6.4. Selecting and configuring the compiler</a>
<ul class="sectlevel2">
<li><a href="#_6_4_1_selecting_the_compiler">6.4.1. Selecting the compiler</a></li>
<li><a href="#_6_4_2_additional_flags_to_the_compiler_cflags">6.4.2. Additional flags to the compiler (CFLAGS)</a></li>
<li><a href="#_6_4_3_additional_flags_to_the_linker_ldflags">6.4.3. Additional flags to the linker (LDFLAGS)</a></li>
</ul>
</li>
<li><a href="#_6_5_developeradvanced_settings">6.5. Developer/advanced settings</a></li>
<li><a href="#_6_6_selecting_build_options">6.6. Selecting Build Options</a></li>
</ul>
</li>
<li><a href="#_chapter_7_creating_binary_packages">Chapter 7. Creating binary packages</a>
<ul class="sectlevel1">
<li><a href="#_7_1_building_a_single_binary_package">7.1. Building a single binary package</a></li>
<li><a href="#_7_2_settings_for_creation_of_binary_packages">7.2. Settings for creation of binary packages</a></li>
</ul>
</li>
<li><a href="#_chapter_8_creating_binary_packages_for_everything_in_pkgsrc_bulk_builds">Chapter 8. Creating binary packages for everything in pkgsrc (bulk builds)</a>
<ul class="sectlevel1">
<li><a href="#_8_1_preparations">8.1. Preparations</a></li>
<li><a href="#_8_2_running_a_bulk_build">8.2. Running a bulk build</a>
<ul class="sectlevel2">
<li><a href="#_8_2_1_configuration">8.2.1. Configuration</a></li>
</ul>
</li>
<li><a href="#_8_3_requirements_of_a_full_bulk_build">8.3. Requirements of a full bulk build</a></li>
<li><a href="#_8_4_bulk_build_variants">8.4. Bulk build variants</a>
<ul class="sectlevel2">
<li><a href="#_8_4_1_detect_unknown_configure_options">8.4.1. Detect unknown configure options</a></li>
<li><a href="#_8_4_2_detect_classes_of_bugs_by_forcing_compiler_warnings">8.4.2. Detect classes of bugs by forcing compiler warnings</a></li>
<li><a href="#_8_4_3_force_compiler_options_only_in_the_build_phase">8.4.3. Force compiler options only in the build phase</a></li>
<li><a href="#_8_4_4_use_custom_directories">8.4.4. Use custom directories</a></li>
<li><a href="#_8_4_5_turn_warnings_into_errors">8.4.5. Turn warnings into errors</a></li>
<li><a href="#_8_4_6_reject_packages_for_which_pkglint_reports_errors">8.4.6. Reject packages for which pkglint reports errors</a></li>
<li><a href="#_8_4_7_reject_packages_that_contain_forbidden_strings">8.4.7. Reject packages that contain forbidden strings</a></li>
<li><a href="#_8_4_8_reject_packages_whose_self_test_fails">8.4.8. Reject packages whose self-test fails</a></li>
<li><a href="#_8_4_9_reject_packages_that_use_undefined_shell_variables">8.4.9. Reject packages that use undefined shell variables</a></li>
<li><a href="#_8_4_10_turn_off_verbose_logging">8.4.10. Turn off verbose logging</a></li>
</ul>
</li>
<li><a href="#_8_5_creating_a_multiple_cd_rom_packages_collection">8.5. Creating a multiple CD-ROM packages collection</a>
<ul class="sectlevel2">
<li><a href="#_8_5_1_example_of_cdpack">8.5.1. Example of cdpack</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_chapter_9_directory_layout_of_the_installed_files">Chapter 9. Directory layout of the installed files</a>
<ul class="sectlevel1">
<li><a href="#_9_1_file_system_layout_in_localbase">9.1. File system layout in ${LOCALBASE}</a></li>
<li><a href="#_9_2_file_system_layout_in_varbase">9.2. File system layout in ${VARBASE}</a></li>
</ul>
</li>
<li><a href="#_chapter_10_frequently_asked_questions">Chapter 10. Frequently Asked Questions</a>
<ul class="sectlevel1">
<li><a href="#_10_1_are_there_any_mailing_lists_for_pkg_related_discussion">10.1. Are there any mailing lists for pkg-related discussion?</a></li>
<li><a href="#_10_2_utilities_for_package_management_pkgtools">10.2. Utilities for package management (pkgtools)</a></li>
<li><a href="#_10_3_how_to_use_pkgsrc_as_non_root">10.3. How to use pkgsrc as non-root</a></li>
<li><a href="#_10_4_how_to_resume_transfers_when_fetching_distfiles">10.4. How to resume transfers when fetching distfiles?</a></li>
<li><a href="#_10_5_how_can_i_installuse_modular_x_org_from_pkgsrc">10.5. How can I install/use modular X.org from pkgsrc?</a></li>
<li><a href="#_10_6_how_to_fetch_files_from_behind_a_firewall">10.6. How to fetch files from behind a firewall</a></li>
<li><a href="#_10_7_how_to_fetch_files_from_https_sites">10.7. How to fetch files from HTTPS sites</a></li>
<li><a href="#_10_8_how_do_i_tell_make_fetch_to_do_passive_ftp">10.8. How do I tell make fetch to do passive FTP?</a></li>
<li><a href="#_10_9_how_to_fetch_all_distfiles_at_once">10.9. How to fetch all distfiles at once</a></li>
<li><a href="#_10_10_what_does_dont_know_how_to_make_usrsharetmactmac_andoc_mean">10.10. What does “Don&#8217;t know how to make /usr/share/tmac/tmac.andoc” mean?</a></li>
<li><a href="#_10_11_what_does_could_not_find_bsd_own_mk_mean">10.11. What does “Could not find bsd.own.mk” mean?</a></li>
<li><a href="#_10_12_using_sudo_or_priv_with_pkgsrc">10.12. Using 'sudo' or 'priv' with pkgsrc</a></li>
<li><a href="#_10_13_how_do_i_change_the_location_of_configuration_files">10.13. How do I change the location of configuration files?</a></li>
<li><a href="#_10_14_automated_security_checks">10.14. Automated security checks</a></li>
<li><a href="#_10_15_why_do_some_packages_ignore_my_cflags">10.15. Why do some packages ignore my CFLAGS?</a></li>
<li><a href="#_10_16_a_package_does_not_build_what_shall_i_do">10.16. A package does not build. What shall I do?</a></li>
<li><a href="#_10_17_what_does_makefile_appears_to_contain_unresolved_cvsrcs_merge_conflicts_mean">10.17. What does “Makefile appears to contain unresolved cvs/rcs/??? merge conflicts” mean?</a></li>
</ul>
</li>
<li><a href="#_chapter_11_getting_help">Chapter 11. Getting help</a></li>
<li><a href="#_chapter_12_package_components_files_directories_and_contents">Chapter 12. Package components - files, directories and contents</a>
<ul class="sectlevel1">
<li><a href="#_12_1_makefile">12.1. Makefile</a></li>
<li><a href="#_12_2_distinfo">12.2. distinfo</a></li>
<li><a href="#_12_3_patches">12.3. patches/*</a>
<ul class="sectlevel2">
<li><a href="#_12_3_1_structure_of_a_single_patch_file">12.3.1. Structure of a single patch file</a></li>
<li><a href="#_12_3_2_creating_patch_files">12.3.2. Creating patch files</a></li>
<li><a href="#_12_3_3_sources_where_the_patch_files_come_from">12.3.3. Sources where the patch files come from</a></li>
<li><a href="#_12_3_4_patching_guidelines">12.3.4. Patching guidelines</a></li>
<li><a href="#_12_3_5_feedback_to_the_author">12.3.5. Feedback to the author</a></li>
</ul>
</li>
<li><a href="#_12_4_other_mandatory_files">12.4. Other mandatory files</a></li>
<li><a href="#_12_5_optional_files">12.5. Optional files</a>
<ul class="sectlevel2">
<li><a href="#_12_5_1_files_affecting_the_binary_package">12.5.1. Files affecting the binary package</a></li>
<li><a href="#_12_5_2_files_affecting_the_build_process">12.5.2. Files affecting the build process</a></li>
<li><a href="#_12_5_3_files_affecting_nothing_at_all">12.5.3. Files affecting nothing at all</a></li>
</ul>
</li>
<li><a href="#_12_6_work">12.6. work*</a></li>
<li><a href="#_12_7_files">12.7. files/*</a></li>
</ul>
</li>
<li><a href="#_chapter_13_the_build_process">Chapter 13. The build process</a>
<ul class="sectlevel1">
<li><a href="#_13_1_introduction">13.1. Introduction</a></li>
<li><a href="#_13_2_program_location">13.2. Program location</a></li>
<li><a href="#_13_3_directories_used_during_the_build_process">13.3. Directories used during the build process</a></li>
<li><a href="#_13_4_running_a_phase">13.4. Running a phase</a></li>
<li><a href="#_13_5_the_fetch_phase">13.5. The fetch phase</a>
<ul class="sectlevel2">
<li><a href="#_13_5_1_what_to_fetch_and_where_to_get_it_from">13.5.1. What to fetch and where to get it from</a></li>
<li><a href="#_13_5_2_how_are_the_files_fetched">13.5.2. How are the files fetched?</a></li>
</ul>
</li>
<li><a href="#_13_6_the_checksum_phase">13.6. The checksum phase</a></li>
<li><a href="#_13_7_the_extract_phase">13.7. The extract phase</a></li>
<li><a href="#_13_8_the_patch_phase">13.8. The patch phase</a></li>
<li><a href="#_13_9_the_tools_phase">13.9. The tools phase</a></li>
<li><a href="#_13_10_the_wrapper_phase">13.10. The wrapper phase</a></li>
<li><a href="#_13_11_the_configure_phase">13.11. The configure phase</a></li>
<li><a href="#_13_12_the_build_phase">13.12. The build phase</a></li>
<li><a href="#_13_13_the_test_phase">13.13. The test phase</a></li>
<li><a href="#_13_14_the_install_phase">13.14. The install phase</a></li>
<li><a href="#_13_15_the_package_phase">13.15. The package phase</a></li>
<li><a href="#_13_16_cleaning_up">13.16. Cleaning up</a></li>
<li><a href="#_13_17_other_helpful_targets">13.17. Other helpful targets</a></li>
</ul>
</li>
<li><a href="#_chapter_14_creating_a_new_pkgsrc_package_from_scratch">Chapter 14. Creating a new pkgsrc package from scratch</a>
<ul class="sectlevel1">
<li><a href="#_14_1_common_types_of_packages">14.1. Common types of packages</a>
<ul class="sectlevel2">
<li><a href="#_14_1_1_python_modules_and_programs">14.1.1. Python modules and programs</a></li>
<li><a href="#_14_1_2_r_packages">14.1.2. R packages</a></li>
<li><a href="#_14_1_3_texlive_packages">14.1.3. TeXlive packages</a></li>
</ul>
</li>
<li><a href="#_14_2_examples">14.2. Examples</a>
<ul class="sectlevel2">
<li><a href="#_14_2_1_how_the_wwwnvu_package_came_into_pkgsrc">14.2.1. How the www/nvu package came into pkgsrc</a>
<ul class="sectlevel3">
<li><a href="#_14_2_1_1_the_initial_package">14.2.1.1. The initial package</a></li>
<li><a href="#_14_2_1_2_fixing_all_kinds_of_problems_to_make_the_package_work">14.2.1.2. Fixing all kinds of problems to make the package work</a></li>
<li><a href="#_14_2_1_3_installing_the_package">14.2.1.3. Installing the package</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><a href="#_chapter_15_programming_in_makefiles">Chapter 15. Programming in Makefiles</a>
<ul class="sectlevel1">
<li><a href="#_15_1_caveats">15.1. Caveats</a></li>
<li><a href="#_15_2_makefile_variables">15.2. Makefile variables</a>
<ul class="sectlevel2">
<li><a href="#_15_2_1_naming_conventions">15.2.1. Naming conventions</a></li>
</ul>
</li>
<li><a href="#_15_3_code_snippets">15.3. Code snippets</a>
<ul class="sectlevel2">
<li><a href="#_15_3_1_adding_things_to_a_list">15.3.1. Adding things to a list</a></li>
<li><a href="#_15_3_2_echoing_a_string_exactly_as_is">15.3.2. Echoing a string exactly as-is</a></li>
<li><a href="#_15_3_3_passing_cflags_to_gnu_configure_scripts">15.3.3. Passing CFLAGS to GNU configure scripts</a></li>
<li><a href="#_15_3_4_handling_possibly_empty_variables">15.3.4. Handling possibly empty variables</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_chapter_16_options_handling">Chapter 16. Options handling</a>
<ul class="sectlevel1">
<li><a href="#_16_1_global_default_options">16.1. Global default options</a></li>
<li><a href="#_16_2_converting_packages_to_use_bsd_options_mk">16.2. Converting packages to use bsd.options.mk</a></li>
<li><a href="#_16_3_option_names">16.3. Option Names</a></li>
<li><a href="#_16_4_determining_the_options_of_dependencies">16.4. Determining the options of dependencies</a></li>
</ul>
</li>
<li><a href="#_chapter_17_tools_needed_for_building_or_running">Chapter 17. Tools needed for building or running</a>
<ul class="sectlevel1">
<li><a href="#_17_1_tools_for_pkgsrc_builds">17.1. Tools for pkgsrc builds</a></li>
<li><a href="#_17_2_tools_needed_by_packages">17.2. Tools needed by packages</a></li>
<li><a href="#_17_3_tools_provided_by_platforms">17.3. Tools provided by platforms</a></li>
</ul>
</li>
<li><a href="#_chapter_18_buildlink_methodology">Chapter 18. Buildlink methodology</a>
<ul class="sectlevel1">
<li><a href="#_18_1_converting_packages_to_use_buildlink3">18.1. Converting packages to use buildlink3</a></li>
<li><a href="#_18_2_writing_buildlink3_mk_files">18.2. Writing buildlink3.mk files</a>
<ul class="sectlevel2">
<li><a href="#_18_2_1_anatomy_of_a_buildlink3_mk_file">18.2.1. Anatomy of a buildlink3.mk file</a></li>
<li><a href="#_18_2_2_updating_buildlink_api_depends_pkg_and_buildlink_abi_depends_pkg_in_buildlink3_mk_files">18.2.2. Updating BUILDLINK_API_DEPENDS.pkg and BUILDLINK_ABI_DEPENDS.pkg in buildlink3.mk files</a></li>
</ul>
</li>
<li><a href="#_18_3_writing_builtin_mk_files">18.3. Writing builtin.mk files</a>
<ul class="sectlevel2">
<li><a href="#_18_3_1_anatomy_of_a_builtin_mk_file">18.3.1. Anatomy of a builtin.mk file</a></li>
<li><a href="#_18_3_2_global_preferences_for_native_or_pkgsrc_software">18.3.2. Global preferences for native or pkgsrc software</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_chapter_19_plist_issues">Chapter 19. PLIST issues</a>
<ul class="sectlevel1">
<li><a href="#_19_1_rcs_id">19.1. RCS ID</a></li>
<li><a href="#_19_2_semi_automatic_plist_generation">19.2. Semi-automatic PLIST generation</a></li>
<li><a href="#_19_3_tweaking_output_of_make_print_plist">19.3. Tweaking output of make print-PLIST</a></li>
<li><a href="#_19_4_variable_substitution_in_plist">19.4. Variable substitution in PLIST</a></li>
<li><a href="#_19_5_man_page_compression">19.5. Man page compression</a></li>
<li><a href="#_19_6_changing_plist_source_with_plist_src">19.6. Changing PLIST source with PLIST_SRC</a></li>
<li><a href="#_19_7_platform_specific_and_differing_plists">19.7. Platform-specific and differing PLISTs</a></li>
<li><a href="#_19_8_build_specific_plists">19.8. Build-specific PLISTs</a></li>
<li><a href="#_19_9_sharing_directories_between_packages">19.9. Sharing directories between packages</a></li>
</ul>
</li>
<li><a href="#_chapter_20_the_pkginstall_framework">Chapter 20. The pkginstall framework</a>
<ul class="sectlevel1">
<li><a href="#_20_1_files_and_directories_outside_the_installation_prefix">20.1. Files and directories outside the installation prefix</a>
<ul class="sectlevel2">
<li><a href="#_20_1_1_directory_manipulation">20.1.1. Directory manipulation</a></li>
<li><a href="#_20_1_2_file_manipulation">20.1.2. File manipulation</a></li>
</ul>
</li>
<li><a href="#_20_2_configuration_files">20.2. Configuration files</a>
<ul class="sectlevel2">
<li><a href="#_20_2_1_how_pkg_sysconfdir_is_set">20.2.1. How PKG_SYSCONFDIR is set</a></li>
<li><a href="#_20_2_2_telling_the_software_where_configuration_files_are">20.2.2. Telling the software where configuration files are</a></li>
<li><a href="#_20_2_3_patching_installations">20.2.3. Patching installations</a></li>
<li><a href="#_20_2_4_disabling_handling_of_configuration_files">20.2.4. Disabling handling of configuration files</a></li>
</ul>
</li>
<li><a href="#_20_3_system_startup_scripts">20.3. System startup scripts</a>
<ul class="sectlevel2">
<li><a href="#_20_3_1_disabling_handling_of_system_startup_scripts">20.3.1. Disabling handling of system startup scripts</a></li>
</ul>
</li>
<li><a href="#_20_4_system_users_and_groups">20.4. System users and groups</a></li>
<li><a href="#_20_5_system_shells">20.5. System shells</a>
<ul class="sectlevel2">
<li><a href="#_20_5_1_disabling_shell_registration">20.5.1. Disabling shell registration</a></li>
</ul>
</li>
<li><a href="#_20_6_fonts">20.6. Fonts</a>
<ul class="sectlevel2">
<li><a href="#_20_6_1_disabling_automatic_update_of_the_fonts_databases">20.6.1. Disabling automatic update of the fonts databases</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_chapter_21_making_your_package_work">Chapter 21. Making your package work</a>
<ul class="sectlevel1">
<li><a href="#_21_1_general_operation">21.1. General operation</a>
<ul class="sectlevel2">
<li><a href="#_21_1_1_how_to_pull_in_user_settable_variables_from_mk_conf">21.1.1. How to pull in user-settable variables from mk.conf</a></li>
<li><a href="#_21_1_2_user_interaction">21.1.2. User interaction</a></li>
<li><a href="#_21_1_3_handling_licenses">21.1.3. Handling licenses</a>
<ul class="sectlevel3">
<li><a href="#_21_1_3_1_adding_a_package_with_a_new_license">21.1.3.1. Adding a package with a new license</a></li>
<li><a href="#_21_1_3_2_change_to_the_license">21.1.3.2. Change to the license</a></li>
</ul>
</li>
<li><a href="#_21_1_4_restricted_packages">21.1.4. Restricted packages</a></li>
<li><a href="#_21_1_5_handling_dependencies">21.1.5. Handling dependencies</a></li>
<li><a href="#_21_1_6_handling_conflicts_with_other_packages">21.1.6. Handling conflicts with other packages</a></li>
<li><a href="#_21_1_7_packages_that_cannot_or_should_not_be_built">21.1.7. Packages that cannot or should not be built</a></li>
<li><a href="#_21_1_8_packages_which_should_not_be_deleted_once_installed">21.1.8. Packages which should not be deleted, once installed</a></li>
<li><a href="#_21_1_9_handling_packages_with_security_problems">21.1.9. Handling packages with security problems</a></li>
<li><a href="#_21_1_10_how_to_handle_incrementing_versions_when_fixing_an_existing_package">21.1.10. How to handle incrementing versions when fixing an existing package</a></li>
<li><a href="#_21_1_11_substituting_variable_text_in_the_package_files_the_subst_framework">21.1.11. Substituting variable text in the package files (the SUBST framework)</a>
<ul class="sectlevel3">
<li><a href="#_21_1_11_1_choosing_the_time_where_the_substitutions_happen">21.1.11.1. Choosing the time where the substitutions happen</a></li>
<li><a href="#_21_1_11_2_choosing_the_files_where_the_substitutions_happen">21.1.11.2. Choosing the files where the substitutions happen</a></li>
<li><a href="#_21_1_11_3_choosing_what_to_substitute">21.1.11.3. Choosing what to substitute</a></li>
<li><a href="#_21_1_11_4_other_subst_variables">21.1.11.4. Other SUBST variables</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_21_2_the_fetch_phase">21.2. The fetch phase</a>
<ul class="sectlevel2">
<li><a href="#_21_2_1_packages_whose_distfiles_arent_available_for_plain_downloading">21.2.1. Packages whose distfiles aren&#8217;t available for plain downloading</a></li>
<li><a href="#_21_2_2_how_to_handle_modified_distfiles_with_the_old_name">21.2.2. How to handle modified distfiles with the 'old' name</a></li>
<li><a href="#_21_2_3_packages_hosted_on_github_com">21.2.3. Packages hosted on github.com</a>
<ul class="sectlevel3">
<li><a href="#_21_2_3_1_fetch_based_on_a_tagged_release">21.2.3.1. Fetch based on a tagged release</a></li>
<li><a href="#_21_2_3_2_fetch_based_on_a_specific_commit_before_the_first_release">21.2.3.2. Fetch based on a specific commit before the first release</a></li>
<li><a href="#_21_2_3_3_fetch_based_on_a_specific_commit_after_a_release">21.2.3.3. Fetch based on a specific commit after a release</a></li>
<li><a href="#_21_2_3_4_fetch_based_on_release">21.2.3.4. Fetch based on release</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_21_3_the_configure_phase">21.3. The configure phase</a>
<ul class="sectlevel2">
<li><a href="#_21_3_1_shared_libraries_libtool">21.3.1. Shared libraries - libtool</a></li>
<li><a href="#_21_3_2_using_libtool_on_gnu_packages_that_already_support_libtool">21.3.2. Using libtool on GNU packages that already support libtool</a></li>
<li><a href="#_21_3_3_gnu_autoconfautomake">21.3.3. GNU Autoconf/Automake</a></li>
<li><a href="#_21_3_4_meson_ninja">21.3.4. Meson / ninja</a></li>
</ul>
</li>
<li><a href="#_21_4_programming_languages">21.4. Programming languages</a>
<ul class="sectlevel2">
<li><a href="#_21_4_1_c_c_and_fortran">21.4.1. C, C++, and Fortran</a></li>
<li><a href="#_21_4_2_java">21.4.2. Java</a></li>
<li><a href="#_21_4_3_go">21.4.3. Go</a></li>
<li><a href="#_21_4_4_rust">21.4.4. Rust</a></li>
<li><a href="#_21_4_5_packages_containing_perl_scripts">21.4.5. Packages containing Perl scripts</a></li>
<li><a href="#_21_4_6_packages_containing_shell_scripts">21.4.6. Packages containing shell scripts</a></li>
<li><a href="#_21_4_7_other_programming_languages">21.4.7. Other programming languages</a></li>
</ul>
</li>
<li><a href="#_21_5_the_build_phase">21.5. The build phase</a>
<ul class="sectlevel2">
<li><a href="#_21_5_1_compiling_c_and_c_code_conditionally">21.5.1. Compiling C and C++ code conditionally</a>
<ul class="sectlevel4">
<li><a href="#_21_5_1_1_c_preprocessor_macros_to_identify_the_operating_system">21.5.1.1. C preprocessor macros to identify the operating system</a></li>
<li><a href="#_21_5_1_2_c_preprocessor_macros_to_identify_the_hardware_architecture">21.5.1.2. C preprocessor macros to identify the hardware architecture</a></li>
<li><a href="#_21_5_1_3_c_preprocessor_macros_to_identify_the_compiler">21.5.1.3. C preprocessor macros to identify the compiler</a></li>
</ul>
</li>
<li><a href="#_21_5_2_how_to_handle_compiler_bugs">21.5.2. How to handle compiler bugs</a></li>
<li><a href="#_21_5_3_no_such_file_or_directory">21.5.3. No such file or directory</a>
<ul class="sectlevel3">
<li><a href="#_21_5_3_1_headers_from_other_packages">21.5.3.1. Headers from other packages</a></li>
<li><a href="#_21_5_3_2_headers_generated_during_the_build">21.5.3.2. Headers generated during the build</a></li>
<li><a href="#_21_5_3_3_symlinks">21.5.3.3. Symlinks</a></li>
<li><a href="#_21_5_3_4_stale_working_directories">21.5.3.4. Stale working directories</a></li>
<li><a href="#_21_5_3_5_other_possible_reasons">21.5.3.5. Other possible reasons</a></li>
</ul>
</li>
<li><a href="#_21_5_4_undefined_reference_to">21.5.4. Undefined reference to “&#8230;&#8203;”</a>
<ul class="sectlevel3">
<li><a href="#_21_5_4_1_the_sunpro_compiler_and_inline_functions">21.5.4.1. The SunPro compiler and inline functions</a></li>
</ul>
</li>
<li><a href="#_21_5_5_running_out_of_memory">21.5.5. Running out of memory</a></li>
</ul>
</li>
<li><a href="#_21_6_the_install_phase">21.6. The install phase</a>
<ul class="sectlevel2">
<li><a href="#_21_6_1_creating_needed_directories">21.6.1. Creating needed directories</a></li>
<li><a href="#_21_6_2_where_to_install_documentation">21.6.2. Where to install documentation</a></li>
<li><a href="#_21_6_3_installing_highscore_files">21.6.3. Installing highscore files</a></li>
<li><a href="#_21_6_4_adding_destdir_support_to_packages">21.6.4. Adding DESTDIR support to packages</a></li>
<li><a href="#_21_6_5_packages_with_hardcoded_paths_to_other_interpreters">21.6.5. Packages with hardcoded paths to other interpreters</a></li>
<li><a href="#_21_6_6_packages_installing_perl_modules">21.6.6. Packages installing Perl modules</a></li>
<li><a href="#_21_6_7_packages_installing_info_files">21.6.7. Packages installing info files</a></li>
<li><a href="#_21_6_8_packages_installing_man_pages">21.6.8. Packages installing man pages</a></li>
<li><a href="#_21_6_9_packages_installing_x11_fonts">21.6.9. Packages installing X11 fonts</a></li>
<li><a href="#_21_6_10_packages_installing_sgml_or_xml_data">21.6.10. Packages installing SGML or XML data</a></li>
<li><a href="#_21_6_11_packages_installing_extensions_to_the_mime_database">21.6.11. Packages installing extensions to the MIME database</a></li>
<li><a href="#_21_6_12_packages_using_intltool">21.6.12. Packages using intltool</a></li>
<li><a href="#_21_6_13_packages_installing_startup_scripts">21.6.13. Packages installing startup scripts</a></li>
<li><a href="#_21_6_14_packages_installing_tex_modules">21.6.14. Packages installing TeX modules</a></li>
<li><a href="#_21_6_15_packages_supporting_running_binaries_in_emulation">21.6.15. Packages supporting running binaries in emulation</a></li>
<li><a href="#_21_6_16_packages_installing_hicolor_icons">21.6.16. Packages installing hicolor icons</a></li>
<li><a href="#_21_6_17_packages_installing_desktop_files">21.6.17. Packages installing desktop files</a></li>
</ul>
</li>
<li><a href="#_21_7_marking_packages_as_having_problems">21.7. Marking packages as having problems</a></li>
</ul>
</li>
<li><a href="#_chapter_22_gnome_packaging_and_porting">Chapter 22. GNOME packaging and porting</a>
<ul class="sectlevel1">
<li><a href="#_22_1_meta_packages">22.1. Meta packages</a></li>
<li><a href="#_22_2_packaging_a_gnome_application">22.2. Packaging a GNOME application</a></li>
<li><a href="#_22_3_updating_gnome_to_a_newer_version">22.3. Updating GNOME to a newer version</a></li>
<li><a href="#_22_4_patching_guidelines">22.4. Patching guidelines</a></li>
</ul>
</li>
<li><a href="#_chapter_23_submitting_and_committing">Chapter 23. Submitting and Committing</a>
<ul class="sectlevel1">
<li><a href="#_23_1_submitting_binary_packages">23.1. Submitting binary packages</a></li>
<li><a href="#_23_2_submitting_source_packages_for_non_netbsd_developers">23.2. Submitting source packages (for non-NetBSD-developers)</a></li>
<li><a href="#_23_3_general_notes_when_adding_updating_or_removing_packages">23.3. General notes when adding, updating, or removing packages</a></li>
<li><a href="#_23_4_commit_messages">23.4. Commit Messages</a></li>
<li><a href="#_23_5_committing_adding_a_package_to_cvs">23.5. Committing: Adding a package to CVS</a></li>
<li><a href="#_23_6_updating_a_package_to_a_newer_version">23.6. Updating a package to a newer version</a></li>
<li><a href="#_23_7_renaming_a_package_in_pkgsrc">23.7. Renaming a package in pkgsrc</a></li>
<li><a href="#_23_8_moving_a_package_in_pkgsrc">23.8. Moving a package in pkgsrc</a></li>
</ul>
</li>
<li><a href="#_chapter_24_frequently_asked_questions">Chapter 24. Frequently Asked Questions</a>
<ul class="sectlevel1">
<li><a href="#_24_1_what_is_the_difference_between_makeflags_makeflags_and_make_flags">24.1. What is the difference between MAKEFLAGS, .MAKEFLAGS and MAKE_FLAGS?</a></li>
<li><a href="#_24_2_what_is_the_difference_between_make_gmake_and_make_program">24.2. What is the difference between MAKE, GMAKE and MAKE_PROGRAM?</a></li>
<li><a href="#_24_3_what_is_the_difference_between_cc_pkg_cc_and_pkgsrc_compiler">24.3. What is the difference between CC, PKG_CC and PKGSRC_COMPILER?</a></li>
<li><a href="#_24_4_why_does_make_show_var_varnamebuildlink_prefix_foo_say_its_empty">24.4. Why does <strong>make show-var VARNAME=BUILDLINK_PREFIX.<em>foo</em></strong> say it&#8217;s empty?</a></li>
<li><a href="#_24_5_what_does_master_site_sourceforgepackage_mean_i_dont_understand_the_inside_it">24.5. What does ${MASTER_SITE_SOURCEFORGE:=package/} mean? I don&#8217;t understand the := inside it.</a></li>
<li><a href="#_24_6_which_mailing_lists_are_there_for_package_developers">24.6. Which mailing lists are there for package developers?</a></li>
<li><a href="#_24_7_where_is_the_pkgsrc_documentation">24.7. Where is the pkgsrc documentation?</a></li>
<li><a href="#_24_8_i_have_a_little_time_to_kill_what_shall_i_do">24.8. I have a little time to kill. What shall I do?</a></li>
</ul>
</li>
<li><a href="#_chapter_25_design_of_the_pkgsrc_infrastructure">Chapter 25. Design of the pkgsrc infrastructure</a>
<ul class="sectlevel1">
<li><a href="#_25_1_the_meaning_of_variable_definitions">25.1. The meaning of variable definitions</a></li>
<li><a href="#_25_2_avoiding_problems_before_they_arise">25.2. Avoiding problems before they arise</a></li>
<li><a href="#_25_3_variable_evaluation">25.3. Variable evaluation</a>
<ul class="sectlevel2">
<li><a href="#_25_3_1_at_load_time">25.3.1. At load time</a></li>
<li><a href="#_25_3_2_at_runtime">25.3.2. At runtime</a></li>
</ul>
</li>
<li><a href="#_25_4_how_can_variables_be_specified">25.4. How can variables be specified?</a></li>
<li><a href="#_25_5_designing_interfaces_for_makefile_fragments">25.5. Designing interfaces for Makefile fragments</a>
<ul class="sectlevel2">
<li><a href="#_25_5_1_procedures_with_parameters">25.5.1. Procedures with parameters</a></li>
<li><a href="#_25_5_2_actions_taken_on_behalf_of_parameters">25.5.2. Actions taken on behalf of parameters</a></li>
</ul>
</li>
<li><a href="#_25_6_the_order_in_which_files_are_loaded">25.6. The order in which files are loaded</a>
<ul class="sectlevel2">
<li><a href="#_25_6_1_the_order_in_bsd_prefs_mk">25.6.1. The order in bsd.prefs.mk</a></li>
<li><a href="#_25_6_2_the_order_in_bsd_pkg_mk">25.6.2. The order in bsd.pkg.mk</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_chapter_27_porting_pkgsrc">Chapter 27. Porting pkgsrc</a>
<ul class="sectlevel1">
<li><a href="#_27_1_porting_pkgsrc_to_a_new_operating_system">27.1. Porting pkgsrc to a new operating system</a></li>
</ul>
</li>
<li><a href="#_appendix_a_a_simple_example_package_bison">Appendix A. A simple example package: bison</a>
<ul class="sectlevel1">
<li><a href="#_a_1_files">A.1. files</a>
<ul class="sectlevel2">
<li><a href="#_a_1_1_makefile">A.1.1. Makefile</a></li>
<li><a href="#_a_1_2_descr">A.1.2. DESCR</a></li>
<li><a href="#_a_1_3_plist">A.1.3. PLIST</a></li>
<li><a href="#_a_1_4_checking_a_package_with_pkglint">A.1.4. Checking a package with pkglint</a></li>
</ul>
</li>
<li><a href="#_a_2_steps_for_building_installing_packaging">A.2. Steps for building, installing, packaging</a></li>
</ul>
</li>
<li><a href="#_appendix_b_security_hardening">Appendix B. Security hardening</a>
<ul class="sectlevel1">
<li><a href="#_b_1_mechanisms">B.1. Mechanisms</a>
<ul class="sectlevel2">
<li><a href="#_b_1_1_enabled_by_default">B.1.1. Enabled by default</a>
<ul class="sectlevel3">
<li><a href="#_b_1_1_1_pkgsrc_use_fortify">B.1.1.1. PKGSRC_USE_FORTIFY</a></li>
<li><a href="#_b_1_1_2_pkgsrc_use_ssp">B.1.1.2. PKGSRC_USE_SSP</a></li>
<li><a href="#_b_1_1_3_pkgsrc_mkpie">B.1.1.3. PKGSRC_MKPIE</a></li>
<li><a href="#_b_1_1_4_pkgsrc_use_relro">B.1.1.4. PKGSRC_USE_RELRO</a></li>
</ul>
</li>
<li><a href="#_b_1_2_not_enabled_by_default">B.1.2. Not enabled by default</a>
<ul class="sectlevel3">
<li><a href="#_b_1_2_1_pkgsrc_mkrepro">B.1.2.1. PKGSRC_MKREPRO</a></li>
<li><a href="#_b_1_2_2_pkgsrc_use_stack_check">B.1.2.2. PKGSRC_USE_STACK_CHECK</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_b_2_caveats">B.2. Caveats</a>
<ul class="sectlevel2">
<li><a href="#_b_2_1_problems_with_pkgsrc_mkpie">B.2.1. Problems with PKGSRC_MKPIE</a>
<ul class="sectlevel3">
<li><a href="#_b_2_1_1_packages_failing_to_build">B.2.1.1. Packages failing to build</a>
<ul class="sectlevel4">
<li><a href="#_b_2_1_1_1_how_to_fix">B.2.1.1.1. How to fix</a></li>
</ul>
</li>
<li><a href="#_b_2_1_2_run_time_crashes">B.2.1.2. Run-time crashes</a></li>
<li><a href="#_b_2_1_3_disabling_pkgsrc_mkpie_on_a_per_package_basis">B.2.1.3. Disabling PKGSRC_MKPIE on a per-package basis</a></li>
</ul>
</li>
<li><a href="#_b_2_2_problems_with_pkgsrc_use_fortify">B.2.2. Problems with PKGSRC_USE_FORTIFY</a>
<ul class="sectlevel3">
<li><a href="#_b_2_2_1_packages_failing_to_build">B.2.2.1. Packages failing to build</a></li>
<li><a href="#_b_2_2_2_run_time_crashes">B.2.2.2. Run-time crashes</a></li>
<li><a href="#_b_2_2_3_optimization_is_required">B.2.2.3. Optimization is required</a></li>
<li><a href="#_b_2_2_4_disabling_fortify_on_a_per_package_basisnote">B.2.2.4. Disabling FORTIFY on a per-package basis[NOTE]</a></li>
</ul>
</li>
<li><a href="#_b_2_3_problems_with_pkgsrc_use_relro">B.2.3. Problems with PKGSRC_USE_RELRO</a>
<ul class="sectlevel3">
<li><a href="#_b_2_3_1_performance_impact">B.2.3.1. Performance impact</a></li>
<li><a href="#_b_2_3_2_run_time_crashes">B.2.3.2. Run-time crashes</a></li>
<li><a href="#_b_2_3_3_disabling_relro_on_a_per_package_basis">B.2.3.3. Disabling RELRO on a per-package basis</a></li>
</ul>
</li>
<li><a href="#_b_2_4_problems_with_pkgsrc_use_ssp">B.2.4. Problems with PKGSRC_USE_SSP</a>
<ul class="sectlevel3">
<li><a href="#_b_2_4_1_packages_failing_to_build">B.2.4.1. Packages failing to build</a></li>
<li><a href="#_b_2_4_2_run_time_crashes">B.2.4.2. Run-time crashes</a></li>
<li><a href="#_b_2_4_3_performance_impact">B.2.4.3. Performance impact</a></li>
<li><a href="#_b_2_4_4_disabling_ssp_on_a_per_package_basisnote">B.2.4.4. Disabling SSP on a per-package basis[NOTE]</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_b_3_auditing_the_system">B.3. Auditing the system</a>
<ul class="sectlevel2">
<li><a href="#_b_3_1_checking_for_pie">B.3.1. Checking for PIE</a></li>
<li><a href="#_b_3_2_checking_for_partial_relro">B.3.2. Checking for partial RELRO</a></li>
<li><a href="#_b_3_3_checking_for_full_relro">B.3.3. Checking for full RELRO</a></li>
<li><a href="#_b_3_4_checking_for_ssp">B.3.4. Checking for SSP</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_appendix_c_build_logs">Appendix C. Build logs</a>
<ul class="sectlevel1">
<li><a href="#_c_1_building_figlet">C.1. Building figlet</a></li>
<li><a href="#_c_2_packaging_figlet">C.2. Packaging figlet</a></li>
</ul>
</li>
<li><a href="#_appendix_d_directory_layout_of_the_pkgsrc_ftp_server">Appendix D. Directory layout of the pkgsrc FTP server</a>
<ul class="sectlevel1">
<li><a href="#_d_1_distfiles_the_distributed_source_files">D.1. distfiles: The distributed source files</a></li>
<li><a href="#_d_2_misc_miscellaneous_things">D.2. misc: Miscellaneous things</a></li>
<li><a href="#_d_3_packages_binary_packages">D.3. packages: Binary packages</a></li>
<li><a href="#_d_4_reports_bulk_build_reports">D.4. reports: Bulk build reports</a></li>
<li><a href="#_d_5_current_stable_pkgsrc_20xxqy_source_packages">D.5. current, stable, pkgsrc-20xxQy: source packages</a></li>
</ul>
</li>
<li><a href="#_appendix_e_help_topics">Appendix E. Help topics</a></li>
<li><a href="#_appendix_f_editing_guidelines_for_the_pkgsrc_guide">Appendix F. Editing guidelines for the pkgsrc guide</a>
<ul class="sectlevel1">
<li><a href="#_f_1_make_targets">F.1. Make targets</a></li>
<li><a href="#_f_2_procedure">F.2. Procedure</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<h1 id="_chapter_1_what_is_pkgsrc" class="sect0">Chapter 1. What is pkgsrc?</h1>
<div class="sect1">
<h2 id="_1_1_introduction">1.1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There is a lot of software freely available for Unix-based systems, which is usually available in form of the source code. Before such software can be used, it needs to be configured to the local system, compiled and installed, and this is exactly what The NetBSD Packages Collection (pkgsrc) does. pkgsrc also has some basic commands to handle binary packages, so that not every user has to build the packages for himself, which is a time-costly task.</p>
</div>
<div class="paragraph">
<p>pkgsrc currently contains several thousand packages, including:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/www/apache24/index.html"><code>www/apache24</code></a> - The Apache
web server</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/www/firefox/index.html"><code>www/firefox</code></a> - The Firefox
web browser</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/meta-pkgs/gnome/index.html"><code>meta-pkgs/gnome</code></a> - The GNOME
Desktop Environment</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/meta-pkgs/kde4/index.html"><code>meta-pkgs/kde4</code></a> - The K
Desktop Environment</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>… just to name a few.</p>
</div>
<div class="paragraph">
<p>pkgsrc has built-in support for handling varying dependencies, such as pthreads and X11, and extended features such as IPv6 support on a range of platforms.</p>
</div>
<div class="sect2">
<h3 id="_1_1_1_why_pkgsrc">1.1.1. Why pkgsrc?</h3>
<div class="paragraph">
<p>pkgsrc provides the following key features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Easy building of software from source as well as the creation
and installation of binary packages. The source and latest
patches are retrieved from a master or mirror download site, checksum
verified, then built on your system. Support for binary-only
distributions is available for both native platforms and NetBSD
emulated platforms.</p>
</li>
<li>
<p>All packages are installed in a consistent directory tree,
including binaries, libraries, man pages and other
documentation.</p>
</li>
<li>
<p>Tracking of package dependencies automatically, including when
performing updates, to ensure required packages are installed. The
configuration files of various packages are handled automatically during
updates, so local changes are preserved.</p>
</li>
<li>
<p>Like NetBSD, pkgsrc is designed with portability in mind and
consists of highly portable code. This allows the greatest speed of
development when porting to a new platform. This portability also
ensures that pkgsrc is <em>consistent across all
platforms</em>.</p>
</li>
<li>
<p>The installation prefix, acceptable software licenses,
international encryption requirements and build-time options for a
large number of packages are all set in a simple, central
configuration file.</p>
</li>
<li>
<p>The entire source (not including the distribution files) is
freely available under a BSD license, so you may extend and adapt
pkgsrc to your needs. Support for local packages and patches is
available right out of the box, so you can configure it specifically
for your environment.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following principles are basic to pkgsrc:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>“It should only work if it&#8217;s right.”&#8201;&#8212;&#8201;That means, if a package contains bugs, it&#8217;s better to find
them and to complain about them rather than to just install the package
and hope that it works. There are numerous checks in pkgsrc that try to
find such bugs: static analysis tools (<a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkglint/index.html"><code>pkgtools/pkglint</code></a>), build-time checks (portability
of shell scripts), and post-installation checks (installed files,
references to shared libraries, script interpreters).</p>
</li>
<li>
<p>“If it works, it should work everywhere”&#8201;&#8212;&#8201;Like NetBSD has been ported to many hardware architectures,
pkgsrc has been ported to many operating systems. Care is taken that
packages behave the same on all platforms.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_1_1_2_supported_platforms">1.1.2. Supported platforms</h3>
<div class="paragraph">
<p>pkgsrc consists of both a source distribution and a binary
distribution for these operating systems. After retrieving the required
source or binaries, you can be up and running with pkgsrc in just
minutes!</p>
</div>
<div class="paragraph">
<p>pkgsrc was derived from FreeBSD&#8217;s ports system, and
      initially developed for NetBSD only. Since then, pkgsrc has
      grown a lot, and now supports the following platforms:</p>
</div>
<div class="paragraph">
<p><strong>Table 1.1. Platforms supported by pkgsrc</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Platform</th>
<th class="tableblock halign-left valign-top">Date Support Added</th>
<th class="tableblock halign-left valign-top">Notes</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.NetBSD.org/">NetBSD</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Aug 1997</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://wwws.sun.com/software/solaris/">Solaris</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mar 1999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.Solaris">README.Solaris</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.kernel.org/">Linux</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jun 1999</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.Linux">README.Linux</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://developer.apple.com/macos/">Darwin / Mac OS X / OS X / macOS</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oct 2001</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.macOS">README.macOS</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.freebsd.org/">FreeBSD</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nov 2002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.FreeBSD">README.FreeBSD</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.openbsd.org/">OpenBSD</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nov 2002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.OpenBSD">README.OpenBSD</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.sgi.com/software/irix/">IRIX</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dec 2002</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.IRIX">README.IRIX</a>
	<a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.IRIX5.3">README.IRIX5.3</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BSD/OS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dec 2003</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www-1.ibm.com/servers/aix/">AIX</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Dec 2003</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.AIX">README.AIX</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.microsoft.com/windows/sfu/">Interix</a>
          (Microsoft Windows Services for Unix)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mar 2004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.Interix">README.Interix</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.dragonflybsd.org/">DragonFlyBSD</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Oct 2004</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="http://www.tru64.org/">OSF/1</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nov 2004</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.OSF1">README.OSF1</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.hp.com/products1/unix/">HP-UX</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Apr 2007</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.HPUX">README.HPUX</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.haiku-os.org/">Haiku</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Sep 2010</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.Haiku">README.Haiku</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.mirbsd.org/">MirBSD</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jan 2011</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.minix3.org/">Minix3</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Nov 2011</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.Minix3">README.Minix3</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cygwin.com/">Cygwin</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Mar 2013</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.Cygwin">README.Cygwin</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.debian.org/ports/kfreebsd-gnu/">GNU/kFreeBSD</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jul 2013</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.GNUkFreeBSD">README.GNUkFreeBSD</a></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://www.bitrig.org/">Bitrig</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Jun 2014</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/bootstrap/README.Bitrig">README.Bitrig</a></p></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_1_2_overview">1.2. Overview</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This document is divided into three parts. The first,
	<a href="http://netbsd.org/docs/pkgsrc/users-guide.html">The pkgsrc user&#8217;s guide</a>,
	describes how one can use one of the packages in the Package
	Collection, either by installing a precompiled binary package,
	or by building one&#8217;s own copy using the NetBSD package system.
	The second part, <a href="http://netbsd.org/docs/pkgsrc/developers-guide.html">The pkgsrc developer&#8217;s guide</a>, explains how to prepare a
	package so it can be easily built by other NetBSD users without
	knowing about the package&#8217;s building details. The third part,
	<a href="http://netbsd.org/docs/pkgsrc/infrastructure.html">The pkgsrc infrastructure internals</a>
	is intended for those who want to understand how pkgsrc is
	implemented.</p>
</div>
<div class="paragraph">
<p>This document is available in various formats:
	<a href="http://netbsd.org/docs/pkgsrc/index.html">HTML</a>, <a href="http://netbsd.org/docs/pkgsrc/pkgsrc.pdf">PDF</a>, <a href="http://netbsd.org/docs/pkgsrc/pkgsrc.ps">PS</a>, <a href="http://netbsd.org/docs/pkgsrc/pkgsrc.txt">TXT</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_1_3_terminology">1.3. Terminology</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There has been a lot of talk about “ports”, “packages”, etc. so far. Here is a description of all the terminology used within this document.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Package</dt>
<dd>
<p>A set of files and building instructions that describe what&#8217;s necessary to build a certain piece of software using pkgsrc. Packages are traditionally stored under /usr/pkgsrc, but may be stored in any location, referred to as PKGSRCDIR.</p>
</dd>
<dt class="hdlist1">The NetBSD package system</dt>
<dd>
<p>This is the former name of “pkgsrc”. It is part of the NetBSD operating system and can be bootstrapped to run on non-NetBSD operating systems as well. It handles building (compiling), installing, and removing of packages.</p>
</dd>
<dt class="hdlist1">Distfile</dt>
<dd>
<p>This term describes the file or files that are provided by the author of the piece of software to distribute his work. All the changes necessary to build on NetBSD are reflected in the corresponding package. Usually the distfile is in the form of a compressed tar-archive, but other types are possible, too. Distfiles are usually stored below /usr/pkgsrc/distfiles.</p>
</dd>
<dt class="hdlist1">Port</dt>
<dd>
<p>This is the term used by FreeBSD and OpenBSD people for what we call a package. In NetBSD terminology, “port” refers to a different architecture.</p>
</dd>
<dt class="hdlist1">Precompiled/binary package</dt>
<dd>
<p>A set of binaries built with pkgsrc from a distfile and stuffed together in a single .tgz file so it can be installed on machines of the same machine architecture without the need to recompile. Packages are usually generated in /usr/pkgsrc/packages; there is also an archive on ftp.NetBSD.org.
    Sometimes, this is referred to by the term “package” too, especially in the context of precompiled packages.</p>
</dd>
<dt class="hdlist1">Program</dt>
<dd>
<p>The piece of software to be installed which will be constructed from all the files in the distfile by the actions defined in the corresponding package.</p>
</dd>
</dl>
</div>
<div class="sect2">
<h3 id="_1_3_1_roles_involved_in_pkgsrc">1.3.1. Roles involved in pkgsrc</h3>
<div class="dlist">
<dl>
<dt class="hdlist1">pkgsrc users</dt>
<dd>
<p>The pkgsrc users are people who use the packages provided by pkgsrc. Typically they are system administrators.The people using the software that is inside the packages (maybe called “end users”) are not covered by the pkgsrc guide.There are two kinds of pkgsrc users: Some only want to install pre-built binary packages. Others build the pkgsrc packages from source, either for installing them directly or for building binary packages themselves. For pkgsrc users <a href="http://netbsd.org/docs/pkgsrc/users-guide.html">Part I, “The pkgsrc user&#8217;s guide”</a> should provide all necessary documentation.</p>
</dd>
<dt class="hdlist1">package maintainers</dt>
<dd>
<p>A package maintainer creates packages as described in <a href="http://netbsd.org/docs/pkgsrc/developers-guide.html">Part II, “The pkgsrc developer&#8217;s guide”</a>.</p>
</dd>
<dt class="hdlist1">infrastructure developers</dt>
<dd>
<p>These people are involved in all those files that live in the mk/ directory and below. Only these people should need to read through <a href="http://netbsd.org/docs/pkgsrc/infrastructure.html">Part III, “The pkgsrc infrastructure internals”</a>might be curious, too.</p>
</dd>
</dl>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_1_4_typography">1.4. Typography</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When giving examples for commands, shell prompts are used to show if the command should/can be issued as root, or if “normal” user privileges are sufficient. We use a # for root&#8217;s shell prompt, a % for users' shell prompt, assuming they use the C-shell or tcsh and a $ for bourne shell and derivatives.</p>
</div>
<div class="paragraph">
<div class="title">Next</div>
<p>Chapter 2. Getting help <a href="chapter-02.html">chapter-02.html</a></p>
</div>
</div>
</div>
<h1 id="_chapter_2_getting_help" class="sect0">Chapter 2. Getting help</h1>
<div class="paragraph">
<p>To get help when using pkgsrc, the definitive source is this
	document, the pkgsrc guide. If you don&#8217;t find anything here,
	there are alternatives:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The built-in pkgsrc help, which is available after bootstrapping
pkgsrc. Run <strong>bmake help topic=…</strong> to get
help for any topic, such as a variable name like
<code>BUILD_DEFS</code>, a make target like
<strong>do-build</strong>, a missing C or C++ function like
<strong>strcasecmp</strong> or any other topic.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The available help topics are listed in <a href="http://netbsd.org/docs/pkgsrc/help-topics.html">Appendix E, Help topics</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To see the value of a single variable, run <strong>bmake
show-var VARNAME=<em><code>X</code></em></strong>.</p>
</li>
<li>
<p>To see the values of the most common variables, run
<strong>bmake show-all</strong>. These variables are grouped by
topic. To see the variables for a single topic, run
<strong>bmake
show-all-<em><code>topic</code></em></strong>, for example
<strong>bmake show-all-fetch</strong>.</p>
</li>
<li>
<p>The pkgsrc-users mailing list, to which
<a href="https://www.NetBSD.org/mailinglists/#pkgsrc-users">you
can subscribe</a> and then <a href="mailto:pkgsrc-users@NetBSD.org">ask your
questions</a>.</p>
</li>
<li>
<p>The #pkgsrc IRC channel, which is accessible
<a href="https://webchat.freenode.net/">via a web browser</a>
or by using a specialized chat program such as
<a href="http://xchat.org/">XChat</a>.
Pick any user name and join the channel #pkgsrc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<div class="title">Next</div>
<p>Chapter 3. Where to get pkgsrc and how to keep it up-to-date <a href="chapter-03.html">chapter-03.html</a></p>
</div>
<div class="paragraph">
<div class="title">Previous</div>
<p>Chapter 1. What is pkgsrc? <a href="chapter-01.html">chapter-01.html</a></p>
</div>
<h1 id="_chapter_3_where_to_get_pkgsrc_and_how_to_keep_it_up_to_date" class="sect0">Chapter 3. Where to get pkgsrc and how to keep it up-to-date</h1>
<div class="paragraph">
<p>Before you download and extract the files, you need to decide where you want to extract them. When using pkgsrc as root user, pkgsrc is usually installed in <code>/usr/pkgsrc</code>. You are though free to install the sources and binary packages wherever you want in your filesystem, provided that the pathname does not contain white-space or other characters that are interpreted specially by the shell and some other programs. A safe bet is to use only letters, digits, underscores and dashes.</p>
</div>
<div class="sect1">
<h2 id="_3_1_getting_pkgsrc_for_the_first_time">3.1. Getting pkgsrc for the first time</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before you download any pkgsrc files, you should decide whether you want the <em>current</em> branch or the <em>stable</em> branch. The latter is forked on a 	quarterly basis from the current branch and only gets modified for security updates. The names of the stable branches are built from the year and the quarter, for example <code>2021Q4</code>.</p>
</div>
<div class="paragraph">
<p>The second step is to decide <em>how</em> you want to download pkgsrc. You can get it as a tar file or via CVS. Both ways are described here.</p>
</div>
<div class="paragraph">
<p>Note that tar archive contains CVS working copy.
Thus you can switch to using CVS at any later time.</p>
</div>
<div class="sect2">
<h3 id="_3_1_1_as_tar_archive">3.1.1. As tar archive</h3>
<div class="paragraph">
<p>The primary download location for all pkgsrc files is <a href="https://cdn.NetBSD.org/pub/pkgsrc/">https://cdn.NetBSD.org/pub/pkgsrc/</a> or <a href="ftp://ftp.NetBSD.org/pub/pkgsrc/">ftp://ftp.NetBSD.org/pub/pkgsrc/</a> (it points to the same location). There are a number of subdirectories for different purposes,which are described in detail in <a href="http://netbsd.org/docs/pkgsrc/ftp-layout.html">Appendix D, Directory layout of the pkgsrc FTP server</a>.</p>
</div>
<div class="paragraph">
<p>The tar archive for the current branch is in the directory <code>current</code> and is called <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc.tar.gz"><code>pkgsrc.tar.gz</code></a>. It is autogenerated weekly.</p>
</div>
<div class="paragraph">
<p>To save download time we provide bzip2- and	xz-compressed archives which are published at <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc.tar.bz2"><code>pkgsrc.tar.bz2</code></a> and <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc.tar.xz"><code>pkgsrc.tar.xz</code></a> respectively.</p>
</div>
<div class="paragraph">
<p>You can fetch the same files using FTP.</p>
</div>
<div class="paragraph">
<p>The tar file for the stable branch 2021Q4 is in the	directory <code>pkgsrc-2021Q4</code> and is also called <a href="https://cdn.NetBSD.org/pub/pkgsrc/pkgsrc-2021Q4/pkgsrc.tar.gz"><code>pkgsrc.tar.gz</code></a>.</p>
</div>
<div class="paragraph">
<p>To download the latest pkgsrc stable tarball, run:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ ftp ftp://ftp.NetBSD.org/pub/pkgsrc/pkgsrc-2021Q4/pkgsrc.tar.gz</pre>
</div>
</div>
<div class="paragraph">
<p>If you prefer, you can also fetch it using "wget", "curl", or your web browser.</p>
</div>
<div class="paragraph">
<p>Then, extract it with:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ tar -xzf pkgsrc.tar.gz -C /usr</pre>
</div>
</div>
<div class="paragraph">
<p>This will create the directory <code>pkgsrc/</code> in <code>/usr/</code> and all the package source will be stored under <code>/usr/pkgsrc/</code>.</p>
</div>
<div class="paragraph">
<p>To download pkgsrc-current, run:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ ftp ftp://ftp.NetBSD.org/pub/pkgsrc/current/pkgsrc.tar.gz</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_3_1_2_via_anonymous_cvs">3.1.2. Via anonymous CVS</h3>
<div class="paragraph">
<p>To fetch a specific pkgsrc stable branch, run:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cd /usr &amp;&amp; cvs -q -z2 -d anoncvs@anoncvs.NetBSD.org:/cvsroot checkout -r pkgsrc-2021Q4 -P pkgsrc</pre>
</div>
</div>
<div class="paragraph">
<p>This will create the directory <code>pkgsrc/</code>in your <code>/usr/</code> directory and all the package source will be stored under <code>/usr/pkgsrc/</code>.</p>
</div>
<div class="paragraph">
<p>To fetch the pkgsrc current branch, run:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cd /usr &amp;&amp; cvs -q -z2 -d anoncvs@anoncvs.NetBSD.org:/cvsroot checkout -P pkgsrc</pre>
</div>
</div>
<div class="paragraph">
<p>Refer to the <a href="https://www.NetBSD.org/mirrors/#anoncvs">list of available mirrors</a> to choose a faster CVS mirror, if needed.</p>
</div>
<div class="paragraph">
<p>If you get error messages from <code>rsh</code>, you need to set CVS_RSH variable. E.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cd /usr &amp;&amp; env CVS_RSH=ssh cvs -q -z2 -d anoncvs@anoncvs.NetBSD.org:/cvsroot checkout -P pkgsrc</pre>
</div>
</div>
<div class="paragraph">
<p>Refer to documentation on your command shell how to set CVS_RSH=ssh permanently.For Bourne shells, you can set it in your <code>.profile</code> or better globally in <code>/etc/profile</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># set CVS remote shell command
CVS_RSH=ssh
export CVS_RSH</pre>
</div>
</div>
<div class="paragraph">
<p>By default, CVS doesn&#8217;t do things like most people would expect it to do. But there is a way to convince CVS, by creating a file called <code>.cvsrc</code> in your home directory and saving the following lines to it. This file will save you lots of headache and some bug reports, so we strongly recommend it. You can find an explanation of this file in the CVS documentation.</p>
</div>
<div class="literalblock">
<div class="content">
<pre># recommended CVS configuration file from the pkgsrc guide
cvs -q
checkout -P
update -dP
diff -upN
rdiff -u
release -d</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_3_2_keeping_pkgsrc_up_to_date">3.2. Keeping pkgsrc up-to-date</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The preferred way to keep pkgsrc up-to-date is via CVS (which also works if you have first installed it via a tar file). It saves bandwidth and hard disk activity, compared to downloading the tar file again.</p>
</div>
<div class="sect2">
<h3 id="_3_2_1_via_tar_files">3.2.1. Via tar files</h3>
<div class="admonitionblock warning">
<table>
<tr>
<td class="icon">
<i class="fa icon-warning" title="Warning"></i>
</td>
<td class="content">
<strong>WARNING</strong>. When updating from a tar file, you first need to completely remove the old pkgsrc directory. Otherwise those files that have been removed from pkgsrc in the mean time will not be removed on your local disk, resulting in inconsistencies. When removing the old files, any changes that you have done to the pkgsrc files will be lost after updating. Therefore updating via CVS is strongly recommended.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Note that by default the distfiles and the binary packages are saved in the pkgsrc tree, so don&#8217;t forget to rescue them before updating. You can also configure pkgsrc to store distfiles and packages in directories outside the pkgsrc tree by setting the <code>DISTDIR</code> and <code>PACKAGES</code> variables. See <a href="http://netbsd.org/docs/pkgsrc/configuring.html">Chapter 6, Configuring pkgsrc</a> for the details.</p>
</div>
<div class="paragraph">
<p>To update pkgsrc from a tar file, download the tar file as explained above. Then, make sure that you have not made any changes to the files in the pkgsrc directory. Remove the pkgsrc	directory and extract the new tar file. Done.</p>
</div>
</div>
<div class="sect2">
<h3 id="_3_2_2_via_cvs">3.2.2. Via CVS</h3>
<div class="paragraph">
<p>To update pkgsrc via CVS, change to the <code>pkgsrc</code> directory and run cvs:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cd /usr/pkgsrc &amp;&amp; cvs update -dP</pre>
</div>
</div>
<div class="paragraph">
<p>If you get error messages from <code>rsh</code>, you need to set CVS_RSH variable as described above. E.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cd /usr/pkgsrc &amp;&amp; env CVS_RSH=ssh cvs up -dP</pre>
</div>
</div>
<div class="sect3">
<h4 id="_3_2_2_1_switching_between_different_pkgsrc_branches">3.2.2.1. Switching between different pkgsrc branches</h4>
<div class="paragraph">
<p>When updating pkgsrc, the CVS program keeps track of the branch you selected. But if you, for whatever reason, want to switch from the stable branch to the current one, you can do it by adding the option “-A” after the “update” keyword. To switch from the current branch back to the stable branch, add the “-rpkgsrc-2021Q4” option.</p>
</div>
</div>
<div class="sect3">
<h4 id="_3_2_2_2_what_happens_to_my_changes_when_updating">3.2.2.2. What happens to my changes when updating?</h4>
<div class="paragraph">
<p>When you update pkgsrc, the CVS program will only touch those files that are registered in the CVS repository. That means that any packages that you created on your own will stay unmodified. If you change files that are managed by CVS, later updates will try to merge your changes with those that have been done by others. See the CVS manual, chapter “update” for details.</p>
</div>
</div>
</div>
</div>
</div>
<h1 id="_chapter_4_using_pkgsrc_on_systems_other_than_netbsd" class="sect0">Chapter 4. Using pkgsrc on systems other than NetBSD</h1>
<div class="sect1">
<h2 id="_4_1_binary_distribution">4.1. Binary distribution</h2>
<div class="sectionbody">
<div class="paragraph">
<p>See <a href="http://netbsd.org/docs/pkgsrc/using.html#using-pkg">Section 5.1, “Using binary packages”</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_4_2_bootstrapping_pkgsrc">4.2. Bootstrapping pkgsrc</h2>
<div class="sectionbody">
<div class="paragraph">
<p>pkgsrc can be bootstrapped for use in two different modes: privileged and unprivileged one. In unprivileged mode in contrast to privileged one all programs are installed under one particular user and cannot utilise privileged operations (packages don&#8217;t create special users and all special file permissions like setuid are ignored).</p>
</div>
<div class="paragraph">
<p>Installing the bootstrap kit from source should be as simple as:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># env CVS_RSH=ssh cvs -d anoncvs@anoncvs.NetBSD.org:/cvsroot checkout -P pkgsrc
# cd pkgsrc/bootstrap
# ./bootstrap</pre>
</div>
</div>
<div class="paragraph">
<p>To bootstrap in unprivileged mode pass “--unprivileged” flag to <strong>bootstrap</strong></p>
</div>
<div class="paragraph">
<p>By default, in privileged mode pkgsrc uses <code>/usr/pkg</code> for <em>prefix</em> where programs will be installed in, and <code>/usr/pkg/pkgdb</code> for the package database directory where pkgsrc will do its internal bookkeeping,<code>/var</code> is used as <em>varbase</em>,where packages install their persistent data. In unprivileged mode pkgsrc uses <code>~/pkg</code> for <em>prefix</em>, <code>~/pkg/pkgdb</code> for the package database, and <code>~/pkg/var</code> for <em>varbase</em>.</p>
</div>
<div class="paragraph">
<p>You can change default layout using command-line arguments. Run “./bootstrap --help” to get details.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The bootstrap installs a <strong>bmake</strong> tool. Use this <strong>bmake</strong> when building via pkgsrc. For examples in this guide, use <strong>bmake</strong> instead of “make”.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>It is possible to bootstrap multiple instances of pkgsrc using non-intersecting directories. Use <strong>bmake</strong> corresponding to the installation you&#8217;re working with to build and install packages.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<h1 id="_chapter_5_using_pkgsrc" class="sect0">Chapter 5. Using pkgsrc</h1>
<div class="paragraph">
<p>Basically, there are two ways of using pkgsrc. The first is to only install the package tools and to use binary packages that someone else has prepared. This is the “pkg” in pkgsrc. The second way is to install the “src” of pkgsrc, too. Then you are able to build your own packages, and you can still use binary packages from someone else.</p>
</div>
<div class="sect1">
<h2 id="_5_1_using_binary_packages">5.1. Using binary packages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>On the <a href="https://cdn.NetBSD.org/">cdn.NetBSD.org</a> site and mirrors, there are collections of binary packages, ready to be installed. These binary packages have been built using the default settings for the directories, that is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>/usr/pkg</code> for <code>LOCALBASE</code>, where most of the files are installed,</p>
</li>
<li>
<p><code>/usr/pkg/etc</code> for configuration files,</p>
</li>
<li>
<p><code>/var</code> for <code>VARBASE</code>, where those files are installed that may change after installation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If you cannot use these directories for whatever reasons (maybe because you&#8217;re not root), you cannot use these binary packages, but have to build the packages yourself, which is explained in <a href="http://netbsd.org/docs/pkgsrc/platforms.html#bootstrapping-pkgsrc">Section 4.2, “Bootstrapping pkgsrc”</a>.</p>
</div>
<div class="sect2">
<h3 id="_5_1_1_finding_binary_packages">5.1.1. Finding binary packages</h3>
<div class="paragraph">
<p>To install binary packages, you first need to know from where
    to get them. The first place where you should look is on the main
    pkgsrc CDN in the directory <a href="https://cdn.NetBSD.org/pub/pkgsrc/packages/"><code>/pub/pkgsrc/packages</code></a>.</p>
</div>
<div class="paragraph">
<p>This directory contains binary packages for multiple
    platforms. First, select your operating system. (Ignore the
    directories with version numbers attached to it, they just exist for
    legacy reasons.) Then, select your hardware architecture, and in the
    third step, the OS version and the “version” of pkgsrc.</p>
</div>
<div class="paragraph">
<p>In this directory, you often find a file called <code>bootstrap.tar.gz</code> which contains the package management tools. If the file is missing, it is likely that your operating system already provides those tools. Download the file and extract it in the <code>/</code> directory. It will create the directories <code>/usr/pkg</code> (containing the tools for managing binary packages and the database of installed packages).</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_1_2_installing_binary_packages">5.1.2. Installing binary packages</h3>
<div class="paragraph">
<p>In the directory from the last section, there is a subdirectory called <code>All/</code>, which contains all the binary packages that are available for the platform, excluding those that may not be distributed via HTTP or FTP.</p>
</div>
<div class="paragraph">
<p>To install packages directly from an FTP or HTTP server, run the following commands in a Bourne-compatible shell (be sure to <strong>su</strong> to root first):</p>
</div>
<div class="literalblock">
<div class="content">
<pre># PATH="/usr/pkg/sbin:/usr/pkg/bin:$PATH"
# PKG_PATH="https://cdn.NetBSD.org/pub/pkgsrc/packages"
# PKG_PATH="$PKG_PATH/OPSYS/ARCH/VERSIONS/All/"
# export PATH PKG_PATH
# pkg_add pkgin</pre>
</div>
</div>
<div class="paragraph">
<p>Instead of URLs, you can also use local paths, for example if you are installing from a set of CDROMs, DVDs or an NFS-mounted repository. If you want to install packages from multiple sources, you can separate them by a semicolon in <code>PKG_PATH</code>.</p>
</div>
<div class="paragraph">
<p>After these preparations, installing a package is very easy:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># pkgin search nginx
nginx-1.19.6         Lightweight HTTP server and mail proxy server
nginx-1.18.0nb8      Lightweight HTTP server and mail proxy server
# pkgin install zsh nginx-1.19.6 vim</pre>
</div>
</div>
<div class="paragraph">
<p>Note that <strong>pkgin</strong> is a user-friendly frontend to the <strong>pkg_</strong>* tools.</p>
</div>
<div class="paragraph">
<p>Any prerequisite packages needed to run the package in question will be installed, too, assuming they are present in the repository.</p>
</div>
<div class="paragraph">
<p>After you&#8217;ve installed packages, be sure to have <code>/usr/pkg/bin</code> and <code>/usr/pkg/sbin</code> in your <code>PATH</code> so you can actually start the just installed program.</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_1_3_updating_packages">5.1.3. Updating packages</h3>
<div class="paragraph">
<p>To update binary packages, it is recommended that you use <strong>pkgin upgrade</strong>. This will compare the remote package repository to your locally installed packages and safely replace any older packages.</p>
</div>
<div class="paragraph">
<p>Note that pkgsrc is released as quarterly branches. If you are updating to a newer quarterly branch of pkgsrc, you may need to adjust the repository in <code>/usr/pkg/etc/pkgin/repositories.conf</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_1_4_deinstalling_packages">5.1.4. Deinstalling packages</h3>
<div class="paragraph">
<p>To deinstall a package, it does not matter whether it was installed from source code or from a binary package. Neither the <strong>pkgin</strong> or the <strong>pkg_delete</strong> command need to know.</p>
</div>
<div class="paragraph">
<p>To delete a package, you can just run <strong>pkgin remove <em>package-name</em></strong>. The package name can be given with or without version number.</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_1_5_getting_information_about_installed_packages">5.1.5. Getting information about installed packages</h3>
<div class="paragraph">
<p>The <strong>pkg_info</strong> shows information about installed packages or binary package files. As with other management tools, it works with packages installed from source or binaries.</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_1_6_checking_for_security_vulnerabilities_in_installed_packages">5.1.6. Checking for security vulnerabilities in installed packages</h3>
<div class="paragraph">
<p>The pkgsrc Security Team and Packages Groups maintain a list of known vulnerabilities to packages which are (or have been) included in pkgsrc.  The list is available from the NetBSD CDN at <a href="https://cdn.NetBSD.org/pub/NetBSD/packages/vulns/pkg-vulnerabilities">https://cdn.NetBSD.org/pub/NetBSD/packages/vulns/pkg-vulnerabilities</a>.</p>
</div>
<div class="paragraph">
<p>Please note that not every "vulnerability" with a CVE assignment is exploitable in every configuration. Some bugs are marked as active simply because an fix was not marked as such.Operating system specific hardening and mitigation features may also reduce the impact of bugs.</p>
</div>
<div class="paragraph">
<p>Through <strong>pkg_admin fetch-pkg-vulnerabilities</strong>, this list can be downloaded automatically, and a security audit of all packages installed on a system can take place.</p>
</div>
<div class="paragraph">
<p>There are two components to auditing. The firs step, <strong>pkg_admin fetch-pkg-vulnerabilities</strong>, is for downloading the list of vulnerabilities from the NetBSD FTP site. The second step, <strong>pkg_admin audit</strong>, checks to see if any of your installed packages are vulnerable.  If a package is vulnerable, you will see output similar to the following:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Package samba-2.0.9 has a local-root-shell vulnerability, see
https://www.samba.org/samba/whatsnew/macroexploit.html</pre>
</div>
</div>
<div class="paragraph">
<p>You may wish to have the <a href="https://cdn.NetBSD.org/pub/pkgsrc/distfiles/vulnerabilities">vulnerabilities</a> file downloaded daily so that it remains current. This may be done by adding an appropriate entry to the root users <a href="http://man.NetBSD.org/NetBSD-9.2/i386/crontab.5">crontab(5)</a> entry. For example the entry</p>
</div>
<div class="literalblock">
<div class="content">
<pre># Download vulnerabilities file
0 3 * * * /usr/pkg/sbin/pkg_admin fetch-pkg-vulnerabilities &gt;/dev/null 2&gt;&amp;1
# Audit the installed packages and email results to root
9 3 * * * /usr/pkg/sbin/pkg_admin audit |mail -s "Installed package audit result" \
         root &gt;/dev/null 2&gt;&amp;1</pre>
</div>
</div>
<div class="paragraph">
<p>will update the vulnerability list every day at 3AM, followed by an audit at 3:09AM. The result of the audit are then emailed to root. On NetBSD this may be accomplished instead by adding the following line to <code>/etc/daily.conf</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fetch_pkg_vulnerabilities=YES</pre>
</div>
</div>
<div class="paragraph">
<p>to fetch the vulnerability list from the daily security script. The system is set to audit the packages by default but can be set explicitly, if desired (not required), by adding the following line to <code>/etc/security.conf</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>check_pkg_vulnerabilities=YES</pre>
</div>
</div>
<div class="paragraph">
<p>see <a href="http://man.NetBSD.org/NetBSD-9.2/i386/daily.conf.5">daily.conf(5)</a> and <a href="http://man.NetBSD.org/NetBSD-9.2/i386/security.conf.5">security.conf(5)</a> for more details.</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_1_7_finding_if_newer_versions_of_your_installed_packages_are_in_pkgsrc">5.1.7. Finding if newer versions of your installed packages are in pkgsrc</h3>
<div class="paragraph">
<p>Install <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/lintpkgsrc/index.html"><code>pkgtools/lintpkgsrc</code></a> and run <strong>lintpkgsrc</strong> with the “-i” argument to check if any packages are stale, e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% lintpkgsrc -i
...
Version mismatch: 'tcsh' 6.09.00 vs 6.10.00</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_5_1_8_other_administrative_functions">5.1.8. Other administrative functions</h3>
<div class="paragraph">
<p>The <strong>pkg_admin</strong> executes various administrative functions on the package system.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_5_2_building_packages_from_source">5.2. Building packages from source</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After obtaining pkgsrc, the <code>pkgsrc</code> directory now contains a set of packages, organized into categories. You can browse the online index of packages, or run <strong>make readme</strong> from the <code>pkgsrc</code>directory to build local <code>README.html</code> files for all packages, viewable with any web browser such as <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/www/lynx/index.html"><code>www/lynx</code></a> or <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/www/firefox/index.html"><code>www/firefox</code></a>.</p>
</div>
<div class="paragraph">
<p>The default <em>prefix</em> for installed packages is <code>/usr/pkg</code>. If you wish to change this, you should do so by setting <code>LOCALBASE</code> in <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>. You should not try to use multiple different <code>LOCALBASE</code> definitions on the same system (inside a chroot is an exception).</p>
</div>
<div class="paragraph">
<p>The rest of this chapter assumes that the package is already in pkgsrc. If it is not, see <a href="http://netbsd.org/docs/pkgsrc/developers-guide.html">Part II, “The pkgsrc developer&#8217;s guide”</a> for instructions how to create your own packages.</p>
</div>
<div class="sect2">
<h3 id="_5_2_1_requirements">5.2.1. Requirements</h3>
<div class="paragraph">
<p>To build packages from source, you need a working C compiler. On NetBSD, you need to install the "comp” and the “text” distribution sets. If you want to build X11-related packages, the “xbase” and “xcomp” distribution sets are required, too.</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_2_2_fetching_distfiles">5.2.2. Fetching distfiles</h3>
<div class="paragraph">
<p>The first step for building a package is downloading the distfiles (i.e. the unmodified source). If they have not yet been downloaded, pkgsrc will fetch them automatically.</p>
</div>
<div class="paragraph">
<p>If you have all files that you need in the <code>distfiles</code> directory, you don&#8217;t need to connect. If the distfiles are on CD-ROM, you can mount the CD-ROM on <code>/cdrom</code> and add:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTDIR=/cdrom/pkgsrc/distfiles</pre>
</div>
</div>
<div class="paragraph">
<p>to your <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>.</p>
</div>
<div class="paragraph">
<p>By default a list of distribution sites will be randomly intermixed to prevent huge load on servers which holding popular packages (for example, SourceForge.net mirrors). Thus, every time when you need to fetch yet another distfile all the mirrors will be tried in new (random) order. You can turn this feature off by setting <code>MASTER_SORT_RANDOM=NO</code> (for <code>PKG_DEVELOPER</code>s it&#8217;s already disabled).</p>
</div>
<div class="paragraph">
<p>You can overwrite some of the major distribution sites to fit to sites that are close to your own.  By setting one or two variables you can modify the order in which the master sites are accessed. <code>MASTER_SORT</code> contains a whitespace delimited list of domain suffixes. <code>MASTER_SORT_REGEX</code> is even more flexible, it contains a whitespace delimited list of regular expressions.  It has higher priority than <code>MASTER_SORT</code>.  Have a look at <code>pkgsrc/mk/defaults/mk.conf</code> to find some examples.  This may save some of your bandwidth and time.</p>
</div>
<div class="paragraph">
<p>You can change these settings either in your shell&#8217;s environment, or, if you want to keep the settings, by editing the <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> file, and adding the definitions there.</p>
</div>
<div class="paragraph">
<p>If a package depends on many other packages (such as <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/meta-pkgs/kde4/index.html"><code>meta-pkgs/kde4</code></a>), the build process may alternate between periods of downloading source, and compiling. To ensure you have all the source downloaded initially you can run the command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% make fetch-list | sh</pre>
</div>
</div>
<div class="paragraph">
<p>which will output and run a set of shell commands to fetch the necessary files into the <code>distfiles</code> directory. You can also choose to download the files manually.</p>
</div>
</div>
<div class="sect2">
<h3 id="_5_2_3_how_to_build_and_install">5.2.3. How to build and install</h3>
<div class="paragraph">
<p>Once the software has downloaded, any patches will be applied, then it will be compiled for you. This may take some time depending on your computer, and how many other packages the software depends on and their compile time.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>If using bootstrap or pkgsrc on a non-NetBSD system, use the pkgsrc <strong>bmake</strong> command instead of "make” in the examples in this guide.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>For example, type</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% cd misc/figlet
% make</pre>
</div>
</div>
<div class="paragraph">
<p>at the shell prompt to build the various components of the package.</p>
</div>
<div class="paragraph">
<p>The next stage is to actually install the newly compiled program onto your system. Do this by entering:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% make install</pre>
</div>
</div>
<div class="paragraph">
<p>while you are still in the directory for whatever package you are installing.</p>
</div>
<div class="paragraph">
<p>Installing the package on your system may require you to be root.  However, pkgsrc has a <em>just-in-time-su</em> feature, which allows you to only become root for the actual installation step.</p>
</div>
<div class="paragraph">
<p>That&#8217;s it, the software should now be installed and setup for use. You can now enter:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% make clean</pre>
</div>
</div>
<div class="paragraph">
<p>to remove the compiled files in the work directory, as you shouldn&#8217;t need them any more. If other packages were also added to your system (dependencies) to allow your program to compile, you can tidy these up also with the command:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% make clean-depends</pre>
</div>
</div>
<div class="paragraph">
<p>Taking the figlet utility as an example, we can install it on our system by building as shown in <a href="http://netbsd.org/docs/pkgsrc/logs.html">Appendix C, Build logs</a>.</p>
</div>
<div class="paragraph">
<p>The program is installed under the default root of the packages tree - <code>/usr/pkg</code>. Should this not conform to your tastes, set the <code>LOCALBASE</code> variable in your environment, and it will use that value as the root of your packages tree. So, to use <code>/usr/local</code>, set <code>LOCALBASE=/usr/local</code> in your environment.Please note that you should use a directory which is dedicated to packages and not shared with other programs (i.e., do not try and use <code>LOCALBASE=/usr</code>).  Also, you should not try to add any of your own files or directories (such as <code>src/</code>, <code>obj/</code>, or <code>pkgsrc/</code>) below the <code>LOCALBASE</code> tree. This is to prevent possible conflicts between programs and other files installed by the package system and whatever else may have been installed there.</p>
</div>
<div class="paragraph">
<p>Some packages look in <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> to alter some configuration options at build time. Have a look at <code>pkgsrc/mk/defaults/mk.conf</code> to get an overview of what will be set there by default. Environment variables such as <code>LOCALBASE</code> can be set in <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> to save having to remember to set them each time you want to use pkgsrc.</p>
</div>
<div class="paragraph">
<p>Occasionally, people want to “look under the covers” to see what is going on when a package is building or being installed. This may be for debugging purposes, or out of simple curiosity. A number of utility values have been added to help with this.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you invoke the <a href="http://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> command with <code>PKG_DEBUG_LEVEL=2</code>, then a huge amount of information will be displayed. For example,</p>
<div class="literalblock">
<div class="content">
<pre>make patch PKG_DEBUG_LEVEL=2</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>will show all the commands that are invoked, up to and including the “patch” stage.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If you want to know the value of a certain <a href="http://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> definition, then the <code>VARNAME</code> definition should be used, in conjunction with the show-var target. e.g. to show the expansion of the <a href="http://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> variable <code>LOCALBASE</code>:</p>
<div class="literalblock">
<div class="content">
<pre>% make show-var VARNAME=LOCALBASE
/usr/pkg
%</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you want to install a binary package that you&#8217;ve either created yourself (see next section), that you put into pkgsrc/packages manually or that is located on a remote FTP server, you can use the "bin-install" target. This target will install a binary package - if available - via <a href="http://man.NetBSD.org/NetBSD-9.2/i386/pkg_add.1">pkg_add(1)</a>, else do a <strong>make package</strong>.  The list of remote FTP sites searched is kept in the variable <code>BINPKG_SITES</code>, which defaults to ftp.NetBSD.org. Any flags that should be added to <a href="http://man.NetBSD.org/NetBSD-9.2/i386/pkg_add.1">pkg_add(1)</a> can be put into <code>BIN_INSTALL_FLAGS</code>.  See <code>pkgsrc/mk/defaults/mk.conf</code> for more details.</p>
</div>
<div class="paragraph">
<p>A final word of warning: If you set up a system that has a non-standard setting for <code>LOCALBASE</code>, be sure to set that before any packages are installed, as you cannot use several directories for the same purpose. Doing so will result in pkgsrc not being able to properly detect your installed packages, and fail miserably. Note also that precompiled binary packages are usually built with the default <code>LOCALBASE</code> of <code>/usr/pkg</code>, and that you should <em>not</em> install any if you use a non-standard <code>LOCALBASE</code>.</p>
</div>
</div>
</div>
</div>
<h1 id="_chapter_6_configuring_pkgsrc" class="sect0">Chapter 6. Configuring pkgsrc</h1>
<div class="paragraph">
<p>The whole pkgsrc system is configured in a single file, usually called <code>mk.conf</code>. In which directory pkgsrc looks for that file depends on the installation. On NetBSD, when you use <a href="http://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> from the base system, it is in the directory <code>/etc/</code>. In all other cases the default location is <code>${PREFIX}/etc/</code>, depending on where you told the bootstrap program to install the binary packages.</p>
</div>
<div class="paragraph">
<p>The format of the configuration file is that of the usual BSD-style <code>Makefile</code>s. The whole pkgsrc configuration is done by setting variables in this file. Note that you can define all kinds of variables, and no special error checking (for example for spelling mistakes) takes place.</p>
</div>
<div class="sect1">
<h2 id="_6_1_general_configuration">6.1. General configuration</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following variables apply to all pkgsrc packages. A complete list of the variables that can be configured by the user is available in <code>mk/defaults/mk.conf</code>, together with some comments that describe each variable&#8217;s intent.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LOCALBASE</code>: Where packages will be installed. The default is <code>/usr/pkg</code>. Do not mix binary packages with different <code>LOCALBASE</code>s!</p>
</li>
<li>
<p><code>CROSSBASE</code>: Where “cross” category packages will be installed. The default is <code>${LOCALBASE}/cross</code>.</p>
</li>
<li>
<p><code>X11BASE</code>: Where X11 is installed on the system. The default is <code>/usr/X11R7</code>.</p>
</li>
<li>
<p><code>DISTDIR</code>: Where to store the downloaded copies of the original source distributions used for building pkgsrc packages. The default is <code>${PKGSRCDIR}/distfiles</code>.</p>
</li>
<li>
<p><code>PKG_DBDIR</code>: Where the database about installed packages is stored.  The default is <code>/usr/pkg/pkgdb</code>.</p>
</li>
<li>
<p><code>MASTER_SITE_OVERRIDE</code>: If set, override the packages' <code>MASTER_SITES</code> with this value.</p>
</li>
<li>
<p><code>MASTER_SITE_BACKUP</code>: Backup location(s) for distribution files and patch files if not found locally or in <code>${MASTER_SITES}</code> or <code>${PATCH_SITES}</code> respectively.The defaults is <code><a href="ftp://ftp.NetBSD.org/pub/pkgsrc/distfiles/${DIST_SUBDIR}/" class="bare">ftp://ftp.NetBSD.org/pub/pkgsrc/distfiles/${DIST_SUBDIR}/</a></code>.</p>
</li>
<li>
<p><code>BINPKG_SITES</code>: List of sites carrying binary pkgs. <em><code>rel</code></em> and <em><code>arch</code></em> are replaced with OS release (“2.0”, etc.) and architecture (“mipsel”, etc.).</p>
</li>
<li>
<p><code>ACCEPTABLE_LICENSES</code>: List of acceptable licenses. License names are case-sensitive. Whenever you try to build a package whose license is not in this list, you will get an error message. If the license condition is simple enough, the error message will include specific instructions on how to change this variable.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_6_2_variables_affecting_the_build_process">6.2. Variables affecting the build process</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>PACKAGES</code>: The top level directory for the binary packages. The default is <code>${PKGSRCDIR}/packages</code>.</p>
</li>
<li>
<p><code>WRKOBJDIR</code>: The top level directory where, if defined, the separate working directories will get created, and symbolically linked to from <code>${WRKDIR}</code> (see below). This is useful for building packages on several architectures, then <code>${PKGSRCDIR}</code> can be NFS-mounted while <code>${WRKOBJDIR}</code>is local to every architecture. (It should be noted that <code>PKGSRCDIR</code> should not be set by the user&#8201;&#8212;&#8201;it is an internal definition which refers to the root of the pkgsrc tree. It is possible to have many pkgsrc tree instances.)</p>
</li>
<li>
<p><code>LOCALPATCHES</code>: Directory for local patches that aren&#8217;t part of pkgsrc. See <a href="http://netbsd.org/docs/pkgsrc/components.html#components.patches">Section 12.3, “<code>patches/*</code>”</a> for more information.</p>
</li>
<li>
<p><code>PKGMAKECONF</code>: Location of the <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> file used by a package&#8217;s BSD-style Makefile. If this is not set, <code>MAKECONF</code> is set to <code>/dev/null</code> to avoid picking up settings used by builds in <code>/usr/src</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_6_3_variables_affecting_the_installation_process">6.3. Variables affecting the installation process</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>PKGSRC_KEEP_BIN_PKGS</code>: By default, binary packages of built packages are preserved in <code>${PACKAGES}/All</code>. Setting this variable to "no" prevents this.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Packages have to support installation into a subdirectory of <code>WRKDIR</code>. This allows a package to be built, before the actual filesystem is touched. DESTDIR support exists in two variations:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Basic DESTDIR support means that the package installation and packaging is still run as root.</p>
</li>
<li>
<p>Full DESTDIR support can run the complete build, installation and packaging as normal user. Root privileges are only needed to add packages.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>With basic DESTDIR support, <strong>make clean</strong> needs to be run as root.</p>
</div>
<div class="paragraph">
<p>Considering the <code>foo/bar</code> package, DESTDIR full support can be tested using the following commands</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ id
uid=1000(myusername) gid=100(users) groups=100(users),0(wheel)
$ mkdir $HOME/packages
$ cd $PKGSRCDIR/foo/bar</pre>
</div>
</div>
<div class="paragraph">
<p>Verify <code>DESTDIR</code> full support, no root privileges should be needed</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ make stage-install</pre>
</div>
</div>
<div class="paragraph">
<p>Create a package without root privileges</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ make PACKAGES=$HOME/packages package</pre>
</div>
</div>
<div class="paragraph">
<p>For the following command, you must be able to gain root privileges using <a href="http://man.NetBSD.org/NetBSD-9.2/i386/su.1">su(1)</a></p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ make PACKAGES=$HOME/packages install</pre>
</div>
</div>
<div class="paragraph">
<p>Then, as a simple user</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ make clean</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_6_4_selecting_and_configuring_the_compiler">6.4. Selecting and configuring the compiler</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_6_4_1_selecting_the_compiler">6.4.1. Selecting the compiler</h3>
<div class="paragraph">
<p>By default, pkgsrc will use GCC to build packages. This may be overridden by setting the following variables in /etc/mk.conf:</p>
</div>
<div class="paragraph">
<p><code>PKGSRC_COMPILER</code>:</p>
</div>
<div class="paragraph">
<p>This is a list of values specifying the chain of compilers to invoke when building packages. Valid values are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>ccc</code>: Compaq C Compilers (Tru64)</p>
</li>
<li>
<p><code>ccache</code>: compiler cache (chainable)</p>
</li>
<li>
<p><code>clang</code>: Clang C and Objective-C compiler</p>
</li>
<li>
<p><code>distcc</code>: distributed C/C++ (chainable)</p>
</li>
<li>
<p><code>f2c</code>: Fortran 77 to C compiler (chainable)</p>
</li>
<li>
<p><code>icc</code>: Intel C++ Compiler (Linux)</p>
</li>
<li>
<p><code>ido</code>: SGI IRIS Development Option cc (IRIX 5)</p>
</li>
<li>
<p><code>gcc</code>: GNU C/C++ Compiler</p>
</li>
<li>
<p><code>hp</code>: HP-UX C/aC++ compilers</p>
</li>
<li>
<p><code>mipspro</code>: Silicon Graphics, Inc. MIPSpro (n32/n64)</p>
</li>
<li>
<p><code>mipspro-ucode</code>: Silicon Graphics, Inc. MIPSpro (o32)</p>
</li>
<li>
<p><code>sunpro</code>: Sun Microsystems, Inc. WorkShip/Forte/Sun ONE Studio</p>
</li>
<li>
<p><code>xlc</code>: IBM&#8217;s XL C/C++ compiler suite</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The default is “<code>gcc</code>”. You can use <code>ccache</code> and/or <code>distcc</code> with an appropriate <code>PKGSRC_COMPILER</code> setting, e.g. “<code>ccache gcc</code>”. This variable should always be terminated with a value for a real compiler. Note that only one real compiler should be listed (e.g. “<code>sunpro gcc</code>” is not allowed).</p>
</div>
<div class="paragraph">
<p><code>GCC_REQD</code>: This specifies the minimum version of GCC to use when building packages. If the system GCC doesn&#8217;t satisfy this requirement, then pkgsrc will build and install one of the GCC packages to use instead.</p>
</div>
<div class="paragraph">
<p><code>PYTHON_VERSION_DEFAULT</code>: Specifies which version of python to use when several options are available.</p>
</div>
<div class="paragraph">
<p><code>PKGSRC_FORTRAN</code>: Specifies the Fortran compiler to use.  The default is <code>gfortran</code>.</p>
</div>
<div class="paragraph">
<p><code>GFORTRAN_VERSION</code>: If <code>PKGSRC_FORTRAN = gfortran</code> is used, this option specifies which version to use.</p>
</div>
</div>
<div class="sect2">
<h3 id="_6_4_2_additional_flags_to_the_compiler_cflags">6.4.2. Additional flags to the compiler (CFLAGS)</h3>
<div class="paragraph">
<p>If you wish to set the <code>CFLAGS</code> variable, please make sure to use the <code>+=</code> operator instead of the <code>=</code> operator:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CFLAGS+=        -your -flags</pre>
</div>
</div>
<div class="paragraph">
<p>Using <code>CFLAGS=</code> (i.e. without the “+”) may lead to problems with packages that need to add their own flags.  You may want to take a look at the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/devel/cpuflags/index.html"><code>devel/cpuflags</code></a> package if you&#8217;re interested in optimization specifically for the current CPU.</p>
</div>
</div>
<div class="sect2">
<h3 id="_6_4_3_additional_flags_to_the_linker_ldflags">6.4.3. Additional flags to the linker (LDFLAGS)</h3>
<div class="paragraph">
<p>If you want to pass flags to the linker, both in the configure step and the build step, you can do this in two ways. Either set <code>LDFLAGS</code> or <code>LIBS</code>. The difference between the two is that <code>LIBS</code> will be appended to the command line, while <code>LDFLAGS</code> come earlier. <code>LDFLAGS</code> is pre-loaded with rpath settings for ELF machines depending on the setting of <code>USE_IMAKE</code> or the inclusion of <code>mk/x11.buildlink3.mk</code>.  As with <code>CFLAGS</code>, if you do not wish to override these settings, use the <code>+=</code> operator:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>LDFLAGS+=        -your -linkerflags</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_6_5_developeradvanced_settings">6.5. Developer/advanced settings</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p><code>PKG_DEVELOPER</code>: Run some sanity checks that package developers want:</p>
<div class="ulist">
<ul>
<li>
<p>make sure patches apply with zero fuzz</p>
</li>
<li>
<p>run check-shlibs to see that all binaries will find their shared libs.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>PKG_DEBUG_LEVEL</code>: The level of debugging output which is displayed whilst making and installing the package. The default value for this is 0, which will not display the commands as they are executed (normal, default, quiet operation); the value 1 will display all shell commands before their invocation, and the value 2 will display both the shell commands before their invocation, as well as their actual execution progress with <strong>set -x</strong>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_6_6_selecting_build_options">6.6. Selecting Build Options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some packages have build time options, usually to select between different dependencies, enable optional support for big dependencies or enable experimental features.</p>
</div>
<div class="paragraph">
<p>To see which options, if any, a package supports, and which options are mutually exclusive, run <strong>make show-options</strong>, for example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>The following options are supported by this package:
    ssl      Enable SSL support.
Exactly one of the following gecko options is required:
    firefox  Use firefox as gecko rendering engine.
    mozilla  Use mozilla as gecko rendering engine.
At most one of the following database options may be selected:
    mysql    Enable support for MySQL database.
    pgsql    Enable support for PostgreSQL database.
These options are enabled by default: firefox
These options are currently enabled: mozilla ssl</pre>
</div>
</div>
<div class="paragraph">
<p>The following variables can be defined in <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> to select which options to enable for a package: <code>PKG_DEFAULT_OPTIONS</code>, which can be used to select or disable options for all packages that support them, and <code>PKG_OPTIONS.<em>pkgbase</code></em>, which can be used to select or disable options specifically for package <em><code>pkgbase</code></em>.  Options listed in these variables are selected, options preceded by “-” are disabled. A few examples:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ grep "PKG.*OPTION" mk.conf
PKG_DEFAULT_OPTIONS=    -arts -dvdread -esound
PKG_OPTIONS.kdebase=    debug -sasl
PKG_OPTIONS.apache=     suexec</pre>
</div>
</div>
<div class="paragraph">
<p>It is important to note that options that were specifically suggested by the package maintainer must be explicitly removed if you do not wish to include the option.  If you are unsure you can view the current state with <strong>make show-options</strong>.</p>
</div>
<div class="paragraph">
<p>The following settings are consulted in the order given, and the last setting that selects or disables an option is used:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>the default options as suggested by the package maintainer</p>
</li>
<li>
<p>the options implied by the settings of legacy variables (see below)</p>
</li>
<li>
<p><code>PKG_DEFAULT_OPTIONS</code></p>
</li>
<li>
<p><code>PKG_OPTIONS.<em>pkgbase</code></em></p>
</li>
</ol>
</div>
<div class="paragraph">
<p>For groups of mutually exclusive options, the last option selected is used, all others are automatically disabled. If an option of the group is explicitly disabled, the previously selected option, if any, is used. It is an error if no option from a required group of options is selected, and building the package will fail.</p>
</div>
<div class="paragraph">
<p>Before the options framework was introduced, build options were selected by setting a variable (often named <code>USE<em>_FOO</code></em>) in <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> for each option. To ease transition to the options framework for the user, these legacy variables are converted to the appropriate options setting (<code>PKG_OPTIONS.<em>pkgbase</code></em>) automatically. A warning is issued to prompt the user to update <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> to use the options framework directly. Support for the legacy variables will be removed eventually.</p>
</div>
</div>
</div>
<h1 id="_chapter_7_creating_binary_packages" class="sect0">Chapter 7. Creating binary packages</h1>
<div class="sect1">
<h2 id="_7_1_building_a_single_binary_package">7.1. Building a single binary package</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once you have built and installed a package, you can create a <em>binary package</em> which can be installed on another system with <a href="http://man.NetBSD.org/NetBSD-9.2/i386/pkg_add.1">pkg_add(1)</a>.This saves having to build the same package on a group of hosts and wasting CPU time. It also provides a simple means for others to install your package, should you distribute it.</p>
</div>
<div class="paragraph">
<p>To create a binary package, change into the appropriate directory in pkgsrc, and run <strong>make package</strong>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cd misc/figlet
$ make package</pre>
</div>
</div>
<div class="paragraph">
<p>This will build and install your package (if not already done), and then build a binary package from what was installed. You can then use the <strong>pkg_</strong>* tools to manipulate it.Binary packages are created by default in <code>/usr/pkgsrc/packages</code>, in the form of a gzipped tar file. See <a href="http://netbsd.org/docs/pkgsrc/logs.html#logs.package">Section C.2, “Packaging figlet”</a> for a continuation of the above <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/misc/figlet/index.html"><code>misc/figlet</code></a> example.</p>
</div>
<div class="paragraph">
<p>See <a href="http://netbsd.org/docs/pkgsrc/submit.html">Chapter 23, Submitting and Committing</a> for information on how to submit such a binary package.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_7_2_settings_for_creation_of_binary_packages">7.2. Settings for creation of binary packages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>See <a href="http://netbsd.org/docs/pkgsrc/build.html#build.helpful-targets">Section 13.17, “Other helpful targets”</a>.</p>
</div>
</div>
</div>
<h1 id="_chapter_8_creating_binary_packages_for_everything_in_pkgsrc_bulk_builds" class="sect0">Chapter 8. Creating binary packages for everything in pkgsrc (bulk builds)</h1>
<div class="paragraph">
<p>For a number of reasons, you may want to build binary packages for a large selected set of packages in pkgsrc, or even for all pkgsrc packages. For instance, when you have multiple machines that should run the same software, it is wasted time if they all build their packages themselves from source. Or you may want to build a list of packages you want and check them before deploying onto production systems. There is a way of getting a set of binary packages: the bulk build system, or pbulk ("p" stands for "parallel"). This chapter describes how to set it up.</p>
</div>
<div class="sect1">
<h2 id="_8_1_preparations">8.1. Preparations</h2>
<div class="sectionbody">
<div class="paragraph">
<p>First of all, you have to decide whether you build all packages
or a limited set of them. Full bulk builds usually consume a lot more resources, both space and time, than builds for some practical sets of packages. A number of particularly heavy packages exist that are not actually interesting to a wide audience. (The approximate resource consumption for a full bulk build is given in section <a href="https://www.netbsd.org/docs/pkgsrc/bulk.html#bulk.req">Section 8.3, “Requirements of a full bulk build”</a>.) For limited bulk builds you need to make a list of packages you want to build.
Note that all their dependencies will be built, so you don&#8217;t need to track them manually.</p>
</div>
<div class="paragraph">
<p>During bulk builds various packages are installed and deinstalled
in <code>/usr/pkg</code> (or whatever <code>LOCALBASE</code> is), so make sure that you don&#8217;t need any package during the builds. Essentially, you should provide a fresh system, either a chroot environment
or something even more restrictive, depending on what the operating system provides, or dedicate the whole physical machine. As a useful side effect this makes sure that bulk builds cannot break anything in your system. There have been numerous cases where certain packages tried to install files outside the
<code>LOCALBASE</code> or wanted to edit some files in <code>/etc</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_8_2_running_a_bulk_build">8.2. Running a bulk build</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Running a bulk build works roughly as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>First, build the pbulk infrastructure in a fresh pkgsrc location.</p>
</li>
<li>
<p>Then, build each of the packages from a clean installation directory using the infrastructure.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_8_2_1_configuration">8.2.1. Configuration</h3>
<div class="paragraph">
<p>To simplify configuration, we provide the helper script <code>mk/pbulk/pbulk.sh</code>.</p>
</div>
<div class="paragraph">
<p>In order to use it, prepare a clear system (real one, chroot environment, jail, zone, virtual machine). Configure network access to fetch distribution files. Create a user with name "pbulk".</p>
</div>
<div class="paragraph">
<p>Fetch and extract pkgsrc. Use a command like one of these:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># (cd /usr &amp;&amp; ftp -o - https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc.tar.gz | tar -zxf-)
# (cd /usr &amp;&amp; fetch -o - https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc.tar.gz | tar -zxf-)
# (cd /usr &amp;&amp; cvs -Q -z3 -d anoncvs@anoncvs.NetBSD.org:/cvsroot get -P pkgsrc)</pre>
</div>
</div>
<div class="paragraph">
<p>Or any other way that fits (e.g., curl, wget).</p>
</div>
<div class="paragraph">
<p>Deploy and configure pbulk tools, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># sh pbulk.sh -n # use native make, no bootstrap kit needed (for use on NetBSD)
# sh pbulk.sh -n -c mk.conf.frag # native, apply settings from given mk.conf fragment
# sh pbulk.sh -nlc mk.conf.frag # native, apply settings, configure for limited build</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><code>mk.conf.frag</code> is a fragment of <code>mk.conf</code> that contains settings you want to apply to packages you build. For instance,</p>
</div>
<div class="listingblock">
<div class="content">
<pre>PKG_DEVELOPER=          yes     # perform more checks
X11_TYPE=               modular # use pkgsrc X11
SKIP_LICENSE_CHECK=     yes     # accept all licences (useful
                                # when building all packages)</pre>
</div>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If configured for limited list, replace the list in <code>/usr/pbulk/etc/pbulk.list</code> with your list of packages, one per line without empty lines or comments. E.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>www/firefox
mail/thunderbird
misc/libreoffice4</pre>
</div>
</div>
<div class="paragraph">
<p>At this point you can also review configuration in <code>/usr/pbulk/etc</code> and make final amendments, if wanted.</p>
</div>
<div class="paragraph">
<p>Start it:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># /usr/pbulk/bin/bulkbuild</pre>
</div>
</div>
<div class="paragraph">
<p>After it finishes, you&#8217;ll have <code>/mnt</code> filled with distribution files, binary packages, and reports, plain text summary in <code>/mnt/bulklog/meta/report.txt</code></p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>pbulk.sh</code> script does not cover all possible use cases. While being ready to run, it serves as a good starting point to understand and build more complex setups. The script is kept small enough for better understanding.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p>The <code>pbulk.sh</code> script supports running unprivileged bulk build and helps configuring distributed bulk builds. Distributed bulk builds support either building in worker chroots (each node is a path to a different chroot) that replicate the target system, including the pbulk prefix,
or remote machines (each node is an IP address that must be accessible over SSH without a password).</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_8_3_requirements_of_a_full_bulk_build">8.3. Requirements of a full bulk build</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A complete bulk build requires lots of disk space. Some of the disk space can be read-only, some other must be writable. Some can be on remote filesystems (such as NFS) and some should be local. Some can be temporary filesystems, others must survive a sudden reboot.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>70 GB for the distfiles (read-write, remote, temporary)</p>
</li>
<li>
<p>60 GB for the binary packages (read-write, remote, permanent)</p>
</li>
<li>
<p>1 GB for the pkgsrc tree (read-only, remote, permanent)</p>
</li>
<li>
<p>5 GB for <code>LOCALBASE</code> (read-write, local, temporary)</p>
</li>
<li>
<p>10 GB for the log files (read-write, remote, permanent)</p>
</li>
<li>
<p>5 GB for temporary files (read-write, local, temporary)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_8_4_bulk_build_variants">8.4. Bulk build variants</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To ensure that pkgsrc packages work in different configurations, it makes sense to run non-default bulk builds from time to time. This section lists some ideas for bulk builds that intentionally let packages fail if they don&#8217;t follow the pkgsrc style.</p>
</div>
<div class="sect2">
<h3 id="_8_4_1_detect_unknown_configure_options">8.4.1. Detect unknown configure options</h3>
<div class="paragraph">
<p>Add the following line to <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GNU_CONFIGURE_STRICT=   yes</pre>
</div>
</div>
<div class="paragraph">
<p>When a package fails this additional check, the most common cause is that the configure option was valid for an older version of the package but does not apply anymore. In that case, just remove it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_8_4_2_detect_classes_of_bugs_by_forcing_compiler_warnings">8.4.2. Detect classes of bugs by forcing compiler warnings</h3>
<div class="paragraph">
<p>The job of a compiler is not restricted to producing executable code, most compilers also detect typical programming mistakes. The pkgsrc compiler wrappers make it easy to force compiler options when the package is built. This can be used to find typical bugs across all packages that are in pkgsrc. By reporting these bugs upstream, the packages will be more reliable with the next updates.</p>
</div>
<div class="paragraph">
<p>Add some of the following lines to <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CFLAGS+=        -Werror=char-subscripts
CFLAGS+=        -Werror=implicit-function-declaration</pre>
</div>
</div>
<div class="paragraph">
<p>When a package fails to build using these stricter compiler options, document the circumstances in which the compiler produced the error message. This includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The platform (<code>MACHINE_PLATFORM</code>)</p>
</li>
<li>
<p>The source file</p>
</li>
<li>
<p>An excerpt of the code. GCC and Clang already do this as part of the diagnostic.</p>
</li>
<li>
<p>The exact error message from the compiler.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a package produces these error messages, but the package is fine, record this in your local <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>, like this, to skip this check in the next builds:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.if ${PKGPATH} == category/package
# Version ${VERSION} failed on ${MACHINE_PLATFORM}:
# error message
# code
# Reason why the code does not need to be fixed.
BUILDLINK_TRANSFORM+=   rm:-Werror=char-subscripts
.endif</pre>
</div>
</div>
<div class="paragraph">
<p>If the error messages from the compiler are valid and the code needs to be fixed, prepare a local patch (see <code>LOCALPATCHES</code>) and report the bug to the upstream authors of the package, providing them with the information you collected above.</p>
</div>
<div class="paragraph">
<p>Patches that are not essential for the package to work should only be reported upstream but not committed to pkgsrc, to make future updates easier.</p>
</div>
</div>
<div class="sect2">
<h3 id="_8_4_3_force_compiler_options_only_in_the_build_phase">8.4.3. Force compiler options only in the build phase</h3>
<div class="paragraph">
<p>When adding custom compiler flags via <code>CFLAGS</code>, these apply to all phases of the package build process. Especially in the configure phase, adding <code>-Werror</code> leads to wrong decisions. The GNU configure scripts feed many small test programs to the C compiler to see whether certain headers are available, functions are defined in a library and programs can be run. In many cases these programs would not survive a strict compiler run with <code>-Wall -Wextra -Werror</code>.</p>
</div>
<div class="paragraph">
<p>The pkgsrc infrastructure is flexible enough to support compiler options being added between the <code>configure</code> and <code>build</code> phases. It&#8217;s a little more complicated than the other examples in this section but still easy enough.</p>
</div>
<div class="paragraph">
<p>The basic idea is to use the pkgsrc compiler wrapper to inject the desired compiler options. The compiler wrapper&#8217;s original task is to hide
unwanted directories of include files and to normalize compiler options.
It does this by wrapping the compiler command and rewriting the command
line. To see this in action, run <strong>bmake patch</strong> in a package directory and examine the <code>work/.cwrappers/config</code> directory. It contains individual configurations for the C compiler and the related tools.The
plan is to find a hook between the configure and build phases, and to
modify these configuration files at that point.</p>
</div>
<div class="paragraph">
<p>To find this hook, have a look at <code>mk/build/build.mk</code>, which contains among others the <code>pre-build-checks-hook</code>. The word <code>checks</code> doesn&#8217;t quite fit, but the <code>pre-build-hook</code> sounds good enough.</p>
</div>
<div class="paragraph">
<p>The code to be included in <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># Just a few example options.
BUILD_ONLY_CFLAGS=      -Wall -Werror -O2 -DTEMPDIR='"/tmp"'</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>.if ${BUILD_ONLY_CFLAGS:U:M*}
pre-build-checks-hook: add-build-only-cflags</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>add-build-only-cflags: .PHONY
    ${RUN} cd ${CWRAPPERS_CONFIG_DIR};      \
    ${TEST} ! -f ${.TARGET} || exit 0;      \
    for flag in ${BUILD_ONLY_CFLAGS}; do    \
            ${ECHO} "append=$$flag" &gt;&gt; cc;  \
    done;                                   \
    &gt; ${.TARGET}
.endif</pre>
</div>
</div>
<div class="paragraph">
<p>(When editing the <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>, make sure that the commands of the <code>add-build-only-cflags</code> target are indented with a tab, not with spaces.)</p>
</div>
<div class="paragraph">
<p>The condition in the <code>.if</code> statement contains the <code>:U</code> modifier to prevent parse errors if the variable should be undefined, possibly because it is only defined for a subset of the packages. The <code>:M*</code> modifier ensures that there is at least one compiler option, to prevent a syntax error in the shell parser.</p>
</div>
<div class="paragraph">
<p>The code around the <code>${.TARGET}</code> variable ensures that the additional compiler options are only appended once, even if <strong>bmake build</strong> is run multiple times. To do this, it creates a marker file.</p>
</div>
<div class="paragraph">
<p>To verify that this setup works, run <strong>bmake configure</strong> in a package directory. Up to now, everything works as usual. Examine the directory
<code>work/.cwrappers/config</code> to see that the compiler options from <code>BUILD_ONLY_CFLAGS</code> are not yet added to the file <code>cc</code>. Examine the tail of the <code>work/.work.log</code> file to see that the normal compiler
options are used.</p>
</div>
<div class="paragraph">
<p>Now run <strong>bmake build</strong>. This will append the options to the file <code>cc</code> and will create the marker file in the same directory. After that, the build starts as usual, but with the added compiler options. Examine the tail of the file <code>work/.work.log</code> to see that the lines starting with
<code>[*]</code> don&#8217;t contain the compiler options, but the corresponding lines starting with <code>&lt;.&gt;</code> do end with these options.</p>
</div>
<div class="paragraph">
<p>Building packages using this setup variant and fixing the resulting bugs is the same as in <a href="https://www.netbsd.org/docs/pkgsrc/bulk.html#bulk.var.comperr">Section 8.4.2, “Detect classes of bugs by forcing compiler warnings”</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_8_4_4_use_custom_directories">8.4.4. Use custom directories</h3>
<div class="paragraph">
<p>Some directories like <code>PREFIX</code>, <code>VARBASE</code>, <code>PKG_SYSCONFDIR</code>, <code>PKGMANDIR</code>, <code>PKG_INFODIR</code> can be configured in pkgsrc. Set these to arbitrary paths during bootstrap or afterwards in <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PREFIX=         /a-random-uuid
PKG_SYSCONFDIR= /a-random-uuid
VARBASE=        /a-random-uuid
PKGMANDIR=	a-random-uuid
PKG_INFODIR=	a-random-uuid</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_8_4_5_turn_warnings_into_errors">8.4.5. Turn warnings into errors</h3>
<div class="paragraph">
<p>When building a package, warnings are typically ignored since they just flow by and do not cause the build to fail immediately. To find these warnings, redefine them to errors in <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DELAYED_WARNING_MSG=    ${DELAYED_ERROR_MSG} "(was warning)"
WARNING_MSG=            ${FAIL_MSG} "(was warning)"</pre>
</div>
</div>
<div class="paragraph">
<p>There are many more classes of warnings in pkgsrc, and most of them can be redefined with a simple definition like above.</p>
</div>
<div class="paragraph">
<p>If a package suggests to add <code>USE_TOOLS+=perl</code> to the package Makefile, research whether the package actually needs Perl. If it does, add <code>USE_TOOLS+=perl</code> to the package Makefile, and if it doesn&#8217;t, add <code>TOOLS_BROKEN+=perl</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_8_4_6_reject_packages_for_which_pkglint_reports_errors">8.4.6. Reject packages for which pkglint reports errors</h3>
<div class="paragraph">
<p>Using pkglint as part of the regular build process is mostly a waste of time. If you want to fix some of the warnings, just run pkglint recursively on the whole pkgsrc tree. This will take a few minutes (up to 10), which is much faster than a complete bulk build.</p>
</div>
</div>
<div class="sect2">
<h3 id="_8_4_7_reject_packages_that_contain_forbidden_strings">8.4.7. Reject packages that contain forbidden strings</h3>
<div class="paragraph">
<p>To ensure that the binary packages don&#8217;t contain references to the build directory, there is already <code>CHECK_WRKREF</code>. If that variable includes the item <code>extra</code>, it is possible to define additional patterns that must not appear in any installed file. This is specified in <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>HECK_WRKREF=                   extra
CHECK_WRKREF_EXTRA_DIRS+=       /usr/local
CHECK_WRKREF_EXTRA_DIRS+=       /usr/pkg
CHECK_WRKREF_EXTRA_DIRS+=	@[A-Z][A-Z]*@</pre>
</div>
</div>
<div class="paragraph">
<p>The above patterns will probably generate many false positives, therefore the results need to be taken with a grain of salt.</p>
</div>
</div>
<div class="sect2">
<h3 id="_8_4_8_reject_packages_whose_self_test_fails">8.4.8. Reject packages whose self-test fails</h3>
<div class="paragraph">
<p>To run the test suites that come with each package, add this line to <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PKGSRC_RUN_TEST=        yes</pre>
</div>
</div>
<div class="paragraph">
<p>Be prepared that even the most basic packages fail this test. When doing a bulk build with this, it will often abort in the early phase where the packages are scanned for their dependencies since there are cyclic dependencies. There is still a lot to do in this area.</p>
</div>
</div>
<div class="sect2">
<h3 id="_8_4_9_reject_packages_that_use_undefined_shell_variables">8.4.9. Reject packages that use undefined shell variables</h3>
<div class="paragraph">
<p>To catch typos in the shell snippets from the Makefile fragments, add the <code>-u</code> flag to most of the commands by adding this line to <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>RUN=    @set -eu;</pre>
</div>
</div>
<div class="paragraph">
<p>After that, ensure that none of the bulk build log files (even those for successfully built packages) contains the string <code>parameter not set</code> or whatever error message the command <strong>sh -ceu '$undefined'</strong> outputs.</p>
</div>
<div class="paragraph">
<p>See <code>mk/misc/common.mk</code> for the existing definition.</p>
</div>
</div>
<div class="sect2">
<h3 id="_8_4_10_turn_off_verbose_logging">8.4.10. Turn off verbose logging</h3>
<div class="paragraph">
<p>The build logs of a package are often quite long. This allows error messages or other interesting details to hide between the noise. To make
the actual error message stand out more, add these lines to <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GNU_CONFIGURE_QUIET=    yes
MAKE_FLAGS+=            -s</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>-s</code> option works for both GNU Make and BSD Make. On exotic platforms with their own make, it may be a little different.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_8_5_creating_a_multiple_cd_rom_packages_collection">8.5. Creating a multiple CD-ROM packages collection</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After your pkgsrc bulk-build has completed, you may wish to create a CD-ROM set of the resulting binary packages to assist in installing packages on other machines. The <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/cdpack/index.html"><code>pkgtools/cdpack</code></a> package provides a simple tool for creating the ISO 9660 images. <strong>cdpack</strong> arranges the packages on the CD-ROMs in a way that keeps all the dependencies for a given package on the same CD as that package.</p>
</div>
<div class="sect2">
<h3 id="_8_5_1_example_of_cdpack">8.5.1. Example of cdpack</h3>
<div class="paragraph">
<p>Complete documentation for cdpack is found in the cdpack(1) man page. The following short example assumes that the binary packages are left in <code>/usr/pkgsrc/packages/All</code> and that sufficient disk space exists in <code>/u2</code> to hold the ISO 9660 images.</p>
</div>
<div class="literalblock">
<div class="content">
<pre># mkdir /u2/images
# pkg_add /usr/pkgsrc/packages/All/cdpack
# cdpack /usr/pkgsrc/packages/All /u2/images</pre>
</div>
</div>
<div class="paragraph">
<p>If you wish to include a common set of files(<code>COPYRIGHT</code>, <code>README</code>, etc.) on each CD in the collection, then you need to create a directory which contains these files, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># mkdir /tmp/common
# echo "This is a README" &gt; /tmp/common/README
# echo "Another file" &gt; /tmp/common/COPYING
# mkdir /tmp/common/bin
# echo "#!/bin/sh" &gt; /tmp/common/bin/myscript
# echo "echo Hello world" &gt;&gt; /tmp/common/bin/myscript
# chmod 755 /tmp/common/bin/myscript</pre>
</div>
</div>
<div class="paragraph">
<p>Now create the images:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># cdpack -x /tmp/common /usr/pkgsrc/packages/All /u2/images</pre>
</div>
</div>
<div class="paragraph">
<p>Each image will contain <code>README</code>, <code>COPYING</code>, and <code>bin/myscript</code> in their root directories.</p>
</div>
</div>
</div>
</div>
<h1 id="_chapter_9_directory_layout_of_the_installed_files" class="sect0">Chapter 9. Directory layout of the installed files</h1>
<div class="paragraph">
<p>The files that are installed by pkgsrc are organized in a way that
is similar to what you find in the <code>/usr</code> directory of the base system. But some details are different. This is because pkgsrc initially came from FreeBSD and had adopted its file system hierarchy. Later it was largely influenced by NetBSD. But no matter which operating system you are using pkgsrc with, you can expect the same layout for pkgsrc.</p>
</div>
<div class="paragraph">
<p>There are mainly four root directories for pkgsrc, which are all configurable in the <code>bootstrap/bootstrap</code> script. When pkgsrc has been installed as root, the default locations are:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>LOCALBASE=              /usr/pkg
PKG_SYSCONFBASE=        /usr/pkg/etc
VARBASE=                /var
PKG_DBDIR=              /usr/pkg/pkgdb</pre>
</div>
</div>
<div class="paragraph">
<p>In unprivileged mode (when pkgsrc has been installed as any other user), the default locations are:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>LOCALBASE=              ${HOME}/pkg
PKG_SYSCONFBASE=        ${HOME}/pkg/etc
VARBASE=                ${HOME}/pkg/var
PKG_DBDIR=              ${HOME}/pkg/pkgdb</pre>
</div>
</div>
<div class="paragraph">
<p>What these four directories are for, and what they look like is explained below.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>LOCALBASE</code> corresponds to the <code>/usr</code> directory in the base system. It is the “main” directory where the files are installed and contains the well-known subdirectories like <code>bin</code>, <code>include</code>, <code>lib</code>,
<code>share</code> and <code>sbin</code>.</p>
</li>
<li>
<p><code>VARBASE</code> corresponds to <code>/var</code> in the base system. Some programs (especially games, network daemons) need write access to it during normal
operation.</p>
</li>
<li>
<p><code>PKG_SYSCONFDIR</code> corresponds to <code>/etc</code> in the base system. It contains configuration files of the packages, as well as pkgsrc&#8217;s <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>
itself.</p>
</li>
</ul>
</div>
<div class="sect1">
<h2 id="_9_1_file_system_layout_in_localbase">9.1. File system layout in ${LOCALBASE}</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following directories exist in a typical pkgsrc installation in <code>${LOCALBASE}</code>.</p>
</div>
<div class="paragraph">
<p><code>bin</code> Contains executable programs that are intended to be directly used by the end user.</p>
</div>
<div class="paragraph">
<p><code>emul</code> Contains files for the emulation layers of various other operating systems, especially for NetBSD.</p>
</div>
<div class="paragraph">
<p><code>etc</code> (the usual location of <code>${PKG_SYSCONFDIR}</code>) Contains the configuration files.</p>
</div>
<div class="paragraph">
<p><code>include</code> Contains headers for the C and C++ programming languages.</p>
</div>
<div class="paragraph">
<p><code>info</code> Contains GNU info files of various packages.</p>
</div>
<div class="paragraph">
<p><code>lib</code> Contains shared and static libraries.</p>
</div>
<div class="paragraph">
<p><code>libdata</code> Contains data files that don&#8217;t change after installation. Other data files belong into <code>${VARBASE}</code>.</p>
</div>
<div class="paragraph">
<p><code>libexec</code> Contains programs that are not intended to be used by end users, such as helper programs or network daemons.</p>
</div>
<div class="paragraph">
<p><code>libexec/cgi-bin</code> Contains programs that are intended to be executed as
CGI scripts by a web server.</p>
</div>
<div class="paragraph">
<p><code>man</code> (the usual value of <code>${PKGMANDIR}</code>) Contains brief documentation in form of manual pages.</p>
</div>
<div class="paragraph">
<p><code>sbin</code> Contains programs that are intended to be used only by the super-user.</p>
</div>
<div class="paragraph">
<p><code>share</code> Contains platform-independent data files that don' change after installation.</p>
</div>
<div class="paragraph">
<p><code>share/doc</code> Contains documentation files provided by the packages.</p>
</div>
<div class="paragraph">
<p><code>share/examples</code> Contains example files provided by the packages. Among others, the original configuration files are saved here and copied to <code>${PKG_SYSCONFDIR}</code> during installation.</p>
</div>
<div class="paragraph">
<p><code>share/examples/rc.d</code> Contains the original files for rc.d scripts.</p>
</div>
<div class="paragraph">
<p><code>var</code> (the usual location of <code>${VARBASE}</code>) Contains files that may be modified after installation.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_9_2_file_system_layout_in_varbase">9.2. File system layout in ${VARBASE}</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>db/pkg</code> (the usual location of <code>${PKG_DBDIR}</code>) Contains information about the currently installed packages.</p>
</div>
<div class="paragraph">
<p><code>games</code> Contains highscore files.</p>
</div>
<div class="paragraph">
<p><code>log</code> Contains log files.</p>
</div>
<div class="paragraph">
<p><code>run</code> Contains informational files about daemons that are currently running.</p>
</div>
</div>
</div>
<h1 id="_chapter_10_frequently_asked_questions" class="sect0">Chapter 10. Frequently Asked Questions</h1>
<div class="paragraph">
<p>This section contains hints, tips &amp; tricks on special things in pkgsrc that we didn&#8217;t find a better place for in the previous chapters, and it contains items for both pkgsrc users and developers.</p>
</div>
<div class="sect1">
<h2 id="_10_1_are_there_any_mailing_lists_for_pkg_related_discussion">10.1. Are there any mailing lists for pkg-related discussion?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following mailing lists may be of interest to pkgsrc users:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="http://www.NetBSD.org/mailinglists/index.html#pkgsrc-users">pkgsrc-users</a>: This is a general purpose list for most issues regarding pkgsrc, regardless of platform, e.g. soliciting user help for pkgsrc configuration, unexpected build failures, using particular packages, upgrading pkgsrc installations, questions regarding the pkgsrc release branches, etc.  General announcements or proposals for changes that impact the pkgsrc user community, e.g. major infrastructure changes, new features, package removals, etc., may also be posted.</p>
</li>
<li>
<p><a href="https://www.NetBSD.org/mailinglists/index.html#pkgsrc-bulk">pkgsrc-bulk</a>: A list where the results of pkgsrc bulk builds are sent and discussed.</p>
</li>
<li>
<p><a href="https://www.NetBSD.org/mailinglists/index.html#pkgsrc-changes">pkgsrc-changes</a>: This list is for those who are interested in getting a commit message for every change committed to pkgsrc. It is also available in digest form, meaning one daily message containing all commit messages for changes to the package source tree in that 24 hour period.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To subscribe, do:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% echo subscribe listname | mail majordomo@NetBSD.org</pre>
</div>
</div>
<div class="paragraph">
<p>Archives for all these mailing lists are available from <a href="https://mail-index.NetBSD.org/">https://mail-index.NetBSD.org/</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_2_utilities_for_package_management_pkgtools">10.2. Utilities for package management (pkgtools)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The directory <code>pkgsrc/pkgtools</code> contains a number of useful utilities for both users and developers of pkgsrc. This section attempts only to make the reader aware of some of the utilities and when they might be useful, and not to duplicate the documentation that comes with each package.</p>
</div>
<div class="paragraph">
<p>Utilities used by pkgsrc (automatically installed when needed):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/x11-links/index.html"><code>pkgtools/x11-links</code></a>: Symlinks for use by buildlink.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>OS tool augmentation (automatically installed when needed):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/digest/index.html"><code>pkgtools/digest</code></a>: Calculates various kinds of checksums (including SHA3).</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/libnbcompat/index.html"><code>pkgtools/libnbcompat</code></a>: Compatibility library for pkgsrc tools.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/mtree/index.html"><code>pkgtools/mtree</code></a>: Installed on non-BSD systems due to lack of native mtree.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkg_install/index.html"><code>pkgtools/pkg_install</code></a>: Up-to-date replacement for <code>/usr/sbin/pkg_install</code>, or for use on operating systems where pkg_install is not present.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Utilities used by pkgsrc (not automatically installed):</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkg_tarup/index.html"><code>pkgtools/pkg_tarup</code></a>: Create a binary package from an already-installed package.  Used by <strong>make replace</strong> to save the old package.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/dfdisk/index.html"><code>pkgtools/dfdisk</code></a>: Adds extra functionality to pkgsrc, allowing it to fetch distfiles from multiple locations. It currently supports the following methods: multiple CD-ROMs and network FTP/HTTP connections.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/devel/cpuflags/index.html"><code>devel/cpuflags</code></a>: Determine the best compiler flags to optimise code for your current CPU and compiler.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Utilities for keeping track of installed packages, being up to date,
etc:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkgin/index.html"><code>pkgtools/pkgin</code></a>: A package update tool similar to apt(1). Download, install, and upgrade binary packages easily.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkg_chk/index.html"><code>pkgtools/pkg_chk</code></a>: Reports on packages whose installed versions do not match the latest pkgsrc entries.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkgdep/index.html"><code>pkgtools/pkgdep</code></a>: Makes dependency graphs of packages, to aid in choosing a strategy for updating.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkgdepgraph/index.html"><code>pkgtools/pkgdepgraph</code></a>: Makes graphs from the output of <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkgdep/index.html"><code>pkgtools/pkgdep</code></a> (uses graphviz).</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkglint/index.html"><code>pkgtools/pkglint</code></a>: The pkglint(1) program checks a pkgsrc entry for errors.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/lintpkgsrc/index.html"><code>pkgtools/lintpkgsrc</code></a>: The lintpkgsrc(1) program does various checks on the complete pkgsrc system.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkgsurvey/index.html"><code>pkgtools/pkgsurvey</code></a>: Report what packages you have installed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Utilities for people maintaining or creating individual packages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkgdiff/index.html"><code>pkgtools/pkgdiff</code></a>: Automate making and maintaining patches for a package (includes pkgdiff, pkgvi, mkpatches, etc.).</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/url2pkg/index.html"><code>pkgtools/url2pkg</code></a>: Aids in converting to pkgsrc.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Utilities for people maintaining pkgsrc (or: more obscure pkg
utilities)</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkg_comp/index.html"><code>pkgtools/pkg_comp</code></a>: Build packages in a chrooted area.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/libkver/index.html"><code>pkgtools/libkver</code></a>: Spoof kernel version for chrooted cross builds.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_3_how_to_use_pkgsrc_as_non_root">10.3. How to use pkgsrc as non-root</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To install packages from source as a non-root user, download pkgsrc as described in <a href="https://www.netbsd.org/docs/pkgsrc/getting.html">Chapter 3, Where to get pkgsrc and how to keep it up-to-date</a>, cd into that directory and run the command <strong>./bootstrap/bootstrap --unprivileged</strong>.</p>
</div>
<div class="paragraph">
<p>This will install the binary part of pkgsrc to <code>~/pkg</code> and put the pkgsrc configuration <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>
into <code>~/pkg/etc</code>.</p>
</div>
<div class="paragraph">
<p>For more details, see <code>mk/unprivileged.mk</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_4_how_to_resume_transfers_when_fetching_distfiles">10.4. How to resume transfers when fetching distfiles?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>By default, resuming transfers in pkgsrc is disabled, but you can enable this feature by adding the option <code>PKG_RESUME_TRANSFERS=YES</code> into <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>. If, during a fetch step, an incomplete distfile is found, pkgsrc will try to resume it.</p>
</div>
<div class="paragraph">
<p>You can also use a different program than the platform default program by changing the <code>FETCH_USING</code> variable. You can specify the program by using of ftp, fetch, wget or curl. Alternatively, fetching can be disabled by using the value manual. A value of custom disables the system defaults and dependency tracking for the fetch program.  In that case you have to provide <code>FETCH_CMD</code>, <code>FETCH_BEFORE_ARGS</code>, <code>FETCH_RESUME_ARGS</code>, <code>FETCH_OUTPUT_ARGS</code>, <code>FETCH_AFTER_ARGS</code>.</p>
</div>
<div class="paragraph">
<p>For example, if you want to use <code>wget</code> to download, you&#8217;ll have to use something like:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>FETCH_USING=    wget</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_5_how_can_i_installuse_modular_x_org_from_pkgsrc">10.5. How can I install/use modular X.org from pkgsrc?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you want to use modular X.org from pkgsrc instead of your system&#8217;s own X11 (<code>/usr/X11R6</code>, <code>/usr/openwin</code>, &#8230;&#8203;) you will have to add the following line into <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>X11_TYPE=modular</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_6_how_to_fetch_files_from_behind_a_firewall">10.6. How to fetch files from behind a firewall</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you are sitting behind a firewall which does not allow direct connections to Internet hosts (i.e. non-NAT), you may specify the relevant proxy hosts. This is done using an environment variable in the form of a URL, e.g. in Amdahl, the machine “orpheus.amdahl.com” is one of the firewalls, and it uses port 80 as the proxy port number. So the proxy environment variables are:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ftp_proxy=ftp://orpheus.amdahl.com:80/
http_proxy=http://orpheus.amdahl.com:80/</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_7_how_to_fetch_files_from_https_sites">10.7. How to fetch files from HTTPS sites</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some fetch tools are not prepared to support HTTPS by default (for example, the one in NetBSD 6.0), or the one installed by the pkgsrc bootstrap (to avoid an openssl dependency that low in the dependency graph).</p>
</div>
<div class="paragraph">
<p>Usually you won&#8217;t notice, because distribution files are mirrored weekly to “ftp.NetBSD.org”, but that might not be often enough if you are following pkgsrc-current. In that case, set <code>FETCH_USING</code> in your <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> file to “curl” or “wget”, which are both compiled with HTTPS support by default. Of course, these tools need to be installed before you can use them this way.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_8_how_do_i_tell_make_fetch_to_do_passive_ftp">10.8. How do I tell make fetch to do passive FTP?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This depends on which utility is used to retrieve distfiles. From <code>bsd.pkg.mk</code>, <code>FETCH_CMD</code> is assigned the first available command from the following list:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>${LOCALBASE}/bin/ftp</code></p>
</li>
<li>
<p><code>/usr/bin/ftp</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>On a default NetBSD installation, this will be <code>/usr/bin/ftp</code>, which automatically tries passive connections first, and falls back to active connections if the server refuses to do passive. For the other tools, add the following to your <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> file: <code>PASSIVE_FETCH=1</code>.</p>
</div>
<div class="paragraph">
<p>Having that option present will prevent <code>/usr/bin/ftp</code> from falling back to active transfers.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_9_how_to_fetch_all_distfiles_at_once">10.9. How to fetch all distfiles at once</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You would like to download all the distfiles in a single batch from work or university, where you can&#8217;t run a <strong>make fetch</strong>. There is an archive of distfiles on <a href="ftp://ftp.NetBSD.org/pub/pkgsrc/distfiles/">ftp.NetBSD.org</a>, but downloading the entire directory may not be appropriate.</p>
</div>
<div class="paragraph">
<p>The answer here is to do a <strong>make fetch-list</strong> in <code>/usr/pkgsrc</code> or one of its subdirectories, carry the resulting list to your machine at work/school and use it there.  If you don&#8217;t have a NetBSD-compatible <a href="https://man.NetBSD.org/NetBSD-9.2/i386/ftp.1">ftp(1)</a> (like tnftp) at work, don&#8217;t forget to set <code>FETCH_CMD</code> to something that fetches a URL:</p>
</div>
<div class="paragraph">
<p>At home:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% cd /usr/pkgsrc
% make fetch-list FETCH_CMD=wget DISTDIR=/tmp/distfiles &gt;/tmp/fetch.sh
% scp /tmp/fetch.sh work:/tmp</pre>
</div>
</div>
<div class="paragraph">
<p>At work:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% sh /tmp/fetch.sh</pre>
</div>
</div>
<div class="paragraph">
<p>then tar up <code>/tmp/distfiles</code> and take it home.</p>
</div>
<div class="paragraph">
<p>If you have a machine running NetBSD, and you want to get <em>all</em> distfiles (even ones that aren&#8217;t for your machine architecture), you can do so by using the above-mentioned <strong>make fetch-list</strong> approach, or fetch the distfiles directly by running:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% make mirror-distfiles</pre>
</div>
</div>
<div class="paragraph">
<p>If you even decide to ignore <code>NO_{SRC,BIN}_ON_{FTP,CDROM}</code>, then you can get everything by running:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% make fetch NO_SKIP=yes</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_10_what_does_dont_know_how_to_make_usrsharetmactmac_andoc_mean">10.10. What does “Don&#8217;t know how to make /usr/share/tmac/tmac.andoc” mean?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When compiling the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkg_install/index.html"><code>pkgtools/pkg_install</code></a> package, you get the error from make that it doesn&#8217;t know how to make <code>/usr/share/tmac/tmac.andoc</code>? This indicates that you don&#8217;t have installed the “text” set (nroff, &#8230;&#8203;) from the NetBSD base distribution on your machine.  It is recommended to do that to format man pages.</p>
</div>
<div class="paragraph">
<p>In the case of the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkg_install/index.html"><code>pkgtools/pkg_install</code></a> package, you can get away with setting <code>NOMAN=YES</code> either in the environment or in <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_11_what_does_could_not_find_bsd_own_mk_mean">10.11. What does “Could not find bsd.own.mk” mean?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You didn&#8217;t install the compiler set, <code>comp.tgz</code>, when you installed your NetBSD machine.  Please get and install it, by extracting it in <code>/</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># cd /
# tar --unlink -zxvpf .../comp.tgz</pre>
</div>
</div>
<div class="paragraph">
<p><code>comp.tgz</code> is part of every NetBSD release. Get the one that corresponds to your release (determine via <strong>uname -r</strong>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_12_using_sudo_or_priv_with_pkgsrc">10.12. Using 'sudo' or 'priv' with pkgsrc</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When installing packages as non-root user and using the just-in-time <a href="https://man.NetBSD.org/NetBSD-9.2/i386/su.1">su(1)</a> feature of pkgsrc, it can become annoying to type in the root password for each required package installed.  To avoid this, the sudo package can be used, which does password caching over a limited time. To use it, install <strong>sudo</strong> or
<strong>priv</strong> (either as binary package, from <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/security/priv/index.html"><code>security/priv</code></a>, or <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/security/sudo/index.html"><code>security/sudo</code></a>) and then put the following into your <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>, somewhere <em>after</em> the definition of the <code>LOCALBASE</code> variable:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.if exists(${LOCALBASE}/bin/sudo)
SU_CMD=        ${LOCALBASE}/bin/sudo /bin/sh -c
.endif</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_13_how_do_i_change_the_location_of_configuration_files">10.13. How do I change the location of configuration files?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As the system administrator, you can choose where configuration files are installed.  The default settings make all these files go into <code>${PREFIX}/etc</code> or some of its subdirectories; this may be suboptimal depending on your expectations (e.g., a read-only, NFS-exported <code>PREFIX</code> with a need of per-machine configuration of the provided packages).</p>
</div>
<div class="paragraph">
<p>In order to change the defaults, you can modify the <code>PKG_SYSCONFBASE</code> variable (in <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>) to point to your preferred configuration directory; some common examples include <code>/etc</code> or <code>/etc/pkg</code>.</p>
</div>
<div class="paragraph">
<p>Furthermore, you can change this value on a per-package basis by setting the <code>PKG_SYSCONFDIR.${PKG_SYSCONFVAR}</code> variable. <code>PKG_SYSCONFVAR</code>'s value usually matches the name of the package you would like to modify, that is, the contents of <code>PKGBASE</code>.</p>
</div>
<div class="paragraph">
<p>Note that after changing these settings, you must rebuild and reinstall any affected packages.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_14_automated_security_checks">10.14. Automated security checks</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please be aware that there can often be bugs in third-party software, and some of these bugs can leave a machine vulnerable to exploitation by attackers.  In an effort to lessen the exposure, the NetBSD packages team
maintains a database of known-exploits to packages which have at one time
been included in pkgsrc. The database can be downloaded automatically, and a security audit of all packages installed on a system can take place. To do this, refer to the following two tools (installed as part of the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkg_install/index.html"><code>pkgtools/pkg_install</code></a> package):</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>pkg_admin fetch-pkg-vulnerabilities</strong>, an easy way to download a list of the security vulnerabilities information. This list is kept up to date by the pkgsrc security team, and is distributed from the NetBSD ftp server:</p>
</li>
</ol>
</div>
<div class="paragraph">
<p><a href="https://ftp.NetBSD.org/pub/NetBSD/packages/vulns/pkg-vulnerabilities">https://ftp.NetBSD.org/pub/NetBSD/packages/vulns/pkg-vulnerabilities</a></p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><strong>pkg_admin audit</strong>, an easy way to audit the current machine, checking each known vulnerability. If a vulnerable package is installed, it will be shown by output to stdout, including a description of the type of vulnerability, and a URL containing more information.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Use of these tools is strongly recommended! See <a href="https://www.netbsd.org/docs/pkgsrc/using.html#vulnerabilities">Section 5.1.6, “Checking for security vulnerabilities in installed packages”</a> for instructions on how to automate checking and reporting.</p>
</div>
<div class="paragraph">
<p>If this database is installed, pkgsrc builds will use it to perform a security check before building any package.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_15_why_do_some_packages_ignore_my_cflags">10.15. Why do some packages ignore my CFLAGS?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you add your own preferences to the <code>CFLAGS</code> variable in your <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>, these flags are passed in environment variables to the <code>./configure</code> scripts and to <a href="https://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a>. Some package authors ignore the <code>CFLAGS</code> from the environment variable by overriding them in the <code>Makefile</code>s of their package.</p>
</div>
<div class="paragraph">
<p>Currently there is no solution to this problem. If you really need the package to use your <code>CFLAGS</code> you should run <strong>make patch</strong> in the package directory and then inspect any <code>Makefile</code> and	<code>Makefile.in</code> for whether they define <code>CFLAGS</code> explicitly. Usually you can remove these lines. But be aware that some “smart”	programmers write so bad code that it only works for the specific combination of <code>CFLAGS</code> they have chosen.</p>
</div>
<div class="paragraph">
<p>To find out where the CFLAGS are ignored, add the following lines to <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CPPFLAGS+=              -Dpkgsrc___CPPFLAGS
CFLAGS+=                -Dpkgsrc___CFLAGS
CXXFLAGS+=              -Dpkgsrc___CXXFLAGS</pre>
</div>
</div>
<div class="paragraph">
<p>Then run <strong>bmake show-all-configure show-all-build</strong> to see whether the above flags are passed to the actual build commands in general.</p>
</div>
<div class="paragraph">
<p>To find out whether the flags are passed to individual compiler commands, have a look at the file <code>work/.work.log</code>. In most cases, the flags from the original command lines (the lines starting with <code>[*]</code>) are passed unmodified to the actual compiler (the lines starting with <code>&lt;.&gt;</code>). If the flag is missing from the actual compiler command, it must have been removed by the <a href="https://www.netbsd.org/docs/pkgsrc/build.html#build.wrapper">pkgsrc compiler wrappers</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_16_a_package_does_not_build_what_shall_i_do">10.16. A package does not build. What shall I do?</h2>
<div class="sectionbody">
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that your copy of pkgsrc is consistent. A case that occurs often is that people only update pkgsrc in parts, because of performance reasons. Since pkgsrc is one large system, not a collection of many small systems, there are sometimes changes that only work when the whole pkgsrc tree is updated.</p>
</li>
<li>
<p>Make sure that you don&#8217;t have any CVS conflicts. Search for “&lt;&lt;&lt;&lt;&lt;&lt;” or “&gt;&gt;&gt;&gt;&gt;&gt;” in all your pkgsrc files.</p>
</li>
<li>
<p>Make sure that you don&#8217;t have old copies of the packages extracted. Run <strong>make clean clean-depends</strong> to verify this.</p>
</li>
<li>
<p>If you are a package developer who wants to invest some work, have a look at <a href="https://www.netbsd.org/docs/pkgsrc/fixes.html">Chapter 21, Making your package work</a>.</p>
</li>
<li>
<p>If the problem still exists, write a mail to the <code>pkgsrc-users</code> mailing list.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_10_17_what_does_makefile_appears_to_contain_unresolved_cvsrcs_merge_conflicts_mean">10.17. What does “Makefile appears to contain unresolved cvs/rcs/??? merge conflicts” mean?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You have modified a file from pkgsrc, and someone else has modified that same file afterwards in the CVS repository. Both changes are in the same region of the file, so when you updated pkgsrc, the <code>cvs</code> command marked the conflicting changes in the file. Because of these markers, the file is no longer a valid <code>Makefile</code>.</p>
</div>
<div class="paragraph">
<p>Have a look at that file, and if you don&#8217;t need your local changes anymore, you can remove that file and run <strong>cvs -q update -dP</strong> in that directory to download the current version.</p>
</div>
</div>
</div>
<h1 id="_chapter_11_getting_help" class="sect0">Chapter 11. Getting help</h1>
<div class="paragraph">
<p>To get help when developing pkgsrc, the definitive source is this document, the pkgsrc guide. If you don&#8217;t find anything here, there are alternatives:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The built-in pkgsrc help, which is available after bootstrapping pkgsrc. Run <strong>bmake help topic=…</strong> to get help for any topic, such as a variable name like <code>BUILD_DEFS</code>, a make target like <strong>do-build</strong>, a missing C or C++ function like <strong>strcasecmp</strong> or any other topic.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The available help topics are listed in <a href="https://www.netbsd.org/docs/pkgsrc/help-topics.html">Appendix E, Help topics</a>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>To see the value of a single variable, run <strong>bmake show-var VARNAME=<em><code>X</code></em></strong>.</p>
</li>
<li>
<p>To see the values of the most common variables, run <strong>bmake show-all</strong>. These variables are grouped by topic. To see the variables for a single topic, run <strong>bmake show-all-<em>topic</em></strong>, for example <strong>bmake show-all-fetch</strong>.</p>
</li>
<li>
<p>The tech-pkg mailing list, to which <a href="https://www.NetBSD.org/mailinglists/#tech-pkg">you can subscribe</a> and then <a href="mailto:tech-pkg@NetBSD.org">ask your questions</a>.</p>
</li>
<li>
<p>The #pkgsrc IRC channel, which is accessible <a href="https://web.libera.chat/">via a web browser</a> or by using a specialized chat program such as <a href="http://xchat.org/">XChat</a>. Pick any user name and join the channel #pkgsrc.</p>
</li>
</ul>
</div>
<h1 id="_chapter_12_package_components_files_directories_and_contents" class="sect0">Chapter 12. Package components - files, directories and contents</h1>
<div class="paragraph">
<p>Whenever you&#8217;re preparing a package, there are a number of files involved which are described in the following sections.</p>
</div>
<div class="sect1">
<h2 id="_12_1_makefile">12.1. Makefile</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Building, installation and creation of a binary package are all controlled by the package&#8217;s <code>Makefile</code>. The <code>Makefile</code> describes various things about a package, for example from where to get it, how to configure, build, and install it.</p>
</div>
<div class="paragraph">
<p>A package <code>Makefile</code> contains several sections that describe the package.</p>
</div>
<div class="paragraph">
<p>In the first section there are the following variables, which should appear exactly in the order given here. The order and grouping of the variables is mostly historical and has no further meaning.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>DISTNAME</code> is the basename of the distribution file to be downloaded from the package&#8217;s website.</p>
</li>
<li>
<p><code>PKGNAME</code> is the name of the package, as used by pkgsrc. You need to provide it if <code>DISTNAME</code> (which is the default) is not a good name for the package in pkgsrc or <code>DISTNAME</code> is not provided (no distribution file is required). Usually it is the pkgsrc directory name together with the version number. It must match the regular expression <code>^[A-Za-z0-9][A-Za-z0-9-_.+]*$</code>, that is, it starts with a letter or digit, and contains only letters, digits, dashes, underscores, dots and plus signs. New packages should have entirely lower-case names, with the exception of some that must follow pre-existing conventions (e.g. R packages begin with <code>R-</code>). You can use the <code>:tl</code> variable modifier to lower-case the package name.</p>
</li>
<li>
<p><code>CATEGORIES</code> is a list of categories which the package fits in. You can choose any of the top-level directories of pkgsrc for it.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Currently the following values are available for <code>CATEGORIES</code>. If more than one is used, they need to be separated by spaces:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>archivers     cross         geography     meta-pkgs     security
audio         databases     graphics      misc          shells
benchmarks    devel         ham           multimedia    sysutils
biology       editors       inputmethod   net           textproc
cad           emulators     lang          news          time
chat          finance       mail          parallel      wm
comms         fonts         math          pkgtools      www
converters    games         mbone         print         x11</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p><code>MASTER_SITES</code>, <code>DYNAMIC_MASTER_SITES</code>, <code>DIST_SUBDIR</code>, <code>EXTRACT_SUFX</code>and <code>DISTFILES</code> are discussed in detail in <a href="https://www.netbsd.org/docs/pkgsrc/build.html#build.fetch">Section 13.5, “The <em>fetch</em> phase”</a>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The second section contains information about separately downloaded patches, if any.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PATCHFILES</code>: Name(s) of additional files that contain distribution patches. There is no default. pkgsrc will look for them at <code>PATCH_SITES</code>. They will automatically be uncompressed before patching if the names end with <code>.gz</code> or <code>.Z</code>.</p>
</li>
<li>
<p><code>PATCH_SITES</code>: Primary location(s) for distribution patch files (see <code>PATCHFILES</code> above) if not found locally.</p>
</li>
<li>
<p><code>PATCH_DIST_STRIP</code>: an argument to <a href="https://man.NetBSD.org/NetBSD-9.2/i386/patch.1">patch(1)</a> that sets the pathname strip count to help find the correct files to patch. It defaults to <strong>-p0</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The third section contains the following variables.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>MAINTAINER</code> is the email address of the person who feels responsible for this package, and who is most likely to look at problems or questions regarding this package which have been reported with <a href="https://man.NetBSD.org/NetBSD-9.2/i386/send-pr.1">send-pr(1)</a>. Other developers may contact the <code>MAINTAINER</code>before making changes to the package, but are not required to do so. When packaging a new program, set <code>MAINTAINER</code> to yourself. If you really can&#8217;t maintain the package for future updates, set it to <code>&lt;<a href="mailto:pkgsrc-users@NetBSD.org">pkgsrc-users@NetBSD.org</a>&gt;</code>.</p>
</li>
<li>
<p><code>OWNER</code> should be used instead of <code>MAINTAINER</code> when you do not want other developers to update or change the package without contacting you first. A package Makefile should contain one of <code>MAINTAINER</code> or <code>OWNER</code>, but not both.</p>
</li>
<li>
<p><code>HOMEPAGE</code> is a URL where users can find more information about the package.</p>
</li>
<li>
<p><code>COMMENT</code> is a one-line description of the package (should not include the package name).</p>
</li>
<li>
<p><code>LICENSE</code> indicates the license(s) applicable for the package. See <a href="https://www.netbsd.org/docs/pkgsrc/fixes.html#handling-licenses">Section 21.1.3, “Handling licenses”</a> for further details.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Other variables that affect the build:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>WRKSRC</code>: The directory where the interesting distribution files of the package are found. The default is <code>${WRKDIR}/${DISTNAME}</code>, which works for most packages.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If a package doesn&#8217;t create a subdirectory for itself (most GNU software does, for instance), but extracts itself in the current directory, you should set <code>WRKSRC=${WRKDIR}</code>.</p>
</div>
<div class="paragraph">
<p>If a package doesn&#8217;t create a subdirectory with the name of <code>DISTNAME</code> but some different name, set <code>WRKSRC</code> to point to the proper name in <code>${WRKDIR}</code>, for example <code>WRKSRC=${WRKDIR}/${DISTNAME}/unix</code>. See <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/lang/tcl/index.html"><code>lang/tcl</code></a> and <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/x11/tk/index.html"><code>x11/tk</code></a> for other examples.</p>
</div>
<div class="paragraph">
<p>The name of the working directory created by pkgsrc is taken from the <code>WRKDIR_BASENAME</code> variable. By default, its value is <code>work</code>. If you want to use the same pkgsrc tree for building different kinds of binary packages, you can change the variable according to your needs. Two other variables handle common cases of setting <code>WRKDIR_BASENAME</code> individually. If <code>OBJHOSTNAME</code> is defined in <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>, the first component of the host&#8217;s name is attached to the directory name. If <code>OBJMACHINE</code> is defined, the platform name is attached, which might look like <code>work.i386</code> or <code>work.sparc</code>.</p>
</div>
<div class="paragraph">
<p>Please pay attention to the following gotchas:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Add <code>MANCOMPRESSED</code> if man pages are installed in compressed form by the package. For packages using BSD-style makefiles which honor MANZ, there is <code>MANCOMPRESSED_IF_MANZ</code>.</p>
</li>
<li>
<p>Replace <code>/usr/local</code> with “${PREFIX}” in all files (see patches, below).</p>
</li>
<li>
<p>If the package installs any info files, see <a href="https://www.netbsd.org/docs/pkgsrc/fixes.html#faq.info-files">Section 21.6.7, “Packages installing info files”</a>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_12_2_distinfo">12.2. distinfo</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>distinfo</code> file contains the message digest, or checksum, of each distfile needed for the package. This ensures that the distfiles retrieved from the Internet have not been corrupted during transfer or altered by a malign force to introduce a security hole. To provide maximum security, all distfiles are protected using three different message digest algorithms (SHA1,RMD160, SHA512), as well as the file size.</p>
</div>
<div class="paragraph">
<p>The <code>distinfo</code> file also contains the checksums for all the patches found in the <code>patches</code> directory (see <a href="https://www.netbsd.org/docs/pkgsrc/components.html#components.patches">Section 12.3, “<code>patches/*</code>”</a>). These checksums ensure that patches are only applied intentionally and that they don&#8217;t accidentally change, e.g. when merging different changes together. They also make sure that new patches are actually added to CVS and old ones are removed. Too see whether the patches and the <code>distinfo</code> file match, run <strong>pkglint</strong> after changing the patches.</p>
</div>
<div class="paragraph">
<p>To regenerate the <code>distinfo</code> file, use the <strong>make distinfo</strong> command.</p>
</div>
<div class="paragraph">
<p>Some packages have different sets of distfiles depending on the platform, for example <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/lang/openjdk8/index.html"><code>lang/openjdk8</code></a>. These are kept in the same <code>distinfo</code> file and care should be taken when upgrading such a package to ensure distfile information is not lost.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_12_3_patches">12.3. patches/*</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some packages don&#8217;t work out-of-the box on the various platforms that are supported by pkgsrc. These packages need to be patched to make them work. The patch files can be found in the <code>patches/</code> directory.</p>
</div>
<div class="paragraph">
<p>In the <em>patch</em> phase, these patches are applied to the files in <code>WRKSRC</code> directory after extracting them, in alphabetic order.</p>
</div>
<div class="sect2">
<h3 id="_12_3_1_structure_of_a_single_patch_file">12.3.1. Structure of a single patch file</h3>
<div class="paragraph">
<p>The <code>patch-*</code> files should be in <strong>diff -bu</strong> format, and apply without a fuzz to avoid problems. (To force patches to apply with fuzz you can set <code>PATCH_FUZZ_FACTOR=-F2</code>). Furthermore, each patch should contain only changes for a single file, and no file should be patched by more than one patch file. This helps to keep future modifications simple.</p>
</div>
<div class="paragraph">
<p>Each patch file is structured as follows: In the first line, there is the RCS Id of the patch itself. The second line should be empty for aesthetic reasons. After that, there should be a comment for each change that the patch does. There are a number of standard cases:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Patches for commonly known vulnerabilities should mention the vulnerability ID (CAN, CVE).</p>
</li>
<li>
<p>Patches that change source code should mention the platform and other environment (for example, the compiler) that the patch is needed for.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The patch should be commented so that any developer who knows the code of the application can make some use of the patch. Special care should be taken for the upstream developers, since we generally want that they accept our patches, so we have less work in the future.</p>
</div>
</div>
<div class="sect2">
<h3 id="_12_3_2_creating_patch_files">12.3.2. Creating patch files</h3>
<div class="paragraph">
<p>One important thing to mention is to pay attention that no RCS IDs get stored in the patch files, as these will cause problems when later checked into the NetBSD CVS tree. Use the <strong>pkgdiff</strong> command from the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkgdiff/index.html"><code>pkgtools/pkgdiff</code></a> package to avoid these problems.</p>
</div>
<div class="paragraph">
<p>For even more automation, we recommend using <strong>mkpatches</strong> from the same package to make a whole set of patches. You just have to back up files before you edit them to <code>filename.orig</code>, e.g., with <strong>cp -p filename filename.orig</strong> or, easier, by using <strong>pkgvi</strong> again from the same package. If you upgrade a package this way, you can easily compare the new set of patches with the previously existing one with <strong>patchdiff</strong>. The files in <code>patches</code> are replaced by new files, so carefully check if you want to take all the changes.</p>
</div>
<div class="paragraph">
<p>When you have finished a package, remember to generate the checksums for the patch files by using the <strong>make makepatchsum</strong> command, see <a href="https://www.netbsd.org/docs/pkgsrc/components.html#components.distinfo">Section 12.2, “<code>distinfo</code>”</a>.</p>
</div>
<div class="paragraph">
<p>When adding a patch that corrects a problem in the  distfile (rather than e.g. enforcing pkgsrc&#8217;s view of where man pages should go), send the patch as a bug report to the maintainer. This benefits non-pkgsrc users of the package, and usually makes it possible to remove the patch in future version.</p>
</div>
<div class="paragraph">
<p>The file names of the patch files are usually of the form <code>patch-<em>path_to_file</em>with<em>underscores.c</code></em>. Many packages still use the previous convention <code>patch-<em>[a-z][a-z]</code></em>, but new patches should be of the form containing the filename. <strong>mkpatches</strong> included in <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkgdiff/index.html"><code>pkgtools/pkgdiff</code></a> takes care of the name automatically.</p>
</div>
<div class="paragraph">
<p>When updating pre-existing patch files, if a file uses the old <code>patch-<em>[a-z][a-z]</code></em> convention, it&#8217;s best not to change it to the new form, as that will just cause churn that makes it harder to track changes to patching over time. Similarly, if a patch now applies at different line offsets, but still applies cleanly as-is, there&#8217;s no need to update it, as that also unnecessarily complicates the patch history.</p>
</div>
</div>
<div class="sect2">
<h3 id="_12_3_3_sources_where_the_patch_files_come_from">12.3.3. Sources where the patch files come from</h3>
<div class="paragraph">
<p>If you want to share patches between multiple packages in pkgsrc, e.g. because they use the same distfiles, set <code>PATCHDIR</code> to the path where the patch files can be found, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PATCHDIR=       ../../editors/xemacs/patches</pre>
</div>
</div>
<div class="paragraph">
<p>Patch files that are distributed by the author or other maintainers can be listed in <code>PATCHFILES</code>.</p>
</div>
<div class="paragraph">
<p>If it is desired to store any patches that should not be committed into pkgsrc, they can be kept outside the pkgsrc tree in the <code>$LOCALPATCHES</code> directory. The directory tree there is expected to have the same “category/package” structure as pkgsrc, and patches are expected to be stored inside these dirs (also known as <code>$LOCALPATCHES/$PKGPATH</code>). For example, if you want to keep a private patch for <code>pkgsrc/graphics/png</code>, keep it in <code>$LOCALPATCHES/graphics/png/mypatch</code>. All files in the named directory are expected to be patch files, and <em>they are applied after pkgsrc patches are applied</em>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_12_3_4_patching_guidelines">12.3.4. Patching guidelines</h3>
<div class="paragraph">
<p>When fixing a portability issue in the code do not use preprocessor magic to check for the current operating system nor platform. Doing so hurts portability to other platforms because the OS-specific details are not abstracted appropriately.</p>
</div>
<div class="paragraph">
<p>The general rule to follow is: instead of checking for the operating system the application is being built on, check for the specific <em>features</em> you need. For example, instead of assuming that kqueue is available under NetBSD and using the <code><em>NetBSD</em></code> macro to conditionalize kqueue support, add a check that detects kqueue itself&#8201;&#8212;&#8201;yes, this generally involves patching the <strong>configure</strong> script. There is absolutely nothing that prevents some OSes from adopting interfaces from other OSes (e.g. Linux implementing kqueue), something that the above checks cannot take into account.</p>
</div>
<div class="paragraph">
<p>Of course, checking for features generally involves more work on the developer&#8217;s side, but the resulting changes are cleaner and there are chances they will work on many other platforms. Not to mention that there are higher chances of being later integrated into the mainstream sources. Remember: <em>It doesn&#8217;t work unless it is right!</em></p>
</div>
<div class="paragraph">
<p>Some typical examples:</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Patching examples</caption>
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Where</th>
<th class="tableblock halign-left valign-top">Incorrect</th>
<th class="tableblock halign-left valign-top">Correct</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configure script</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">case ${target_os} in netbsd*) have_kvm=yes ;; *) have_kvm=no;; esac</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AC_CHECK_LIB(kvm, kvm_open, have_kvm=yes, have_kvm=no)</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">C source file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#if defined(<em>NetBSD</em>) #  include &lt;sys/event.h&gt; #endif</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">#if defined(HAVE_SYS_EVENT_H) #  include &lt;sys/event.h&gt; #endif</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">C source file</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int monitor_file(&#8230;&#8203;) { #if defined(<em>NetBSD</em>) int fd = kqueue(); &#8230;&#8203; #else &#8230;&#8203; #endif }</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">int monitor_file(&#8230;&#8203;) { #if defined(HAVE_KQUEUE) int fd = kqueue(); &#8230;&#8203; #else &#8230;&#8203; #endif }</p></td>
</tr>
</tbody>
</table>
</div>
<div class="sect2">
<h3 id="_12_3_5_feedback_to_the_author">12.3.5. Feedback to the author</h3>
<div class="paragraph">
<p>Always, always, <strong>always</strong> feed back any <em>portability fixes</em> or improvements you do to a package to the mainstream developers. This is the only way to get their attention on portability issues and to ensure that future versions can be built out-of-the box on NetBSD. Furthermore, any user that gets newer distfiles will get the fixes straight from the packaged code.</p>
</div>
<div class="paragraph">
<p>This generally involves cleaning up the patches (because sometimes the patches that are added to pkgsrc are quick hacks), filing bug reports in the appropriate trackers for the projects and working with the mainstream authors to accept your changes. It is <em>extremely important</em> that you do it so that the packages in pkgsrc are kept simple and thus further changes can be done without much hassle.</p>
</div>
<div class="paragraph">
<p>When you have done this, please add a URL to the upstream bug report to the patch comment.</p>
</div>
<div class="paragraph">
<p>Support the idea of free software!</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_12_4_other_mandatory_files">12.4. Other mandatory files</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>DESCR</code> A multi-line description of the piece of software. This should include any credits where they are due. Please bear in mind that others do not share your sense of humour (or spelling idiosyncrasies), and that others will read everything that you write here.</p>
</div>
<div class="paragraph">
<p><code>PLIST</code> This file governs the files that are installed on your system: all the binaries, manual pages, etc. There are other directives which may be entered in this file, to control the creation and deletion of directories, and the location of inserted files. See <a href="https://www.netbsd.org/docs/pkgsrc/plist.html">Chapter 19, PLIST issues</a> for more information.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_12_5_optional_files">12.5. Optional files</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_12_5_1_files_affecting_the_binary_package">12.5.1. Files affecting the binary package</h3>
<div class="paragraph">
<p><code>INSTALL</code> This shell script is invoked twice by <a href="https://man.NetBSD.org/NetBSD-9.2/i386/pkg_add.1">pkg_add(1)</a>. First time after package extraction and before files are moved in place, the second time after the files to install are moved in place. This can be used to do any custom procedures not possible with @exec commands in <code>PLIST</code>. See <a href="https://man.NetBSD.org/NetBSD-9.2/i386/pkg_add.1">pkg_add(1)</a> and <a href="https://man.NetBSD.org/NetBSD-9.2/i386/pkg_create.1">pkg_create(1)</a> for more information. See also <a href="https://www.netbsd.org/docs/pkgsrc/pkginstall.html#files-and-dirs-outside-prefix">Section 20.1, “Files and directories outside the installation prefix”</a>. Please note that you can modify variables in it easily by using <code>FILES_SUBST</code> in the package&#8217;s <code>Makefile</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>FILES_SUBST+=  SOMEVAR="somevalue"</pre>
</div>
</div>
<div class="paragraph">
<p>replaces "@SOMEVAR@" with “somevalue” in the <code>INSTALL</code>. By default, substitution is performed for <code>PREFIX</code>, <code>LOCALBASE</code>, <code>X11BASE</code>, <code>VARBASE</code>, and a few others, type <strong>make help topic=FILES_SUBST</strong> for a complete list.</p>
</div>
<div class="paragraph">
<p><code>DEINSTALL</code> This script is executed before and after any files are removed. It is this script&#8217;s responsibility to clean up any additional messy details around the package&#8217;s installation, since all pkg_delete knows is how to delete the files created in the original distribution. See <a href="https://man.NetBSD.org/NetBSD-9.2/i386/pkg_delete.1">pkg_delete(1)</a> and <a href="https://man.NetBSD.org/NetBSD-9.2/i386/pkg_create.1">pkg_create(1)</a> for more information. The same methods to replace variables can be used as for the <code>INSTALL</code> file.</p>
</div>
<div class="paragraph">
<p><code>MESSAGE</code> This file is displayed after installation of the package. While this was used often in the past, it has two problems: the display will be missed if many packages are intalled at once, and the person installing the package and the one using or configuring it may be different. It should therefore be used only in exceptional circumstances where lasting negative consequences would result from someone not reading it.</p>
</div>
<div class="paragraph">
<p>MESSAGE should not be used for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>exhortations to read the documentation</p>
</li>
<li>
<p>reminders to install rc.d files and set variables</p>
</li>
<li>
<p>anything that should be explained in the installation/configuration documentation that should come with the package</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>If the documentation provided by upstream needs enhancing, create e.g. files/README.pkgsrc and install it in the package&#8217;s documentation directory.</p>
</div>
<div class="paragraph">
<p>Note that MESSAGE is shown for all operating systems and all init systems. If a MESSAGE is necessary, it should be narrowed to only those operating systems and init systems to which it applies.</p>
</div>
<div class="paragraph">
<p>Note that you can modify variables in it easily by using <code>MESSAGE_SUBST</code> in the package&#8217;s <code>Makefile</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MESSAGE_SUBST+=  SOMEVAR="somevalue"</pre>
</div>
</div>
<div class="paragraph">
<p>replaces "${SOMEVAR}" with “somevalue” in <code>MESSAGE</code>. By default, substitution is performed for <code>PKGNAME</code>, <code>PKGBASE</code>, <code>PREFIX</code>, <code>LOCALBASE</code>, <code>X11BASE</code>, <code>PKG_SYSCONFDIR</code>, <code>ROOT_GROUP</code>, and <code>ROOT_USER</code>.</p>
</div>
<div class="paragraph">
<p>You can display a different or additional files by setting the <code>MESSAGE_SRC</code> variable. Its default is <code>MESSAGE</code>, if the file exists.</p>
</div>
<div class="paragraph">
<p><code>ALTERNATIVES</code> This file is used by the alternatives framework. It creates, configures, and destroys generic wrappers used to run programs with similar interfaces. See pkg_alternatives(8) from pkgtools/pkg_alternatives for more information.</p>
</div>
<div class="paragraph">
<p>Each line of the file contains two filenames, first the wrapper and then the alternative provided by the package. Both paths are relative to <code>PREFIX</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_12_5_2_files_affecting_the_build_process">12.5.2. Files affecting the build process</h3>
<div class="paragraph">
<p><code>Makefile.common</code> This file contains arbitrary things that could also go into a <code>Makefile</code>, but its purpose is to be used by more than one package. This file should only be used when the packages that will use the file are known in advance. For other purposes it is often better to write a  <code>*.mk</code> file and give it a good name that describes what it does.</p>
</div>
<div class="paragraph">
<p><code>buildlink3.mk</code> This file contains the dependency information for the buildlink3 framework (see <a href="https://www.netbsd.org/docs/pkgsrc/buildlink.html">Chapter 18, Buildlink methodology</a>).</p>
</div>
<div class="paragraph">
<p><code>hacks.mk</code> This file contains workarounds for compiler bugs and similar things. It is included automatically by the pkgsrc infrastructure, so you don&#8217;t need an extra <code>.include</code> line for it.</p>
</div>
<div class="paragraph">
<p><code>options.mk</code> This file contains the code for the package-specific options (see <a href="https://www.netbsd.org/docs/pkgsrc/options.html">Chapter 16, Options handling</a>) that can be selected by the user. If a package has only one or two options, it is equally acceptable to put the code directly into the <code>Makefile</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_12_5_3_files_affecting_nothing_at_all">12.5.3. Files affecting nothing at all</h3>
<div class="paragraph">
<p><code>README*</code> These files do not take place in the creation of a package and thus are purely informative to the package developer.</p>
</div>
<div class="paragraph">
<p><code>TODO</code> This file contains things that need to be done	to make the package even better.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_12_6_work">12.6. work*</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When you type <strong>make</strong>, the distribution files are unpacked into the directory denoted by <code>WRKDIR</code>. It can be removed by running <strong>make clean</strong>. Besides the sources, this directory is also used to keep various timestamp files. The directory gets <em>removed completely</em> on clean. The default is <code>${.CURDIR}/work</code> or <code>${.CURDIR}/work.${MACHINE_ARCH}</code> if <code>OBJMACHINE</code> is set.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_12_7_files">12.7. files/*</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If you have any files that you wish to be placed in the package prior to configuration or building, you can place these files here and use a <strong>${CP}</strong> command in the “post-extract” target to achieve this.</p>
</div>
<div class="paragraph">
<p>If you want to share files in this way with other packages, set the <code>FILESDIR</code> variable to point to the other package&#8217;s <code>files</code> directory, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>FILESDIR=       ../../editors/xemacs/files</pre>
</div>
</div>
</div>
</div>
<h1 id="_chapter_13_the_build_process" class="sect0">Chapter 13. The build process</h1>
<div class="sect1">
<h2 id="_13_1_introduction">13.1. Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This chapter gives a detailed description on how a package is built. Building a package is separated into different <em>phases</em> (for example <code>fetch</code>, <code>build</code>, <code>install</code>), all of which are described in the following sections. Each phase is split into so-called <em>stages</em>, which take the name of the containing phase, prefixed by one of <code>pre-</code>, <code>do-</code> or <code>post-</code>. (Examples are <code>pre-configure</code>, <code>post-build</code>.) Most of the actual work is done in the <code>do-*</code> stages.</p>
</div>
<div class="paragraph">
<p>Never override the regular targets (like <code>fetch</code>), if you have to, override the <code>do-*</code> ones instead.</p>
</div>
<div class="paragraph">
<p>The basic steps for building a program are always the same. First the program&#8217;s source (<em>distfile</em>) must be brought to the local system and then extracted. After any pkgsrc-specific patches to compile properly are applied, the software can be configured, then built (usually by compiling), and finally the generated binaries, etc. can be put into place on the system.</p>
</div>
<div class="paragraph">
<p>To get more details about what is happening at each step, you can set the <code>PKG_VERBOSE</code> variable, or the <code>PATCH_DEBUG</code> variable if you are just interested in more details about the <em>patch</em> step.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_2_program_location">13.2. Program location</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Before outlining the process performed by the NetBSD package system in the next section, here&#8217;s a brief discussion on where programs are installed, and which variables influence this.</p>
</div>
<div class="paragraph">
<p>The automatic variable <code>PREFIX</code> indicates where all files of the final program shall be installed. It is usually set to <code>LOCALBASE</code> (<code>/usr/pkg</code>), or <code>CROSSBASE</code> for pkgs in the <code>cross</code> category. The value of <code>PREFIX</code> needs to be put into the various places in the program&#8217;s source where paths to these files are encoded. See <a href="http://netbsd.org/docs/pkgsrc/components.html#components.patches">Section 12.3, “<code>patches/*</code>”</a> and <a href="http://netbsd.org/docs/pkgsrc/fixes.html#fixes.libtool">Section 21.3.1, “Shared libraries - libtool”</a> for more details.</p>
</div>
<div class="paragraph">
<p>When choosing which of these variables to use, follow the following rules:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PREFIX</code> always points to the location where the current pkg will be installed. When referring to a pkg&#8217;s own installation path, use “${PREFIX}”.</p>
</li>
<li>
<p><code>LOCALBASE</code> is where all pkgs are installed. If you need to construct a -I or -L argument	to the compiler to find includes and libraries installed by another pkg, use “${LOCALBASE}”. The name <code>LOCALBASE</code> stems from FreeBSD, which	installed all packages in <code>/usr/local</code>. As pkgsrc leaves <code>/usr/local</code> for the system administrator, this variable is a misnomer.</p>
</li>
<li>
<p><code>X11BASE</code> is where the actual X11 distribution (from xsrc, etc.) is installed. When looking for	<em>standard</em> X11 includes (not those installed by a package), use “${X11BASE}”.</p>
</li>
<li>
<p>X11-based packages using imake must set <code>USE_IMAKE</code> to be installed correctly under <code>LOCALBASE</code>.</p>
</li>
<li>
<p>Within <code>${PREFIX}</code>, packages should install files according to <a href="http://man.NetBSD.org/NetBSD-9.2/i386/hier.7">hier(7)</a>, with the exception that manual pages go into <code>${PREFIX}/man</code>, not <code>${PREFIX}/share/man</code>.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_3_directories_used_during_the_build_process">13.3. Directories used during the build process</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When building a package, various directories are used to store source files, temporary files, pkgsrc-internal files, and so on. These directories are explained here.</p>
</div>
<div class="paragraph">
<p>Some of the directory variables contain relative pathnames. There are two common base directories for these relative directories: <code>PKGSRCDIR/PKGPATH</code> is used for directories that are pkgsrc-specific. <code>WRKSRC</code> is used for directories inside the package itself.</p>
</div>
<div class="paragraph">
<p><code>PKGSRCDIR</code> This is an absolute pathname that points to the pkgsrc root directory. Generally, you don&#8217;t need it.</p>
</div>
<div class="paragraph">
<p><code>PKGDIR</code> This is an absolute pathname that points to the current package.</p>
</div>
<div class="paragraph">
<p><code>PKGPATH</code> This is a pathname relative to <code>PKGSRCDIR</code> that points to the current package.</p>
</div>
<div class="paragraph">
<p><code>WRKDIR</code> This is an absolute pathname pointing to the directory where all work takes place. The distfiles are extracted to this directory. It also contains temporary directories and log files used by the various pkgsrc frameworks, like <em>buildlink</em> or the <em>wrappers</em>.</p>
</div>
<div class="paragraph">
<p><code>WRKSRC</code> This is an absolute pathname pointing to the directory where the distfiles are extracted. It is usually a direct subdirectory of <code>WRKDIR</code>, and often it&#8217;s the only directory entry that isn&#8217;t hidden. This variable may be changed by a package <code>Makefile</code>.</p>
</div>
<div class="paragraph">
<p>The <code>CREATE_WRKDIR_SYMLINK</code> definition takes either the value <em>yes</em> or <em>no</em> and defaults to <em>no</em>. It indicates whether a symbolic link to the <code>WRKDIR</code> is to be created in the pkgsrc entry&#8217;s directory. If users would like to have their pkgsrc trees behave in a read-only manner, then the value of <code>CREATE_WRKDIR_SYMLINK</code> should be set to <em>no</em>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_4_running_a_phase">13.4. Running a phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can run a particular phase by typing <strong>make phase</strong>, where <em>phase</em> is the name of the phase. This will automatically run all phases that are required for this phase. The default phase is <code>build</code>, that is, when you run <strong>make</strong> without parameters in a package directory, the package will be built, but not installed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_5_the_fetch_phase">13.5. The fetch phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The first step in building a package is to fetch the distribution files (distfiles) from the sites that are providing them. This is the task of the <em>fetch</em> phase.</p>
</div>
<div class="sect2">
<h3 id="_13_5_1_what_to_fetch_and_where_to_get_it_from">13.5.1. What to fetch and where to get it from</h3>
<div class="paragraph">
<p>In simple cases, <code>MASTER_SITES</code> defines all URLs from where the distfile, whose name is derived from the <code>DISTNAME</code> variable, is fetched. The more complicated cases are described below.</p>
</div>
<div class="paragraph">
<p>The variable <code>DISTFILES</code> specifies the list of distfiles that have to be fetched. Its value defaults to <code>${DEFAULT_DISTFILES}</code> and its value is <code>${DISTNAME}${EXTRACT_SUFX}</code>, so that most packages don&#8217;t need to define it at all. <code>EXTRACT_SUFX</code> is <code>.tar.gz</code> by default, but can be changed freely. Note that if your package requires additional distfiles to the default one, you cannot just append the additional filenames using the <code>+=</code> operator, but you have write for example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTFILES=      ${DEFAULT_DISTFILES} additional-files.tar.gz</pre>
</div>
</div>
<div class="paragraph">
<p>Each distfile is fetched from a list of sites, usually <code>MASTER_SITES</code>. If the package has multiple <code>DISTFILES</code> or multiple <code>PATCHFILES</code> from different sites, you can set <code>SITES.<em>distfile</code></em> to the list of URLs where the file <code><em>distfile</code></em> (including the suffix) can be found.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTFILES=      ${DISTNAME}${EXTRACT_SUFX}
DISTFILES+=     foo-file.tar.gz
SITES.foo-file.tar.gz= \
https://www.somewhere.com/somehow/ \
https://www.somewhereelse.com/mirror/somehow/</pre>
</div>
</div>
<div class="paragraph">
<p>When actually fetching the distfiles, each item from <code>MASTER_SITES</code> or <code>SITES.*</code> gets the name of each distfile appended to it, without an intermediate slash. Therefore, all site values have to end with a slash or other separator character. This allows for example to set <code>MASTER_SITES</code> to a URL of a CGI script that gets the name of the distfile as a parameter. In this case, the definition would look like:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MASTER_SITES=   https://www.example.com/download.cgi?file=</pre>
</div>
</div>
<div class="paragraph">
<p>The exception to this rule are URLs starting with a dash. In that case the URL is taken as is, fetched and the result stored under the name of the distfile. You can use this style for the case when the download URL style does not match the above common case. For example, if permanent download URL is a redirector to the real download URL, or the download file name is offered by an HTTP Content-Disposition header. In the following example, <code>foo-1.0.0.tar.gz</code> will be created instead of the default <code>v1.0.0.tar.gz</code>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTNAME=       foo-1.0.0
MASTER_SITES=   -https://www.example.com/archive/v1.0.0.tar.gz</pre>
</div>
</div>
<div class="paragraph">
<p>here are some predefined values for <code>MASTER_SITES</code>, which can be used in packages. The names of the variables should speak for themselves.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_APACHE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_BACKUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_CRATESIO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_CYGWIN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_DEBIAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_FREEBSD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_FREEBSD_LOCAL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_GENTOO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_GITHUB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_GNOME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_GNU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_GNUSTEP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_HASKELL_HACKAGE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_IFARCHIVE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_KDE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_MOZILLA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_MOZILLA_ALL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_MYSQL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_NETLIB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_OPENBSD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_OPENOFFICE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_OSDN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_PERL_CPAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_PGSQL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_PYPI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_RUBYGEMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_R_CRAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_SOURCEFORGE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_SUNSITE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_SUSE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_TEX_CTAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_XCONTRIB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_XEMACS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_XORG</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Some explanations for the less self-explaining ones: <code>MASTER_SITE_BACKUP</code> contains backup sites for packages that are maintained in <a href="ftp://ftp.NetBSD.org/pub/pkgsrc/distfiles/%24%7BDIST_SUBDIR%7D">ftp://ftp.NetBSD.org/pub/pkgsrc/distfiles/${DIST_SUBDIR}</a>. <code>MASTER_SITE_LOCAL</code> contains local package source distributions that are maintained in <a href="ftp://ftp.NetBSD.org/pub/pkgsrc/distfiles/LOCAL_PORTS/">ftp://ftp.NetBSD.org/pub/pkgsrc/distfiles/LOCAL_PORTS/</a>.</p>
</div>
<div class="paragraph">
<p>If you choose one of these predefined sites, you may want to specify a subdirectory of that site. Since these macros may expand to more than one actual site, you <em>must</em> use the following construct to specify a subdirectory:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MASTER_SITES=   ${MASTER_SITE_GNU:=subdirectory/name/}
MASTER_SITES=   ${MASTER_SITE_SOURCEFORGE:=project_name/}</pre>
</div>
</div>
<div class="paragraph">
<p>Note the trailing slash after the subdirectory name.</p>
</div>
</div>
<div class="sect2">
<h3 id="_13_5_2_how_are_the_files_fetched">13.5.2. How are the files fetched?</h3>
<div class="paragraph">
<p>The <em>fetch</em> phase makes sure that all the distfiles exist in a local directory (<code>DISTDIR</code>, which can be set by the pkgsrc user). If the files do not exist, they are fetched using commands of the form</p>
</div>
<div class="literalblock">
<div class="content">
<pre>${FETCH_CMD} ${FETCH_BEFORE_ARGS} ${site}${file} ${FETCH_AFTER_ARGS}</pre>
</div>
</div>
<div class="paragraph">
<p>where <code>${site}</code> varies through several possibilities in turn: first, <code>MASTER_SITE_OVERRIDE</code> is tried, then the sites specified in either <code>SITES.file</code> if defined, else <code>MASTER_SITES</code> or <code>PATCH_SITES</code>, as applies, then finally the value of <code>MASTER_SITE_BACKUP</code>. The order of all except the first and the last can be optionally sorted by the user, via setting either <code>MASTER_SORT_RANDOM</code>, and <code>MASTER_SORT_AWK</code> or <code>MASTER_SORT_REGEX</code>.</p>
</div>
<div class="paragraph">
<p>The specific command and arguments used depend on the <code>FETCH_USING</code> parameter. The example above is for <code>FETCH_USING=custom</code>.</p>
</div>
<div class="paragraph">
<p>The distfiles mirror run by the NetBSD Foundation uses the <em>mirror-distfiles</em> target to mirror the distfiles, if they are freely distributable.  Packages setting <code>NO_SRC_ON_FTP</code> (usually to “${RESTRICTED}”) will not have their distfiles mirrored.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_6_the_checksum_phase">13.6. The checksum phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After the distfile(s) are fetched, their checksum is generated and compared with the checksums stored in the distinfo file. If the checksums don&#8217;t match, the build is aborted. This is to ensure the same distfile is used for building, and that the distfile wasn&#8217;t changed, e.g. by some malign force, deliberately changed distfiles on the master distribution site or network lossage.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_7_the_extract_phase">13.7. The extract phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When the distfiles are present on the local system, they need to be extracted, as they usually come in the form of some compressed archive format.</p>
</div>
<div class="paragraph">
<p>By default, all <code>DISTFILES</code> are extracted. If you only need some of them, you can set the <code>EXTRACT_ONLY</code> variable to the list of those files.</p>
</div>
<div class="paragraph">
<p>Extracting the files is usually done by a little program, <code>mk/extract/extract</code>, which already knows how to extract various archive formats, so most likely you will not need to change anything here. But if you need, the following variables may help you:</p>
</div>
<div class="paragraph">
<p><code>EXTRACT_OPTS_{BIN,LHA,PAX,RAR,TAR,ZIP,ZOO}</code> Use these variables to override the default options for an extract command, which are defined in <code>mk/extract/extract</code>.</p>
</div>
<div class="paragraph">
<p><code>EXTRACT_USING</code> This variable can be set to <code>bsdtar</code>, <code>gtar</code>, <code>nbtar</code> (which is the default value), <code>pax</code>, or an absolute pathname pointing to the command with which tar archives should be extracted. It is preferred to choose bsdtar over gtar if NetBSD&#8217;s pax-as-tar is not good enough.</p>
</div>
<div class="paragraph">
<p>If the <code>extract</code> program doesn&#8217;t serve your needs, you can also override the <code>EXTRACT_CMD</code> variable, which holds the command used for extracting the files. This command is executed in the <code>${WRKSRC}</code> directory. During execution of this command, the shell variable <code>extract_file</code> holds the absolute pathname of the file that is going to be extracted.</p>
</div>
<div class="paragraph">
<p>And if that still does not suffice, you can override the <code>do-extract</code> target in the package Makefile.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_8_the_patch_phase">13.8. The patch phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>After extraction, all the patches named by the <code>PATCHFILES</code>, those present in the patches subdirectory of the package as well as in $LOCALPATCHES/$PKGPATH (e.g. <code>/usr/local/patches/graphics/png</code>) are applied. Patchfiles ending in <code>.Z</code> or <code>.gz</code> are uncompressed before they are applied, files ending in <code>.orig</code> or <code>.rej</code> are ignored. Any special options to <a href="http://man.NetBSD.org/NetBSD-9.2/i386/patch.1">patch(1)</a> can be handed in <code>PATCH_DIST_ARGS</code>. See <a href="http://netbsd.org/docs/pkgsrc/components.html#components.patches">Section 12.3, “<code>patches/*</code>”</a> for more details.</p>
</div>
<div class="paragraph">
<p>By default <a href="http://man.NetBSD.org/NetBSD-9.2/i386/patch.1">patch(1)</a> is given special arguments to make it fail if the expected text from the patch context is not found in the patched file. If that happens, fix the patch file by comparing it with the actual text in the file to be patched.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_9_the_tools_phase">13.9. The tools phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is covered in <a href="http://netbsd.org/docs/pkgsrc/tools.html">Chapter 17, Tools needed for building or running</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_10_the_wrapper_phase">13.10. The wrapper phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This phase creates wrapper programs for the compilers and linkers. The following variables can be used to tweak the wrappers.</p>
</div>
<div class="paragraph">
<p><code>ECHO_WRAPPER_MSG</code> The command used to print progress messages. Does nothing by default. Set to <code>${ECHO}</code> to see the progress messages.</p>
</div>
<div class="paragraph">
<p><code>WRAPPER_DEBUG</code> This variable can be set to <code>yes</code> (default) or <code>no</code>, depending on whether you want additional information in the wrapper log file.</p>
</div>
<div class="paragraph">
<p><code>WRAPPER_UPDATE_CACHE</code> This variable can be set to <code>yes</code> or <code>no</code>, depending on whether the wrapper should use its cache, which will improve the speed. The default value is <code>yes</code>, but is forced to <code>no</code> if the platform does not support it.</p>
</div>
<div class="paragraph">
<p><code>WRAPPER_REORDER_CMDS</code> A list of reordering commands. A reordering command has the form <code>reorder:l:<em>lib1</code></em>:<em><code>lib2</code></em> . It ensures that <code>-l<em>lib1</code></em> occurs before <code>-l<em>lib2</code></em>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_11_the_configure_phase">13.11. The configure phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most pieces of software need information on the header files, system calls, and library routines which are available on the platform they run on. The process of determining this information is known as configuration, and is usually automated. In most cases, a script is supplied with the distfiles, and its invocation results in generation of header files, Makefiles, etc.</p>
</div>
<div class="paragraph">
<p>If the package contains a configure script, this can be invoked by setting <code>HAS_CONFIGURE</code> to “yes”. If the configure script is a GNU autoconf script, you should set <code>GNU_CONFIGURE</code> to “yes” instead.</p>
</div>
<div class="paragraph">
<p>In the <code>do-configure</code> stage, a rough equivalent of the following command is run. See <code>mk/configure/configure.mk</code>, target <code>do-configure-script</code> for the exact definition.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.for dir in ${CONFIGURE_DIRS}
    cd ${WRKSRC} &amp;&amp; cd ${dir} \
    &amp;&amp; env ${CONFIGURE_ENV} \
        ${CONFIG_SHELL} ${CONFIGURE_SCRIPT} ${CONFIGURE_ARGS}
.endfor</pre>
</div>
</div>
<div class="paragraph">
<p><code>CONFIGURE_DIRS</code> (default:“.”) is a list of pathnames relative to <code>WRKSRC</code>. In each of these directories, the configure script is run with the environment <code>CONFIGURE_ENV</code> and arguments <code>CONFIGURE_ARGS</code>. The variables <code>CONFIGURE_ENV</code>, <code>CONFIGURE_SCRIPT</code> (default: “./configure”) and <code>CONFIGURE_ARGS</code> may all be changed by the package.</p>
</div>
<div class="paragraph">
<p>If the program uses the Perl way of configuration (mainly Perl modules, but not only), i.e. a file called <code>Makefile.PL</code>, it should include <code>../../lang/perl5/module.mk</code>. To set any parameter for <code>Makefile.PL</code> use the <code>MAKE_PARAMS</code> variable (e.g., <code>MAKE_PARAMS+=foo=bar</code></p>
</div>
<div class="paragraph">
<p>If the program uses an <code>Imakefile</code> for configuration, the appropriate steps can be invoked by setting <code>USE_IMAKE</code> to “yes”. If you only need xmkmf, add it to <code>USE_TOOLS</code>. You can add variables to xmkmf&#8217;s environment by adding them to the <code>SCRIPTS_ENV</code> variable.</p>
</div>
<div class="paragraph">
<p>If the program uses <code>cmake</code> for configuration, the appropriate steps can be invoked by setting <code>USE_CMAKE</code> to “yes”. You can add variables to cmake&#8217;s environment by adding them to the <code>CONFIGURE_ENV</code> variable and arguments to cmake by adding them to the <code>CMAKE_ARGS</code> variable. The top directory argument is given by the <code>CMAKE_ARG_PATH</code> variable, that defaults to “.” (relative to <code>CONFIGURE_DIRS</code>)</p>
</div>
<div class="paragraph">
<p>If there is no configure step at all, set <code>NO_CONFIGURE</code> to “yes”.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_12_the_build_phase">13.12. The build phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For building a package, a rough equivalent of the following code is executed; see <code>mk/build/build.mk</code>, target <code>do-build</code> for the exact definition.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.for dir in ${BUILD_DIRS}
    cd ${WRKSRC} &amp;&amp; cd ${dir} \
    &amp;&amp; env ${MAKE_ENV} \
        ${MAKE_PROGRAM} ${MAKE_FLAGS} ${BUILD_MAKE_FLAGS} \
            -f ${MAKE_FILE} \
            ${BUILD_TARGET}
.endfor</pre>
</div>
</div>
<div class="paragraph">
<p><code>BUILD_DIRS</code> (default:“.”) is a list of pathnames relative to <code>WRKSRC</code>. In each of these directories, <code>MAKE_PROGRAM</code> is run with the environment <code>MAKE_ENV</code> and arguments <code>BUILD_MAKE_FLAGS</code>. The variables <code>MAKE_ENV</code>, <code>BUILD_MAKE_FLAGS</code>, <code>MAKE_FILE</code> and <code>BUILD_TARGET</code> may all be changed by the package.</p>
</div>
<div class="paragraph">
<p>The default value of <code>MAKE_PROGRAM</code> is “gmake” if <code>USE_TOOLS</code> contains “gmake”, “make” otherwise. The default value of <code>MAKE_FILE</code> is “Makefile”, and <code>BUILD_TARGET</code> defaults to “all”.</p>
</div>
<div class="paragraph">
<p>If there is no build step at all, set <code>NO_BUILD</code> to “yes”.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_13_the_test_phase">13.13. The test phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>[TODO]</code></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_14_the_install_phase">13.14. The install phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once the build stage has completed, the final step is to install the software in public directories, so users can access the programs and files.</p>
</div>
<div class="paragraph">
<p>In the <em>install</em> phase, a rough equivalent of the following code is executed; see <code>mk/install/install.mk</code>, target <code>do-install</code> for the exact definition. Additionally, before and after this code, several consistency checks are run against the files-to-be-installed, see <code>mk/check/*.mk</code> for details.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.for dir in ${INSTALL_DIRS}
    cd ${WRKSRC} &amp;&amp; cd ${dir} \
    &amp;&amp; env ${INSTALL_ENV} ${MAKE_ENV} \
        ${MAKE_PROGRAM} ${MAKE_FLAGS} ${INSTALL_MAKE_FLAGS} \
            -f ${MAKE_FILE} ${INSTALL_TARGET}
.endfor</pre>
</div>
</div>
<div class="paragraph">
<p>The variable&#8217;s meanings are analogous to the ones in the <em>build</em> phase. <code>INSTALL_DIRS</code> defaults to <code>BUILD_DIRS</code>. <code>INSTALL_TARGET</code> is “install” by default, plus “install.man” if <code>USE_IMAKE</code> is defined and <code>NO_INSTALL_MANPAGES</code> is not defined.</p>
</div>
<div class="paragraph">
<p>In the <em>install</em> phase, the following variables are useful. They are all variations of the <a href="http://man.NetBSD.org/NetBSD-9.2/i386/install.1">install(1)</a> command that have the owner, group and permissions preset. <code>INSTALL</code> is the plain install command. The specialized variants, together with their intended use, are:</p>
</div>
<div class="paragraph">
<p><code>INSTALL_PROGRAM_DIR</code> directories that contain binaries</p>
</div>
<div class="paragraph">
<p><code>INSTALL_SCRIPT_DIR</code>directories that contain scripts</p>
</div>
<div class="paragraph">
<p><code>INSTALL_LIB_DIR</code> directories that contain shared and static libraries</p>
</div>
<div class="paragraph">
<p><code>INSTALL_DATA_DIR</code> directories that contain data files</p>
</div>
<div class="paragraph">
<p><code>INSTALL_MAN_DIR</code> directories that contain man pages</p>
</div>
<div class="paragraph">
<p><code>INSTALL_GAME_DIR</code> directories that contain data files for games</p>
</div>
<div class="paragraph">
<p><code>INSTALL_PROGRAM</code> binaries that can be stripped from debugging symbols</p>
</div>
<div class="paragraph">
<p><code>INSTALL_SCRIPT</code> binaries that cannot be stripped</p>
</div>
<div class="paragraph">
<p><code>INSTALL_GAME</code> game binaries</p>
</div>
<div class="paragraph">
<p><code>INSTALL_LIB</code> shared and static libraries</p>
</div>
<div class="paragraph">
<p><code>INSTALL_DATA</code> data files</p>
</div>
<div class="paragraph">
<p><code>INSTALL_GAME_DATA</code> data files for games</p>
</div>
<div class="paragraph">
<p><code>INSTALL_MAN</code> man pages</p>
</div>
<div class="paragraph">
<p>Some other variables are:</p>
</div>
<div class="paragraph">
<p><code>INSTALL_UNSTRIPPED</code> If set to <code>yes</code>, do not run <a href="http://man.NetBSD.org/NetBSD-9.2/i386/strip.1">strip(1)</a> when installing binaries. Any debugging sections and symbols present in binaries will be preserved.</p>
</div>
<div class="paragraph">
<p><code>INSTALLATION_DIRS</code> A list of directories relative to <code>PREFIX</code> that are created by pkgsrc at the beginning of the <em>install</em> phase. The package is supposed to create all needed directories itself before installing files to it and list all other directories here.</p>
</div>
<div class="paragraph">
<p>In the rare cases that a package shouldn&#8217;t install anything, set <code>NO_INSTALL</code> to “yes”. This is mostly relevant for packages in the <code>regress</code> category.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_15_the_package_phase">13.15. The package phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once the install stage has completed, a binary package of the installed files can be built. These binary packages can be used for quick installation without previous compilation, e.g. by the <strong>make bin-install</strong> or by using <strong>pkg_add</strong>.</p>
</div>
<div class="paragraph">
<p>By default, the binary packages are created in <code>${PACKAGES}/All</code> and symlinks are created in <code>${PACKAGES}/<em>category</code></em>, one for each category in the <code>CATEGORIES</code> variable. <code>PACKAGES</code> defaults to <code>pkgsrc/packages</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_16_cleaning_up">13.16. Cleaning up</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Once you&#8217;re finished with a package, you can clean the work directory by running <strong>make clean</strong>.  If you want to clean the work directories of all dependencies too, use <strong>make clean-depends</strong>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_13_17_other_helpful_targets">13.17. Other helpful targets</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><code>pre/post-*</code></dt>
<dd>
<p>For any of the main targets described in the previous section (configure, build, install, etc.), two auxiliary targets exist with “pre-” and “post-” used as a prefix for the main target&#8217;s name. These targets are invoked before and after the main target is called, allowing extra configuration or installation steps be performed from a package&#8217;s Makefile, for example, which a program&#8217;s configure script or install target omitted.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>About 5% of the pkgsrc packages define their custom post-extract target, another 5% define pre-configure, and 10% define post-install. The other pre/post-* targets are defined even less often.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>do-* </code></dt>
<dd>
<p>Should one of the main targets do the wrong thing, and should there be no variable to fix this, you can redefine it with the <code>do-* </code> target. (Note that redefining the target itself instead of the <code>do-* </code> target is a bad idea, as the pre-* and post-* targets won&#8217;t be called anymore, etc.)</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>About 15% of the pkgsrc packages override the default do-install, the other do-* targets are overridden even less often.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>reinstall</code></dt>
<dd>
<p>If you did a <strong>make install</strong> and you noticed some file was not installed properly, you can repeat the installation with this target, which will ignore the “already installed” flag.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>This is the default value of <code>DEPENDS_TARGET</code> except in the case of <strong>make update</strong> and <strong>make package</strong>, where the defaults are “package” and “update”, respectively.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>deinstall</code></dt>
<dd>
<p>This target does a <a href="http://man.NetBSD.org/NetBSD-9.2/i386/pkg_delete.1">pkg_delete(1)</a> in the current directory, effectively de-installing the package. The following variables can be used to tune the behaviour:</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><code>PKG_VERBOSE</code> Add a "-v" to the <a href="http://man.NetBSD.org/NetBSD-9.2/i386/pkg_delete.1">pkg_delete(1)</a> command.</p>
</div>
<div class="paragraph">
<p><code>DEINSTALLDEPENDS</code> Remove all packages that require (depend on) the given package. This can be used to remove any packages that may have been pulled in by a given package, e.g. if <strong>make deinstall DEINSTALLDEPENDS=1</strong> is done in <code>pkgsrc/x11/kde</code>, this is likely to remove whole KDE. Works by adding “-R” to the <a href="http://man.NetBSD.org/NetBSD-9.2/i386/pkg_delete.1">pkg_delete(1)</a> command line.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>bin-install</code></dt>
<dd>
<p>Install a binary package from local disk and via FTP from a list of sites (see the <code>BINPKG_SITES</code> variable), and do a <strong>make package</strong> if no binary package is available anywhere. The arguments given to <strong>pkg_add</strong> can be set via <code>BIN_INSTALL_FLAGS</code> e.g., to do verbose operation, etc.</p>
</dd>
<dt class="hdlist1"><code>install-clean</code></dt>
<dd>
<p>This target removes the state files for the "install" and later phases so that the "install" target may be re-invoked. This can be used after editing the PLIST to install the package without rebuilding it.</p>
</dd>
<dt class="hdlist1"><code>build-clean</code></dt>
<dd>
<p>This target removes the state files for the "build" and later phases so that the "build" target may be re-invoked.</p>
</dd>
<dt class="hdlist1"><code>update</code></dt>
<dd>
<p>This target causes the current package to be updated to the latest version. The package and all depending packages first get de-installed, then current versions of the corresponding packages get compiled and installed. This is similar to manually noting which packages are currently installed, then performing a series of <strong>make deinstall</strong> and <strong>make install</strong> (or whatever <code>UPDATE_TARGET</code> is set to) for these packages.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>You can use the “update” target to resume package updating in case a previous <strong>make update</strong> was interrupted for some reason. However, in this case, make sure you don&#8217;t call <strong>make clean</strong> or otherwise remove the list of dependent packages in <code>WRKDIR</code>. Otherwise, you lose the ability to automatically update the current package along with the dependent packages you have installed.</p>
</div>
<div class="paragraph">
<p>Resuming an interrupted <strong>make update</strong> will only work as long as the package tree remains unchanged. If the source code for one of the packages to be updated has been changed, resuming <strong>make update</strong> will most certainly fail!</p>
</div>
<div class="paragraph">
<p>The following variables can be used either on the command line or in <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> to alter the behaviour of <strong>make update</strong>:</p>
</div>
<div class="paragraph">
<p><code>UPDATE_TARGET</code> Install target to recursively use for the updated package and the dependent packages. Defaults to <code>DEPENDS_TARGET</code> if set, “install” otherwise for <strong>make update</strong>. Other good targets are “package” or “bin-install”. Do not set this to “update” or you will get stuck in an	endless loop!</p>
</div>
<div class="paragraph">
<p><code>NOCLEAN</code> Don&#8217;t clean up after updating. Useful if you want to leave the work sources of the updated packages around for inspection or other purposes. Be sure you eventually clean up the source tree (see the “clean-update” target below) or you may run into troubles with old source code still lying around on your next <strong>make</strong> or <strong>make	update</strong>.</p>
</div>
<div class="paragraph">
<p><code>REINSTALL</code> Deinstall each package before installing (making <code>DEPENDS_TARGET</code>). This may be necessary if the “clean-update” target (see below) was called after interrupting a running <strong>make update</strong>.</p>
</div>
<div class="paragraph">
<p><code>DEPENDS_TARGET</code> Allows you to disable recursion and hardcode the target for packages. The default is “update” for the update target, facilitating a recursive update of prerequisite	packages. Only set <code>DEPENDS_TARGET</code> if you want to disable recursive updates. Use <code>UPDATE_TARGET</code> instead to just set a specific target for each package to be installed during <strong>make update</strong>(see above).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>clean-update</code></dt>
<dd>
<p>Clean the source tree for all packages that would get updated if <strong>make update</strong> was called from the current directory. This target should not be used if the current package (or any of its depending packages) have already been de-installed (e.g., after calling <strong>make update</strong>) or you may lose some packages you intended to update. As a rule of thumb: only use this target <em>before</em> the first time you run <strong>make update</strong> and only if you have a dirty package tree (e.g., if you used <code>NOCLEAN</code>).</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If you are unsure about whether your tree is clean, you can either perform a <strong>make clean</strong> at the top of the tree, or use the following sequence of commands from the directory of the package you want to update (<em>before</em> running <strong>make update</strong> for the first time, otherwise you lose all the packages you wanted to update!):</p>
</div>
<div class="literalblock">
<div class="content">
<pre># make clean-update
# make clean CLEANDEPENDS=YES
# make update</pre>
</div>
</div>
<div class="paragraph">
<p>The following variables can be used either on the command line or in <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> to alter the behaviour of <strong>make clean-update</strong>:</p>
</div>
<div class="paragraph">
<p><code>CLEAR_DIRLIST</code> After <strong>make clean</strong>, do not reconstruct the list of directories to update for this package. Only use this if <strong>make update</strong> successfully installed all packages you wanted to update. Normally, this is done automatically on <strong>make	update</strong>, but may have been suppressed by the <code>NOCLEAN</code> variable (see above).</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>replace</code></dt>
<dd>
<p>Update the installation of the current package. This differs from update in that it does not replace dependent packages. You will need to install <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkg_tarup/index.html"><code>pkgtools/pkg_tarup</code></a> for this target to work.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p><em>Be careful when using this target!</em> There are no guarantees that dependent packages will still work, in particular they will most certainly break if you <strong>make replace</strong> a library package whose shared library major version changed between your installed version and the new one. For this reason, this target is not officially supported and only recommended for advanced users.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>info</code></dt>
<dd>
<p>This target invokes <a href="http://man.NetBSD.org/NetBSD-9.2/i386/pkg_info.1">pkg_info(1)</a> for the current package. You can use this to check which version of a package is installed.</p>
</dd>
<dt class="hdlist1"><code>index</code></dt>
<dd>
<p>This is a top-level command, i.e. it should be used in the <code>pkgsrc</code> directory. It creates a database of all packages in the local pkgsrc tree, including dependencies, comment, maintainer, and some other useful information.  Individual entries are created by running <strong>make describe</strong> in the packages' directories. This index file is saved as <code>pkgsrc/INDEX</code>. It can be displayed in verbose format by running <strong>make print-index</strong>. You can search in it with <strong>make search key=<em><code>something</code></em></strong>. You can extract a list of all packages that depend on a particular one by running <strong>make show-deps PKG=<em><code>somepackage</code></em></strong>.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>Running this command takes a very long time, some hours even on fast machines!</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>readme</code></dt>
<dd>
<p>This target generates a <code>index.html</code> file, which can be viewed using a browser such as <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/www/firefox/index.html"><code>www/firefox</code></a> or <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/www/links/index.html"><code>www/links</code></a>. The generated files contain references to any packages which are in the <code>PACKAGES</code> directory on the local host. The generated files can be made to refer to URLs based on <code>FTP_PKG_URL_HOST</code> and <code>FTP_PKG_URL_DIR</code>. For example, if I wanted to generate <code>index.html</code> files which pointed to binary packages on the local machine, in the directory <code>/usr/packages</code>, set <code>FTP_PKG_URL_HOST=file://localhost</code> and <code>FTP_PKG_URL_DIR=/usr/packages</code>. The <code>${PACKAGES}</code> directory and its subdirectories will be searched for all the binary packages.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>The target can be run at the toplevel or in category directories, in which case it descends recursively.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>readme-all</code></dt>
<dd>
<p>This is a top-level command, run it in <code>pkgsrc</code>. Use this target to create a file <code>README-all.html</code> which contains a list of all packages currently available in the NetBSD Packages Collection, together with the category they belong to and a short description. This file is compiled from the <code>pkgsrc/*/index.html</code> files, so be sure to run this <em>after</em> a <strong>make readme</strong>.</p>
</dd>
<dt class="hdlist1"><code>cdrom-readme</code></dt>
<dd>
<p>This is very much the same as the “readme” target (see above), but is to be used when generating a pkgsrc tree to be written to a CD-ROM. This target also produces <code>index.html</code> files, and can be made to refer to URLs based on <code>CDROM_PKG_URL_HOST</code> and <code>CDROM_PKG_URL_DIR</code>.</p>
</dd>
<dt class="hdlist1"><code>show-distfiles</code></dt>
<dd>
<p>This target shows which distfiles and patchfiles are needed to build the package (<code>ALLFILES</code>, which contains all <code>DISTFILES</code> and <code>PATCHFILES</code>, but not <code>patches/*</code>).</p>
</dd>
<dt class="hdlist1"><code>show-downlevel</code></dt>
<dd>
<p>This target shows nothing if the package is not installed. If a version of this package is installed, but is not the version provided in this version of pkgsrc, then a warning message is displayed. This target can be used to show which of your installed packages are downlevel, and so the old versions can be deleted, and the current ones added.</p>
</dd>
<dt class="hdlist1"><code>show-pkgsrc-dir</code></dt>
<dd>
<p>This target shows the directory in the pkgsrc hierarchy from which the package can be built and installed. This may not be the same directory as the one from which the package was installed. This target is intended to be used by people who may wish to upgrade many packages on a single host, and can be invoked from the top-level pkgsrc Makefile by using the “show-host-specific-pkgs” target.</p>
</dd>
<dt class="hdlist1"><code>show-installed-depends</code></dt>
<dd>
<p>This target shows which installed packages match the current package&#8217;s <code>DEPENDS</code>. Useful if out of date dependencies are causing build problems.</p>
</dd>
<dt class="hdlist1"><code>print-build-depends-list</code></dt>
<dd>
<p>This target shows the list of packages that the current package depends on for building.</p>
</dd>
<dt class="hdlist1"><code>print-run-depends-list</code></dt>
<dd>
<p>This target shows the list of packages that the current package depends on for running.</p>
</dd>
<dt class="hdlist1"><code>check-shlibs</code></dt>
<dd>
<p>After a package is installed, check all its binaries and (on ELF platforms) shared libraries to see if they find the shared libs they need. Run by default if <code>PKG_DEVELOPER</code> is set in <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>.</p>
</dd>
<dt class="hdlist1"><code>print-PLIST</code></dt>
<dd>
<p>After a “make install” from a new or upgraded pkg, this prints out an attempt to generate a new <code>PLIST</code> from a <strong>find -newer work/.extract_done</strong>. An attempt is made to care for shared libs etc., but it is <em>strongly</em> recommended to review the result before putting it into <code>PLIST</code>. On upgrades, it&#8217;s useful to diff the output of this command against an already existing <code>PLIST</code> file.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>If the package installs files via <a href="http://man.NetBSD.org/NetBSD-9.2/i386/tar.1">tar(1)</a> or other methods that don&#8217;t update file access times, be sure to add these files manually to your <code>PLIST</code>, as the “find -newer” command used by this target won&#8217;t catch them!</p>
</div>
<div class="paragraph">
<p>See <a href="http://netbsd.org/docs/pkgsrc/plist.html#print-PLIST">Section 19.3, “Tweaking output of <strong>make print-PLIST</strong>”</a> for more information on this target.</p>
</div>
</div>
</div>
<h1 id="_chapter_14_creating_a_new_pkgsrc_package_from_scratch" class="sect0">Chapter 14. Creating a new pkgsrc package from scratch</h1>
<div class="paragraph">
<p>When you find a package that is not yet in pkgsrc, you most likely have a URL from where you can download the source code. Starting with this URL, creating a package involves only a few steps.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>, set <code>PKG_DEVELOPER=yes</code> to enable the basic quality checks.</p>
</li>
<li>
<p>Install the package <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/meta-pkgs/pkg_developer/index.html"><code>meta-pkgs/pkg_developer</code></a>, which among others will install the utilities <strong>url2pkg</strong>, <strong>pkglint</strong>, <strong>pkgvi</strong> and <strong>mkpatches</strong>:</p>
<div class="literalblock">
<div class="content">
<pre>$ cd /usr/pkgsrc
$ (cd meta-pkgs/pkg_developer &amp;&amp; bmake update)</pre>
</div>
</div>
</li>
<li>
<p>Choose one of the top-level directories as the category in which you want to place your package. You can also create a directory of your own (maybe called <code>local</code>). Change into that category directory:</p>
<div class="literalblock">
<div class="content">
<pre>$ cd category</pre>
</div>
</div>
</li>
<li>
<p>Run the program <strong>url2pkg</strong>, passing as argument the URL of the distribution file (in most cases a <code>.tar.gz</code> file). This will download the distribution file and create the necessary files of the package, based on what&#8217;s in the distribution file:</p>
<div class="literalblock">
<div class="content">
<pre>$ url2pkg https://www.example.org/packages/package-1.0.tar.gz</pre>
</div>
</div>
</li>
<li>
<p>Examine the extracted files to determine the dependencies of your package. Ideally, this is mentioned in some <code>README</code> file, but things may differ. For each of these dependencies, look where it exists in pkgsrc, and if there is a file called <code>buildlink3.mk</code> in that directory, add a line to your package <code>Makefile</code> which includes that file just before the last line. If the <code>buildlink3.mk</code> file does not exist, it must be created first. The <code>buildlink3.mk</code> file makes sure that the package&#8217;s include files and libraries are provided.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If you just need binaries from a dependent package, add a <code>DEPENDS</code> line to the Makefile, which specifies the version of the dependency and where it can be found in pkgsrc. This line should be placed in the third paragraph. If the dependency is only needed for building the package, but not when using it, use <code>TOOL_DEPENDS</code> or <code>BUILD_DEPENDS</code> instead of <code>DEPENDS</code>. The difference between <code>TOOL_DEPENDS</code> and <code>BUILD_DEPENDS</code> occurs when cross-compiling: <code>TOOL_DEPENDS</code> are <em>native</em> packages, i.e. packages for the platform where the package is built; <code>BUILD_DEPENDS</code> are <em>target</em> packages, i.e. packages for the platform for which the package is built. There is also <code>TEST_DEPENDS</code>, which specifies a dependency used only for testing the resulting package built, using the upstream project&#8217;s included test suite, on the native platform.
Your package may then look like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[...]
TOOL_DEPENDS+=  libxslt-[0-9]*:../../textproc/libxslt
DEPENDS+=       screen-[0-9]*:../../misc/screen
DEPENDS+=       screen&gt;=4.0:../../misc/screen
[...]
.include "../../category/package/buildlink3.mk"
.include "../../devel/glib2/buildlink3.mk"
.include "../../mk/bsd.pkg.mk"</pre>
</div>
</div>
<div class="paragraph">
<p>6.Run <strong>pkglint</strong> to see what things still need to be done to make your package a “good” one. If you don&#8217;t know what pkglint&#8217;s warnings want to tell you, try <strong>pkglint --explain</strong> or <strong>pkglint -e</strong>, which outputs additional explanations.</p>
</div>
<div class="paragraph">
<p>7.In many cases the package is not yet ready to build. You can find instructions for the most common cases in the next section, <a href="https://www.netbsd.org/docs/pkgsrc/creating.html#creating.common">Section 14.1, “Common types of packages”</a>. After you have followed the instructions over there, you can hopefully continue here.</p>
</div>
<div class="paragraph">
<p>8.Run <strong>bmake clean</strong> to clean the working directory from the extracted files. Besides these files, a lot of cache files and other system information have been saved in the working directory, which may have become outdated after you edited the <code>Makefile</code>.</p>
</div>
<div class="paragraph">
<p>9.Now, run <strong>bmake</strong> to build the package. For the various things that can go wrong in this phase, consult <a href="https://www.netbsd.org/docs/pkgsrc/fixes.html">Chapter 21, Making your package work</a>.</p>
</div>
<div class="paragraph">
<p>If the extracted files from the package need to be fixed, run multiple rounds of these commands:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ bmake
$ pkgvi ${WRKSRC}/some/file/that/does/not/compile
$ mkpatches
$ bmake mps
$ bmake clean</pre>
</div>
</div>
<div class="paragraph">
<p>10.When the package builds fine, the next step is to install the package. Run <strong>bmake install</strong> and hope that everything works.</p>
</div>
<div class="paragraph">
<p>11.Up to now, the file <code>PLIST</code>, which contains a list of the files that are installed by the package, is nearly empty. Run <strong>bmake print-PLIST &gt;PLIST</strong> to generate a probably correct list. Check the file using your preferred text editor to see if the list of files looks plausible.</p>
</div>
<div class="paragraph">
<p>12.Run <strong>pkglint</strong> again to see if the generated <code>PLIST</code> contains garbage or not.</p>
</div>
<div class="paragraph">
<p>13.When you ran <strong>bmake install</strong>, the package had been registered in the database of installed files, but with an empty list of files. To fix this, run <strong>bmake deinstall</strong> and <strong>bmake install</strong> again. Now the package is registered with the list of files from <code>PLIST</code>.</p>
</div>
<div class="paragraph">
<p>14.Run <strong>bmake clean update</strong> to run everything from above again in a single step, making sure that the PLIST is correct and the whole package is created as intended.</p>
</div>
<div class="paragraph">
<p>15.Run <strong>pkglint</strong> to see if there&#8217;s anything left to do.</p>
</div>
<div class="paragraph">
<p>16.Commit the package to pkgsrc-wip or main pkgsrc; see <a href="https://www.netbsd.org/docs/pkgsrc/submit.html">Chapter 23, Submitting and Committing</a>.</p>
</div>
<div class="sect1">
<h2 id="_14_1_common_types_of_packages">14.1. Common types of packages</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_14_1_1_python_modules_and_programs">14.1.1. Python modules and programs</h3>
<div class="paragraph">
<p>Python modules and programs packages are easily created using a set of predefined variables.</p>
</div>
<div class="paragraph">
<p>If some Python versions are not supported by the software, set the <code>PYTHON_VERSIONS_INCOMPATIBLE</code> variable to the Python versions that are not supported, e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PYTHON_VERSIONS_INCOMPATIBLE=       27</pre>
</div>
</div>
<div class="paragraph">
<p>If the packaged software is a Python module, include one of <code>../../lang/python/egg.mk</code> or <code>../../lang/python/extension.mk</code>.</p>
</div>
<div class="paragraph">
<p>Most Python packages use setuptools (“eggs”). If the packaged software is using setuptools, you only need to include “<code>../../lang/python/egg.mk</code>”.</p>
</div>
<div class="paragraph">
<p>Either way, the package directory should be called “py-software” and <code>PKGNAME</code> should be set to “${PYPKGPREFIX}-${DISTNAME}”, e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTNAME=   foopymodule-1.2.10
PKGNAME=    ${PYPKGPREFIX}-${DISTNAME}</pre>
</div>
</div>
<div class="paragraph">
<p>If it is an application, include “<code>../../lang/python/application.mk</code>”. In order to correctly set the path to the Python interpreter, use the <code>REPLACE_PYTHON</code> variable and set it to the list of files (paths relative to <code>WRKSRC</code>) that must be corrected. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>REPLACE_PYTHON=   *.py</pre>
</div>
</div>
<div class="paragraph">
<p>Some Python modules have separate distributions for Python-2.x and Python-3.x support. In pkgsrc this is handled by the <code>versioned_dependencies.mk</code> file. Set <code>PYTHON_VERSIONED_DEPENDENCIES</code> to the list of packages that should be depended upon and include “<code>../../lang/python/versioned_dependencies.mk</code>”, then the pkgsrc infrastructure will depend on the appropriate package version. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PYTHON_VERSIONED_DEPENDENCIES=dialog</pre>
</div>
</div>
<div class="paragraph">
<p>Look inside <code>versioned_dependencies.mk</code> for a list of supported packages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_14_1_2_r_packages">14.1.2. R packages</h3>
<div class="paragraph">
<p>Simple R packages from <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html">CRAN</a> are handled automatically by <strong>R2pkg</strong>, which is available in <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/R2pkg/index.html"><code>pkgtools/R2pkg</code></a>. Individual packages (and optionally their dependencies) may be created and updated. R packages generally follow the same form, and most of the relevant information needed is contained in a <code>DESCRIPTION</code> file as part of each R package on <a href="https://cran.r-project.org/web/packages/available_packages_by_name.html">CRAN</a>. Consequently, <strong>R2pkg</strong> downloads that information and creates or updates a package in the canonical form. The resulting package should be reviewed for correctness.</p>
</div>
</div>
<div class="sect2">
<h3 id="_14_1_3_texlive_packages">14.1.3. TeXlive packages</h3>
<div class="paragraph">
<p>TeXlive packages from <a href="https://www.ctan.org/">CTAN</a> are handled automatically by <strong>texlive2pkg</strong>, which is available in <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/texlive2pkg/index.html"><code>pkgtools/texlive2pkg</code></a>.</p>
</div>
<div class="paragraph">
<p>If the TeXlive package name is not known, it may be useful to search <a href="https://www.ctan.org/">CTAN</a>. A “Contained in” field on the package page typically identifies the basename of the package file in the <a href="https://www.ctan.org/tex-archive/systems/texlive/tlnet/archive">TeXlive
archive</a>.</p>
</div>
<div class="paragraph">
<p>If the TeXlive package name is known, download the files from the <a href="https://www.ctan.org/tex-archive/systems/texlive/tlnet/archive">TeXlive
archive</a>. For package <code>foo</code>, you will need to download <code>foo.tar.xz</code>. Most TeXlive packages also have associated documentation packages, so download <code>foo.doc.tar.xz</code> at the same time. These files should be placed in the appropriate category directory, which is often but not always <code>print</code>. Then run the following command in the category directory.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>texlive2pkg foo.tar.xz foo.doc.tar.xz</pre>
</div>
</div>
<div class="paragraph">
<p>This will create two packages, <code>tex-foo</code> and <code>tex-foo-doc</code>. Be sure to check that both packages are correct.</p>
</div>
<div class="paragraph">
<p>Finally, <a href="https://www.ctan.org/">CTAN</a> currently does not include version information in package filenames and changes their contents periodically when updates occur. Consequently, pkgsrc avoids downloading distfiles directly from <a href="https://www.ctan.org/">CTAN</a> and instead relies on the pkgsrc archives. For each new or updated TeXlive package, e.g., the main one and the corresponding documentation, upload the distfiles with the following command in each package directory.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>make upload-distfiles</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_14_2_examples">14.2. Examples</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_14_2_1_how_the_wwwnvu_package_came_into_pkgsrc">14.2.1. How the www/nvu package came into pkgsrc</h3>
<div class="sect3">
<h4 id="_14_2_1_1_the_initial_package">14.2.1.1. The initial package</h4>
<div class="paragraph">
<p>Looking at the file <code>pkgsrc/doc/TODO</code>, I saw that the “nvu” package has not yet been imported into pkgsrc. As the description says it has to do with the web, the obvious choice for the category is “www”.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ mkdir www/nvu
$ cd www/nvu</pre>
</div>
</div>
<div class="paragraph">
<p>The web site says that the sources are available as a tar file, so I fed that URL to the <strong>url2pkg</strong> program:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ url2pkg http://cvs.nvu.com/download/nvu-1.0-sources.tar.bz2</pre>
</div>
</div>
<div class="paragraph">
<p>My editor popped up, and I added a <code>PKGNAME</code> line below the <code>DISTNAME</code> line, as the package name should not have the word “sources” in it. I also filled in the <code>MAINTAINER</code>, <code>HOMEPAGE</code> and <code>COMMENT</code> fields. Then the package <code>Makefile</code> looked like that:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># $NetBSD $
#
DISTNAME=       nvu-1.0-sources
PKGNAME=        nvu-1.0
CATEGORIES=     www
MASTER_SITES=   http://cvs.nvu.com/download/
EXTRACT_SUFX=   .tar.bz2
 MAINTAINER=     rillig@NetBSD.org
HOMEPAGE=       http://cvs.nvu.com/
COMMENT=        Web Authoring System
 # url2pkg-marker (please do not remove this line.)
.include "../../mk/bsd.pkg.mk"</pre>
</div>
</div>
<div class="paragraph">
<p>On the first line of output above, an artificial space has been added between NetBSD and $, this is a workaround to prevent CVS expanding to the filename of the guide.</p>
</div>
<div class="paragraph">
<p>Then, I quit the editor and watched pkgsrc downloading a large source archive:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>url2pkg&gt; Running "make makesum" ...
=&gt; Required installed package digest&gt;=20010302: digest-20060826 found
=&gt; Fetching nvu-1.0-sources.tar.bz2
Requesting http://cvs.nvu.com/download/nvu-1.0-sources.tar.bz2
100% |*************************************| 28992 KB  150.77 KB/s00:00 ETA
29687976 bytes retrieved in 03:12 (150.77 KB/s)
url2pkg&gt; Running "make extract" ...
=&gt; Required installed package digest&gt;=20010302: digest-20060826 found
=&gt; Checksum SHA1 OK for nvu-1.0-sources.tar.bz2
=&gt; Checksum RMD160 OK for nvu-1.0-sources.tar.bz2
work.bacc -&gt; /tmp/roland/pkgsrc/www/nvu/work.bacc
===&gt; Installing dependencies for nvu-1.0
===&gt; Overriding tools for nvu-1.0
===&gt; Extracting for nvu-1.0
url2pkg&gt; Adjusting the Makefile.
Remember to correct CATEGORIES, HOMEPAGE, COMMENT, and DESCR when you're done!
Good luck! (See pkgsrc/doc/pkgsrc.txt for some more help :-)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_14_2_1_2_fixing_all_kinds_of_problems_to_make_the_package_work">14.2.1.2. Fixing all kinds of problems to make the package work</h4>
<div class="paragraph">
<p>Now that the package has been extracted, let&#8217;s see what&#8217;s inside it. The package has a <code>README.txt</code>, but that only says something about mozilla, so it&#8217;s probably useless for seeing what dependencies this package has. But since there is a GNU configure script in the package, let&#8217;s hope that it will complain about everything it needs.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ bmake
=&gt; Required installed package digest&gt;=20010302: digest-20060826 found
=&gt; Checksum SHA1 OK for nvu-1.0-sources.tar.bz2
=&gt; Checksum RMD160 OK for nvu-1.0-sources.tar.bz2
===&gt; Patching for nvu-1.0
===&gt; Creating toolchain wrappers for nvu-1.0
===&gt; Configuring for nvu-1.0
[...]
configure: error: Perl 5.004 or higher is required.
[...]
WARNING: Please add USE_TOOLS+=perl to the package Makefile.
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>That worked quite well. So I opened the package Makefile in my editor, and since it already has a <code>USE_TOOLS</code> line, I just appended “perl” to it. Since the dependencies of the package have changed now, and since a perl wrapper is automatically installed in the “tools” phase, I need to build the package from scratch.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ bmake clean
===&gt; Cleaning for nvu-1.0
$ bmake
[...]
*** /tmp/roland/pkgsrc/www/nvu/work.bacc/.tools/bin/make is not \
GNU Make.  You will not be able to build Mozilla without GNU Make.
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>So I added “gmake” to the <code>USE_TOOLS</code> line and tried again (from scratch).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[...]
checking for GTK - version &gt;= 1.2.0... no
*** Could not run GTK test program, checking why...
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>Now to the other dependencies. The first question is: Where is the GTK package hidden in pkgsrc?</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ echo ../../*/gtk*
[many packages ...]
$ echo ../../*/gtk
../../x11/gtk
$ echo ../../*/gtk2
../../x11/gtk2
$ echo ../../*/gtk2/bui*
../../x11/gtk2/buildlink3.mk</pre>
</div>
</div>
<div class="paragraph">
<p>The first try was definitely too broad. The second one had exactly one result, which is very good. But there is one pitfall with GNOME packages. Before GNOME 2 had been released, there were already many GNOME 1 packages in pkgsrc. To be able to continue to use these packages, the GNOME 2 packages were imported as separate packages, and their names usually have a “2” appended. So I checked whether this was the case here, and indeed it was.</p>
</div>
<div class="paragraph">
<p>Since the GTK2 package has a <code>buildlink3.mk</code> file, adding the dependency is very easy. I just inserted an <code>.include</code> line before the last line of the package <code>Makefile</code>, so that it now looks like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[...]
.include "../../x11/gtk2/buildlink3.mk"
.include "../../mk/bsd.pkg.mk</pre>
</div>
</div>
<div class="paragraph">
<p>After another <strong>bmake clean &amp;&amp; bmake</strong>, the answer was:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[...]
checking for gtk-config... /home/roland/pkg/bin/gtk-config
checking for GTK - version &gt;= 1.2.0... no
*** Could not run GTK test program, checking why...
*** The test program failed to compile or link. See the file config.log for the
*** exact error that occured. This usually means GTK was incorrectly installed
*** or that you have moved GTK since it was installed. In the latter case, you
*** may want to edit the gtk-config script: /home/roland/pkg/bin/gtk-config
configure: error: Test for GTK failed.
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>In this particular case, the assumption that “every package prefers GNOME 2” had been wrong. The first of the lines above told me that this package really wanted to have the GNOME 1 version of GTK. If the package had looked for GTK2, it would have looked for <strong>pkg-config</strong> instead of <strong>gtk-config</strong>. So I changed the <code>x11/gtk2</code> to <code>x11/gtk</code> in the package <code>Makefile</code>, and tried again.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>[...]
cc -o xpidl.o -c -DOSTYPE=\"NetBSD3\" -DOSARCH=\"NetBSD\"  [...]
In file included from xpidl.c:42:
xpidl.h:53:24: libIDL/IDL.h: No such file or directory
In file included from xpidl.c:42:
xpidl.h:132: error: parse error before "IDL_ns"
[...]</pre>
</div>
</div>
<div class="paragraph">
<p>The package still does not find all of its dependencies. Now the question is: Which package provides the <code>libIDL/IDL.h</code> header file?</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ echo ../../*/*idl*
../../devel/py-idle ../../wip/idled ../../x11/acidlaunch
$ echo ../../*/*IDL*
../../net/libIDL</pre>
</div>
</div>
<div class="paragraph">
<p>Let&#8217;s take the one from the second try. So I included the <code>../../net/libIDL/buildlink3.mk</code> file and tried again. But the error didn&#8217;t change. After digging through some of the code, I concluded that the build process of the package was broken and couldn&#8217;t have ever worked, but since the Mozilla source tree is quite large, I didn&#8217;t want to fix it. So I added the following to the package <code>Makefile</code> and tried again:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CPPFLAGS+=      -I${BUILDLINK_PREFIX.libIDL}/include/libIDL-2.0
BUILDLINK_TRANSFORM+=   l:IDL:IDL-2</pre>
</div>
</div>
<div class="paragraph">
<p>The latter line is needed because the package expects the library <code>libIDL.so</code>, but only <code>libIDL-2.so</code> is available. So I told the compiler wrapper to rewrite that on the fly.</p>
</div>
<div class="paragraph">
<p>The next problem was related to a recent change of the FreeType interface. I looked up in <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/www/seamonkey/index.html"><code>www/seamonkey</code></a> which patch files were relevant for this issue and copied them to the <code>patches</code> directory. Then I retried, fixed the patches so that they applied cleanly and retried again. This time, everything worked.</p>
</div>
</div>
<div class="sect3">
<h4 id="_14_2_1_3_installing_the_package">14.2.1.3. Installing the package</h4>
<div class="literalblock">
<div class="content">
<pre>$ bmake CHECK_FILES=no install
[...]
$ bmake print-PLIST &gt;PLIST
$ bmake deinstall
$ bmake install</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<h1 id="_chapter_15_programming_in_makefiles" class="sect0">Chapter 15. Programming in Makefiles</h1>
<div class="paragraph">
<p>Pkgsrc consists of many <code>Makefile</code> fragments, each of which forms a well-defined part of the pkgsrc system. Using the <a href="https://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> system as a programming language for a big system like pkgsrc requires some discipline to keep the code correct and understandable.</p>
</div>
<div class="paragraph">
<p>The basic ingredients for <code>Makefile</code> programming are variables and shell commands. Among these shell commands may even be more complex ones like <a href="https://man.NetBSD.org/NetBSD-9.2/i386/awk.1">awk(1)</a> programs. To make sure that every shell command runs as intended it is necessary to quote all variables correctly when they are used.</p>
</div>
<div class="paragraph">
<p>This chapter describes some patterns that appear quite often in <code>Makefile</code>s, including the pitfalls that come along with them.</p>
</div>
<div class="sect1">
<h2 id="_15_1_caveats">15.1. Caveats</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>When you are creating a file as a target of a rule, always write the data to a temporary file first and finally rename that file. Otherwise there might occur an error in the middle of generating the file, and when the user runs <a href="https://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> for the second time, the file exists and will not be regenerated properly. Example:</p>
<div class="literalblock">
<div class="content">
<pre>wrong:
    @echo "line 1" &gt; ${.TARGET}
    @echo "line 2" &gt;&gt; ${.TARGET}
    @false
correct:
    @echo "line 1" &gt; ${.TARGET}.tmp
    @echo "line 2" &gt;&gt; ${.TARGET}.tmp
    @false
    @mv ${.TARGET}.tmp ${.TARGET}</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>When you run <strong>make wrong</strong> twice, the file <code>wrong</code> will exist, although there was an error message in the first run. On the other hand, running <strong>make correct</strong> gives an error message twice, as expected.</p>
</div>
<div class="paragraph">
<p>You might remember that <a href="https://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> sometimes removes <code>${.TARGET}</code> in case of error, but this only happens when it is interrupted, for example by pressing <code>Ctrl+C</code>. This does <em>not</em> happen when one of the commands fails (like <a href="https://man.NetBSD.org/NetBSD-9.2/i386/false.1">false(1)</a> above).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_15_2_makefile_variables">15.2. Makefile variables</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>Makefile</code> variables contain strings that can be processed using the five operators <code>=</code>, <code>+=</code>, <code>?=</code>, <code>:=</code> and <code>!=</code>, which are described in the <a href="https://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> man page.</p>
</div>
<div class="paragraph">
<p>When a variable&#8217;s value is parsed from a <code>Makefile</code>, the hash character <code>#</code> and the backslash character <code>\</code> are handled specially. If a backslash is the last character in a line, that backslash is removed from the line and the line continues with the next line of the file.</p>
</div>
<div class="paragraph">
<p>The <code><mark></code> character starts a comment that reaches until the end of the line. To get an actual <code></mark></code> character, such as in a URL, write <code>\#</code> instead.</p>
</div>
<div class="paragraph">
<p>The evaluation of variables either happens immediately or lazy. It happens immediately when the variable occurs on the right-hand side of the <code>:=</code> or the <code>!=</code> operator, in a <code>.if</code> condition or a <code>.for</code> loop. In the other cases, it is evaluated lazily.</p>
</div>
<div class="paragraph">
<p>Some of the modifiers split the string into words and then operate on the words, others operate on the string as a whole. When a string is split into words, double quotes and single quotes are interpreted as delimiters, just like in <a href="https://man.NetBSD.org/NetBSD-9.2/i386/sh.1">sh(1)</a>.</p>
</div>
<div class="sect2">
<h3 id="_15_2_1_naming_conventions">15.2.1. Naming conventions</h3>
<div class="ulist">
<ul>
<li>
<p>All variable names starting with an underscore are reserved for use by the pkgsrc infrastructure. They shall not be used by packages.</p>
</li>
<li>
<p>In <strong>.for</strong> loops you should use lowercase variable names for the iteration variables.</p>
</li>
<li>
<p>All list variables should have a plural name, such as <code>PKG_OPTIONS</code> or <code>DISTFILES</code>.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_15_3_code_snippets">15.3. Code snippets</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_15_3_1_adding_things_to_a_list">15.3.1. Adding things to a list</h3>
<div class="paragraph">
<p>When adding a string that possibly contains whitespace or quotes to a list (example 1), it must be quoted using the <code>:Q</code> modifier.</p>
</div>
<div class="paragraph">
<p>When adding another list to a list (example 2), it must not be quoted, since its elements are already quoted.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>STRING=         foo * bar `date`
LIST=           # empty
ANOTHER_LIST=   a=b c=d
LIST+=          ${STRING:Q}       # 1
LIST+=          ${ANOTHER_LIST}   # 2</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_15_3_2_echoing_a_string_exactly_as_is">15.3.2. Echoing a string exactly as-is</h3>
<div class="paragraph">
<p>Echoing a string containing special characters needs special work.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>STRING=         foo bar &lt;    &gt; * `date` $$HOME ' "
EXAMPLE_ENV=    string=${STRING:Q} x=multiple\ quoted\ words
all:
        echo ${STRING}                  # 1
        echo ${STRING:Q}                # 2
        printf '%s\n' ${STRING:Q}''     # 3
        env ${EXAMPLE_ENV} sh -c 'echo "$$string"; echo "$$x"'  # 4</pre>
</div>
</div>
<div class="paragraph">
<p>Example 1 leads to a syntax error in the shell, as the characters are just copied.</p>
</div>
<div class="paragraph">
<p>Example 2 quotes the string so that the shell interprets it correctly. But the echo command may additionally interpret strings with a leading dash or those containing backslashes.</p>
</div>
<div class="paragraph">
<p>Example 3 can handle arbitrary strings, since <a href="https://man.NetBSD.org/NetBSD-9.2/i386/printf.1">printf(1)</a> only interprets the format string, but not the next argument. The trailing single quotes handle the case when the string is empty. In that case, the :Q modifier would result in an empty string too, which would then be skipped by the shell. For <a href="https://man.NetBSD.org/NetBSD-9.2/i386/printf.1">printf(1)</a> this doesn&#8217;t make a difference, but other programs may care.</p>
</div>
<div class="paragraph">
<p>In example 4, the <code>EXAMPLE_ENV</code> does not need to be quoted because the quoting has already been done when adding elements to the list.</p>
</div>
</div>
<div class="sect2">
<h3 id="_15_3_3_passing_cflags_to_gnu_configure_scripts">15.3.3. Passing CFLAGS to GNU configure scripts</h3>
<div class="paragraph">
<p>When passing <code>CFLAGS</code> or similar variables to a GNU-style configure script (especially those that call other configure scripts), it must not have leading or trailing whitespace, since otherwise the configure script gets confused. To trim leading and trailing whitespace, use the <code>:M</code> modifier, as in the following example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CPPFLAGS=               # empty
CPPFLAGS+=              -Wundef -DPREFIX=\"${PREFIX}\"
CPPFLAGS+=              ${MY_CPPFLAGS}
CONFIGURE_ARGS+=        CPPFLAGS=${CPPFLAGS:M*:Q}
all:
    echo x${CPPFLAGS:Q}x            # leading and trailing whitespace
    echo x${CONFIGURE_ARGS:Q}x      # properly trimmed</pre>
</div>
</div>
<div class="paragraph">
<p>In this example, <code>CPPFLAGS</code> has both leading and trailing whitespace because the <code>+=</code> operator always adds a space.</p>
</div>
</div>
<div class="sect2">
<h3 id="_15_3_4_handling_possibly_empty_variables">15.3.4. Handling possibly empty variables</h3>
<div class="paragraph">
<p>When a possibly empty variable is used in a shell program, it may lead to a syntax error.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>EGFILES=        # empty
install-examples:   # produces a syntax error in the shell
    for egfile in ${EGFILES}; do            \
            echo "Installing $$egfile";     \
    done</pre>
</div>
</div>
<div class="paragraph">
<p>The shell only sees the text <code>for egfile in ; do</code>, since <code>${EGFILES}</code> is replaced with an empty string by <a href="https://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a>. To fix this syntax error, use one of the snippets below.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>EMPTY=          # empty
install-examples:
    for egfile in ${EGFILES} ""; do         \
            [ -n "$$egfile" ] || continue;  \
            echo "Installing $$egfile";     \
    done</pre>
</div>
</div>
<div class="paragraph">
<p>In this case, an empty string is appended to the iteration list (to prevent the syntax error) and filtered out later.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>EGFILES=        # empty
install-examples:
.for egfile in ${EGFILES}
    echo "Installing ${egfile}"
.endfor</pre>
</div>
</div>
<div class="paragraph">
<p>If one of the filenames contains special characters, it should be enclosed in single or double quotes.</p>
</div>
<div class="paragraph">
<p>To have a shell command test whether a make variable is empty, use the following code: <code>${TEST} -z ${POSSIBLY_EMPTY:Q}""</code>.</p>
</div>
</div>
</div>
</div>
<h1 id="_chapter_16_options_handling" class="sect0">Chapter 16. Options handling</h1>
<div class="paragraph">
<p>Many packages have the ability to be built to support different sets of features. <code>bsd.options.mk</code> is a framework in pkgsrc that provides generic handling of those options that determine different ways in which the packages can be built. It&#8217;s possible for the user to specify exactly which sets of options will be built into a package or to allow a set of global default options apply.</p>
</div>
<div class="paragraph">
<p>There are two broad classes of behaviors that one might want to control via options. One is whether some particular feature is enabled in a program that will be built anyway, often by including or not including a dependency on some other package. The other is whether or not an additional program will be built as part of the package. Generally, it is better to make a split package for such additional programs instead of using options, because it enables binary packages to be built which can then be added separately. For example, the foo package might have minimal dependencies (those packages without which foo doesn&#8217;t make sense), and then the foo-gfoo package might include the GTK frontend program gfoo. This is better than including a gtk option to foo that adds gfoo, because either that option is default, in which case binary users can&#8217;t get foo without gfoo, or not default, in which case they can&#8217;t get gfoo. With split packages, they can install foo without having GTK, and later decide to install gfoo (pulling in GTK at that time). This is an advantage to source users too, avoiding the need for rebuilds.</p>
</div>
<div class="paragraph">
<p>Plugins with widely varying dependencies should usually be split instead of options.</p>
</div>
<div class="paragraph">
<p>It is often more work to maintain split packages, especially if the upstream package does not support this. The decision of split vs. option should be made based on the likelihood that users will want or object to the various pieces, the size of the dependencies that are included, and the amount of work.</p>
</div>
<div class="paragraph">
<p>A further consideration is licensing. Non-free parts, or parts that depend on non-free dependencies (especially plugins) should almost always be split if feasible.</p>
</div>
<div class="sect1">
<h2 id="_16_1_global_default_options">16.1. Global default options</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Global default options are listed in <code>PKG_DEFAULT_OPTIONS</code>, which is a list of the options that should be built into every package if that option is supported. This variable should be set in <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_16_2_converting_packages_to_use_bsd_options_mk">16.2. Converting packages to use bsd.options.mk</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The following example shows how <code>bsd.options.mk</code> should be used by the hypothetical <code>wibble'' package, either in the package </code>Makefile<code>, or in a file, e.g. </code>options.mk<code>, that is included by the main package </code>Makefile``.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PKG_OPTIONS_VAR=                PKG_OPTIONS.wibble
PKG_SUPPORTED_OPTIONS=          wibble-foo ldap
PKG_OPTIONS_OPTIONAL_GROUPS=    database
PKG_OPTIONS_GROUP.database=     mysql pgsql
PKG_SUGGESTED_OPTIONS=          wibble-foo
PKG_OPTIONS_LEGACY_VARS+=       WIBBLE_USE_OPENLDAP:ldap
PKG_OPTIONS_LEGACY_OPTS+=       foo:wibble-foo
.include "../../mk/bsd.prefs.mk"
# this package was previously named wibble2
.if defined(PKG_OPTIONS.wibble2)
PKG_LEGACY_OPTIONS+=            ${PKG_OPTIONS.wibble2}
PKG_OPTIONS_DEPRECATED_WARNINGS+= \
        "Deprecated variable PKG_OPTIONS.wibble2 used, use ${PKG_OPTIONS_VAR} instead."
.endif
.include "../../mk/bsd.options.mk"
# Package-specific option-handling
###
### FOO support
###
.if !empty(PKG_OPTIONS:Mwibble-foo)
CONFIGURE_ARGS+=    --enable-foo
.endif
###
### LDAP support
###
.if !empty(PKG_OPTIONS:Mldap)
.  include "../../databases/openldap-client/buildlink3.mk"
CONFIGURE_ARGS+=    --enable-ldap=${BUILDLINK_PREFIX.openldap-client}
.endif
###
### database support
###
.if !empty(PKG_OPTIONS:Mmysql)
.  include "../../mk/mysql.buildlink3.mk"
.endif
.if !empty(PKG_OPTIONS:Mpgsql)
.  include "../../mk/pgsql.buildlink3.mk"
.endif</pre>
</div>
</div>
<div class="paragraph">
<p>The first section contains the information about which build options are supported by the package, and any default options settings if needed.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><code>PKG_OPTIONS_VAR</code> is the name of the <a href="https://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> variable that the user can set to override the default options. It should be set to PKG_OPTIONS.<em><code>pkgbase</code></em>. Do not set it to PKG_OPTIONS.${PKGBASE}, since <code>PKGBASE</code> is not defined at the point where the options are processed.</p>
</li>
<li>
<p><code>PKG_SUPPORTED_OPTIONS</code> is a list of build options supported by the package.</p>
</li>
<li>
<p><code>PKG_OPTIONS_OPTIONAL_GROUPS</code> is a list of names of groups of mutually exclusive options. The options in each group are listed in <code>PKG_OPTIONS_GROUP.<em>groupname</code></em>. The most specific setting of any option from the group takes precedence over all other options in the group. Options from the groups will be automatically added to <code>PKG_SUPPORTED_OPTIONS</code>.</p>
</li>
<li>
<p><code>PKG_OPTIONS_REQUIRED_GROUPS</code> is like <code>PKG_OPTIONS_OPTIONAL_GROUPS</code>, but building the packages will fail if no option from the group is selected.</p>
</li>
<li>
<p><code>PKG_OPTIONS_NONEMPTY_SETS</code> is a list of names of sets of options.  At least one option from each set must be selected. The options in each set are listed in <code>PKG_OPTIONS_SET.<em>setname</code></em>. Options from the sets will be automatically added to <code>PKG_SUPPORTED_OPTIONS</code>. Building the package will fail if no option from the set is selected.</p>
</li>
<li>
<p><code>PKG_SUGGESTED_OPTIONS</code> is a list of build options which are enabled by default.</p>
</li>
<li>
<p><code>PKG_OPTIONS_LEGACY_VARS</code> is a list of “<em><code>USE_VARIABLE</code></em>:<em><code>option</code></em>” pairs that map legacy <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> variables to their option counterparts. Pairs should be added with “+=” to keep the listing of global legacy variables. A warning will be issued if the user uses a legacy variable.</p>
</li>
<li>
<p><code>PKG_OPTIONS_LEGACY_OPTS</code> is a list of
“<em><code>old-option</code></em>:<em><code>new-option</code></em>” pairs that map options that have been renamed to their new counterparts. Pairs should be added with “+=” to keep the listing of global legacy options. A warning will be issued if the user uses a legacy option.</p>
</li>
<li>
<p><code>PKG_LEGACY_OPTIONS</code> is a list of options implied by deprecated variables used. This can be used for cases that neither <code>PKG_OPTIONS_LEGACY_VARS</code> nor <code>PKG_OPTIONS_LEGACY_OPTS</code> can handle, e. g. when <code>PKG_OPTIONS_VAR</code> is renamed.</p>
</li>
<li>
<p><code>PKG_OPTIONS_DEPRECATED_WARNINGS</code> is a list of warnings about deprecated variables or options used, and what to use instead.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>A package should never modify <code>PKG_DEFAULT_OPTIONS</code> or the variable named in <code>PKG_OPTIONS_VAR</code>.  These are strictly user-settable. To suggest a default set of options, use <code>PKG_SUGGESTED_OPTIONS</code>.</p>
</div>
<div class="paragraph">
<p><code>PKG_OPTIONS_VAR</code> must be defined before including <code>bsd.options.mk</code>. If none of <code>PKG_SUPPORTED_OPTIONS</code>, <code>PKG_OPTIONS_OPTIONAL_GROUPS</code>, and <code>PKG_OPTIONS_REQUIRED_GROUPS</code> are defined (as can happen with platform-specific options if none of them is supported on the current platform), <code>PKG_OPTIONS</code> is set to the empty list and the package is otherwise treated as not using the options framework.</p>
</div>
<div class="paragraph">
<p>After the inclusion of <code>bsd.options.mk</code>, the variable <code>PKG_OPTIONS</code> contains the list of selected build options, properly filtered to remove unsupported and duplicate options.</p>
</div>
<div class="paragraph">
<p>The remaining sections contain the logic that is specific to each option. The correct way to check for an option is to check whether it is listed in <code>PKG_OPTIONS</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.if !empty(PKG_OPTIONS:Moption)</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_16_3_option_names">16.3. Option Names</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Options that enable similar features in different packages (like optional support for a library) should use a common name in all packages that support it (like the name of the library). If another package already has an option with the same meaning, use the same name.</p>
</div>
<div class="paragraph">
<p>Options that enable features specific to one package, where it&#8217;s unlikely that another (unrelated) package has the same (or a similar) optional feature, should use a name prefixed with <code><em>pkgname</code></em>-.</p>
</div>
<div class="paragraph">
<p>If a group of related packages share an optional feature specific to that group, prefix it with the name of the “main” package (e. g. <code>djbware-errno-hack</code>).</p>
</div>
<div class="paragraph">
<p>For new options, add a line to <code>mk/defaults/options.description</code>. Lines have two fields, separated by tab. The first field is the option name, the second its description. The description should be a whole sentence (starting with an uppercase letter and ending with a period) that describes what enabling the option does.  E. g. “Enable ispell support.” The file is sorted by option names.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_16_4_determining_the_options_of_dependencies">16.4. Determining the options of dependencies</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When writing <a href="https://www.netbsd.org/docs/pkgsrc/buildlink.html#buildlink3.mk"><code>buildlink3.mk</code></a> files, it is often necessary to list different dependencies based on the options with which the package was built.For querying these options, the file <code>pkgsrc/mk/pkg-build-options.mk</code> should be used. A typical example looks like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>pkgbase := libpurple
.include "../../mk/pkg-build-options.mk"
.if !empty(PKG_BUILD_OPTIONS.libpurple:Mdbus)
...
.endif</pre>
</div>
</div>
<div class="paragraph">
<p>Including <code>pkg-build-options.mk</code> here will set the variable <code>PKG_BUILD_OPTIONS.libpurple</code> to the build options of the libpurple package, which can then be queried like <code>PKG_OPTIONS</code> in the <code>options.mk</code> file. See the file <code>pkg-build-options.mk</code> for more details.</p>
</div>
<div class="paragraph">
<div class="title">Next</div>
<p>Chapter 17. Tools needed for building or running <a href="chapter-17.html">chapter-17.html</a></p>
</div>
<div class="paragraph">
<div class="title">Previous</div>
<p>Chapter 15. Programming in Makefiles <a href="chapter-15.html">chapter-15.html</a></p>
</div>
</div>
</div>
<h1 id="_chapter_17_tools_needed_for_building_or_running" class="sect0">Chapter 17. Tools needed for building or running</h1>
<div class="paragraph">
<p>The <code>USE_TOOLS</code> definition is used both internally by pkgsrc and also for individual packages to define what commands are needed for building a package (like <code>TOOL_DEPENDS</code>) or for later run-time of an installed packaged (such as <code>DEPENDS</code>). If the native system provides an adequate tool, then in many cases, a pkgsrc package will not be used.</p>
</div>
<div class="paragraph">
<p>When building a package, the replacement tools are made available in a directory (as symlinks or wrapper scripts) that is early in the executable search path. Just like the buildlink system, this helps with consistent builds.</p>
</div>
<div class="paragraph">
<p>A tool may be needed to help build a specific package. For example, perl, GNU make (gmake) or yacc may be needed.</p>
</div>
<div class="paragraph">
<p>Also a tool may be needed, for example, because the native system&#8217;s supplied tool may be inefficient for building a package with pkgsrc. For example, a package may need GNU awk, bison (instead of yacc) or a better sed.</p>
</div>
<div class="paragraph">
<p>The tools used by a package can be listed by running <strong>make show-tools</strong>.</p>
</div>
<div class="sect1">
<h2 id="_17_1_tools_for_pkgsrc_builds">17.1. Tools for pkgsrc builds</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The default set of tools used by pkgsrc is defined in <code>bsd.pkg.mk</code>. This includes standard Unix tools, such as: <strong>cat</strong>, <strong>awk</strong>, <strong>chmod</strong>, <strong>test</strong>, and so on. These can be seen by running: <strong>make show-var VARNAME=USE_TOOLS</strong>.</p>
</div>
<div class="paragraph">
<p>If a package needs a specific program to build then the <code>USE_TOOLS</code> variable can be used to define the tools needed.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_17_2_tools_needed_by_packages">17.2. Tools needed by packages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In the following examples, the :run means that it is needed at run-time (and becomes a DEPENDS). The default is a build dependency which can be set with :build. (So in this example, it is the same as gmake:build and pkg-config:build.)</p>
</div>
<div class="literalblock">
<div class="content">
<pre>USE_TOOLS+=     gmake perl:run pkg-config</pre>
</div>
</div>
<div class="paragraph">
<p>When using the tools framework, a <code>TOOLS_PATH.foo</code> variable is defined which contains the full path to the appropriate tool. For example, <code>TOOLS_PATH.bash</code> could be “/bin/bash” on Linux systems.</p>
</div>
<div class="paragraph">
<p>If you always need a pkgsrc version of the tool at run-time, then just use <code>DEPENDS</code> instead.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_17_3_tools_provided_by_platforms">17.3. Tools provided by platforms</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When improving or porting pkgsrc to a new platform, have a look at (or create) the corresponding platform specific make file fragment under <code>pkgsrc/mk/tools/tools.${OPSYS}.mk</code> which defines the name of the common tools. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.if exists(/usr/bin/bzcat)
TOOLS_PLATFORM.bzcat?=          /usr/bin/bzcat
.elif exists(/usr/bin/bzip2)
TOOLS_PLATFORM.bzcat?=          /usr/bin/bzip2 -cd
.endif
TOOLS_PLATFORM.true?=           true                    # shell builtin</pre>
</div>
</div>
<div class="paragraph">
<div class="title">Next</div>
<p>Chapter 18. Buildlink methodology <a href="chapter-18.html">chapter-18.html</a></p>
</div>
<div class="paragraph">
<div class="title">Previous</div>
<p>Chapter 16. Options handling <a href="chapter-16.html">chapter-16.html</a></p>
</div>
</div>
</div>
<h1 id="_chapter_18_buildlink_methodology" class="sect0">Chapter 18. Buildlink methodology</h1>
<div class="paragraph">
<p>Buildlink is a framework in pkgsrc that controls what headers and libraries are seen by a package&#8217;s configure and build processes. This is implemented in a two step process:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Symlink headers and libraries for dependencies into <code>BUILDLINK_DIR</code>, which by default is a subdirectory of <code>WRKDIR</code>.</p>
</li>
<li>
<p>Create wrapper scripts that are used in place of the normal compiler tools that translate <code>-I${LOCALBASE}/include</code> and <code>-L${LOCALBASE}/lib</code> into references to <code>BUILDLINK_DIR</code>. The wrapper scripts also make native compiler on some operating systems look like GCC, so that packages that expect GCC won&#8217;t require modifications to build with those native compilers.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>This normalizes the environment in which a package is built so that the package may be built consistently despite what other software may be installed. Please note that the normal system header and library paths, e.g. <code>/usr/include</code>, <code>/usr/lib</code>, etc., are always searched&#8201;&#8212;&#8201;buildlink3 is designed to insulate the package build from non-system-supplied software.</p>
</div>
<div class="sect1">
<h2 id="_18_1_converting_packages_to_use_buildlink3">18.1. Converting packages to use buildlink3</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The process of converting packages to use the buildlink3 framework (“bl3ifying”) is fairly straightforward. The things to keep in mind are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Ensure that the build always calls the wrapper scripts instead of the actual toolchain. Some packages are tricky, and the only way to know for sure is the check <code>${WRKDIR}/.work.log</code> to see if the	wrappers are being invoked.</p>
</li>
<li>
<p>Don&#8217;t override <code>PREFIX</code> from within the package Makefile, e.g. Java VMs, standalone shells, etc., because the code to symlink files into <code>${BUILDLINK_DIR}</code> looks for files relative to “pkg_info -qp <em><code>pkgname</code></em>”.</p>
</li>
<li>
<p>Remember that <em>only</em> the <code>buildlink3.mk</code> files that you list in a package&#8217;s Makefile are added as dependencies for that package.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If a dependency on a particular package is required for its libraries and headers, then we replace:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DEPENDS+=       foo&gt;=1.1.0:../../category/foo</pre>
</div>
</div>
<div class="paragraph">
<p>with</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.include "../../category/foo/buildlink3.mk"</pre>
</div>
</div>
<div class="paragraph">
<p>The buildlink3.mk files usually define the required dependencies. If you need a newer version of the dependency when using buildlink3.mk files, then you can define it in your Makefile; for example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>BUILDLINK_API_DEPENDS.foo+=   foo&gt;=1.1.0
.include "../../category/foo/buildlink3.mk"</pre>
</div>
</div>
<div class="paragraph">
<p>There are several <code>buildlink3.mk</code> files in <code>pkgsrc/mk</code> that handle special package issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>bdb.buildlink3.mk</code> chooses either the native or a pkgsrc Berkeley DB implementation based on	the values of <code>BDB_ACCEPTED</code> and <code>BDB_DEFAULT</code>.</p>
</li>
<li>
<p><code>curses.buildlink3.mk</code>: If the system comes with neither Curses nor NCurses, this will take care to install the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/devel/ncurses/index.html"><code>devel/ncurses</code></a> package.</p>
</li>
<li>
<p><code>krb5.buildlink3.mk</code> uses the value of <code>KRB5_ACCEPTED</code> to choose between adding a dependency on Heimdal or MIT-krb5 for packages that require a Kerberos 5 implementation.</p>
</li>
<li>
<p><code>motif.buildlink3.mk</code> checks for a system-provided Motif installation or adds a dependency on <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/x11/lesstif/index.html"><code>x11/lesstif</code></a> or <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/x11/motif/index.html"><code>x11/motif</code></a>. The user can set <code>MOTIF_TYPE</code> to “dt”, “lesstif” or “motif” to choose which Motif version will be used.</p>
</li>
<li>
<p><code>readline.buildlink3.mk</code> checks for a system-provided GNU readline or editline (libedit) installation, or adds a dependency on <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/devel/readline/index.html"><code>devel/readline</code></a>, <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/devel/editline/index.html"><code>devel/editline</code></a>. The user can set <code>READLINE_DEFAULT</code> to choose readline implementation. If your package really needs GNU readline library, its Makefile should include <code>devel/readline/buildlink3.mk</code> instead of <code>readline.buildlink3.mk</code>.</p>
</li>
<li>
<p><code>oss.buildlink3.mk</code> defines several variables that may be used by packages that use the Open Sound System (OSS) API.</p>
</li>
<li>
<p><code>pgsql.buildlink3.mk</code> will accept any of the Postgres versions in the variable <code>PGSQL_VERSIONS_ACCEPTED</code> and default to	the version <code>PGSQL_VERSION_DEFAULT</code>. See the file for more information.</p>
</li>
<li>
<p><code>pthread.buildlink3.mk</code> uses the value of <code>PTHREAD_OPTS</code> and checks for native pthreads or adds	a dependency on <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/devel/pth/index.html"><code>devel/pth</code></a> as needed.</p>
</li>
<li>
<p><code>xaw.buildlink3.mk</code> uses the value of <code>XAW_TYPE</code> to choose a particular Athena widgets library.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The comments in those <code>buildlink3.mk</code> files provide a more complete description of how to use them properly.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_18_2_writing_buildlink3_mk_files">18.2. Writing buildlink3.mk files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A package&#8217;s <code>buildlink3.mk</code> file is included by Makefiles to indicate the need to compile and link against header files and libraries provided by the package. A <code>buildlink3.mk</code> file should always provide enough information to add the correct type of dependency relationship and include any other <code>buildlink3.mk</code> files that it needs to find headers and libraries that it needs in turn.</p>
</div>
<div class="paragraph">
<p>To generate an initial <code>buildlink3.mk</code> file for further editing, Rene Hexel&#8217;s <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/createbuildlink/index.html"><code>pkgtools/createbuildlink</code></a> package is highly recommended. For most packages, the following command will generate a good starting point for <code>buildlink3.mk</code> files:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% cd pkgsrc/category/pkgdir
% createbuildlink &gt;buildlink3.mk</pre>
</div>
</div>
<div class="sect2">
<h3 id="_18_2_1_anatomy_of_a_buildlink3_mk_file">18.2.1. Anatomy of a buildlink3.mk file</h3>
<div class="paragraph">
<p>The following real-life example <code>buildlink3.mk</code> is taken from <code>pkgsrc/graphics/tiff</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># $NetBSD: buildlink.html,v 1.224 2022/05/21 15:41:36 nia Exp $
BUILDLINK_TREE+=        tiff
.if !defined(TIFF_BUILDLINK3_MK)
TIFF_BUILDLINK3_MK:=
BUILDLINK_API_DEPENDS.tiff+=    tiff&gt;=3.6.1
BUILDLINK_ABI_DEPENDS.tiff+=    tiff&gt;=3.7.2nb1
BUILDLINK_PKGSRCDIR.tiff?=      ../../graphics/tiff
.include "../../devel/zlib/buildlink3.mk"
.include "../../graphics/jpeg/buildlink3.mk"
.endif # TIFF_BUILDLINK3_MK
BUILDLINK_TREE+=        -tiff</pre>
</div>
</div>
<div class="paragraph">
<p>The header and footer manipulate <code>BUILDLINK_TREE</code>, which is common across all <code>buildlink3.mk</code> files and is used to track the dependency tree.</p>
</div>
<div class="paragraph">
<p>The main section is protected from multiple inclusion and controls how the dependency on <em><code>pkg</code></em> is added. Several important variables are set in the section:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BUILDLINK_API_DEPENDS.<em>pkg</code></em> is the dependency version recorded in the installed package; this should always be set using <strong>+=</strong> to ensure that we&#8217;re appending to any pre-existing list of values. This variable should be set to the last version of the package that had an backwards-incompatible API change.</p>
</li>
<li>
<p><code>BUILDLINK_PKGSRCDIR.<em>pkg</code></em> is the location of the <em><code>pkg</code></em> pkgsrc directory.</p>
</li>
<li>
<p><code>BUILDLINK_DEPMETHOD.<em>pkg</code></em> (not shown above) controls whether we use <code>BUILD_DEPENDS</code> or <code>DEPENDS</code> to add the dependency on <em><code>pkg</code></em>.  The build dependency is selected by setting <code>BUILDLINK_DEPMETHOD.<em>pkg</code></em> to “build”. By default, the full dependency is used.</p>
</li>
<li>
<p><code>BUILDLINK_INCDIRS.<em>pkg</code></em> and <code>BUILDLINK_LIBDIRS.<em>pkg</code></em> (not shown above) are lists of subdirectories of <code>${BUILDLINK_PREFIX.<em>pkg</code></em>} to add to the header and library search paths. These default to “include” and “lib” respectively.</p>
</li>
<li>
<p><code>BUILDLINK_CPPFLAGS.<em>pkg</code></em> (not shown above) is the list of preprocessor flags to add to <code>CPPFLAGS</code>, which are passed on to the configure and build phases. The “-I” option should be avoided and instead be handled using <code>BUILDLINK_INCDIRS.<em>pkg</code></em> as above.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following variables are all optionally defined within this second section (protected against multiple inclusion) and control which package files are symlinked into <code>${BUILDLINK_DIR}</code> and how their names are transformed during the symlinking:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>BUILDLINK_FILES.<em>pkg</code></em> (not shown above) is a shell glob pattern relative to <code>${BUILDLINK_PREFIX.<em>pkg</code></em>} to be symlinked into <code>${BUILDLINK_DIR}</code>, e.g. <code>include/*.h</code>.</p>
</li>
<li>
<p><code>BUILDLINK_FILES_CMD.<em>pkg</code></em> (not shown above) is a shell pipeline that outputs to stdout a list of files relative to <code>${BUILDLINK_PREFIX.<em>pkg</code></em>}. The resulting files are to be symlinked into <code>${BUILDLINK_DIR}</code>. By default, this takes the <code>+CONTENTS</code> of a <em><code>pkg</code></em> and filters it through <code>${BUILDLINK_CONTENTS_FILTER.<em>pkg</code></em>}.</p>
</li>
<li>
<p><code>BUILDLINK_CONTENTS_FILTER.<em>pkg</code></em> (not shown above) is a filter command that filters <code>+CONTENTS</code> input into a list of files relative to <code>${BUILDLINK_PREFIX.<em>pkg</code></em>} on stdout. By default, <code>BUILDLINK_CONTENTS_FILTER.<em>pkg</code></em> outputs the contents of the <code>include</code> and <code>lib</code> directories in the package <code>+CONTENTS</code>.</p>
</li>
<li>
<p><code>BUILDLINK_FNAME_TRANSFORM.<em>pkg</code></em> (not shown above) is a list of sed arguments used to transform the name of the source filename into a destination filename, e.g. <strong>-e "s|/curses.h|/ncurses.h|g"</strong>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This section can additionally include any <code>buildlink3.mk</code> needed for <em><code>pkg</code></em>'s library dependencies. Including these <code>buildlink3.mk</code> files means that the headers and libraries for these dependencies are also symlinked into <code>${BUILDLINK_DIR}</code> whenever the <em><code>pkg</code></em> <code>buildlink3.mk</code> file is included. Dependencies are only added for directly include <code>buildlink3.mk</code> files.</p>
</div>
<div class="paragraph">
<p>When providing a <code>buildlink3.mk</code> and including other <code>buildlink3.mk</code> files in it, please only add necessary ones, i.e., those whose libraries or header files are automatically exposed when the package is use.</p>
</div>
<div class="paragraph">
<p>In particular, if only an executable (<code>bin/foo</code>) is linked against a library, that library does not need to be propagated in the <code>buildlink3.mk</code> file.</p>
</div>
<div class="paragraph">
<p>The following steps should help you decide if a <code>buildlink3.mk</code> file needs to be included:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Look at the installed header files: What headers do they include? The packages providing these files must be buildlinked.</p>
</li>
<li>
<p>Run <code>ldd</code> on all installed libraries and look against what other libraries they link. Some of the packages providing these probably need to be buildlinked; however, it&#8217;s not automatic, since e.g. GTK on some systems pulls in the X libraries, so they will show up in the <code>ldd</code> output, while on others (like OS X) it won&#8217;t. <code>ldd</code> output can thus only be	used as a hint.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_18_2_2_updating_buildlink_api_depends_pkg_and_buildlink_abi_depends_pkg_in_buildlink3_mk_files">18.2.2. Updating BUILDLINK_API_DEPENDS.pkg and BUILDLINK_ABI_DEPENDS.pkg in buildlink3.mk files</h3>
<div class="paragraph">
<p>Both variables set lower bounds for a version of this package. The two variables differ in that one describes source compatibility (API) and the other binary compatibility (ABI). The difference is that a change in the API breaks compilation of programs while changes in the ABI stop compiled programs from running.</p>
</div>
<div class="paragraph">
<p>The <code>BUILDLINK_API_DEPENDS.<em>pkg</code></em> variable in a <code>buildlink3.mk</code> should be changed very rarely. (One possible scenario: If all packages using this package need a higher version than defined in the <code>buildlink3.mk</code>, <code>BUILDLINK_API_DEPENDS.<em>pkg</code></em> could be updated to that higher version.)</p>
</div>
<div class="paragraph">
<p>On the other hand, changes to <code>BUILDLINK_ABI_DEPENDS.<em>pkg</code></em> are more common. The variable will need to be updated every time the major version of one of its shared libraries is changed, or any other change where a binary built against the previous version of the package will not run against the new version any longer.</p>
</div>
<div class="paragraph">
<p>In such a case, the package&#8217;s <code>BUILDLINK_ABI_DEPENDS.<em>pkg</code></em> must be increased to require the new package version. Then the <code>PKGREVISION</code> of all packages <em><code>foo</code></em> that depend on this package need to be increased, and if they have <code>buildlink3.mk</code> files, <code>BUILDLINK_ABI_DEPENDS.<em>foo</code></em> in their <code>buildlink3.mk</code> files must be increased to the new version as well. This is required so that a package will pull in the versions of the packages that use the new ABI and that the packages' <code>PKGREVISION</code>s uniquely identify the packages built against the new ABI. The <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/revbump/index.html"><code>pkgtools/revbump</code></a> package can help with these updates.</p>
</div>
<div class="paragraph">
<p>See <a href="https://www.netbsd.org/docs/pkgsrc/fixes.html#dependencies">Section 21.1.5, “Handling dependencies”</a> for more information about dependencies on other packages, including the <code>BUILDLINK_API_DEPENDS</code> definitions.</p>
</div>
<div class="paragraph">
<p>Please take careful consideration before adjusting <code>BUILDLINK_API_DEPENDS.<em>pkg</code></em> or <code>BUILDLINK_ABI_DEPENDS.<em>pkg</code></em> in a <code>buildlink3.mk</code> file as we don&#8217;t want to cause unneeded package deletions and rebuilds. In many cases, new versions of packages work just fine with older dependencies.</p>
</div>
<div class="paragraph">
<p>Also, it is not needed to set <code>BUILDLINK_ABI_DEPENDS.<em>pkg</code></em> when it is identical to <code>BUILDLINK_API_DEPENDS.<em>pkg</code></em>.</p>
</div>
<div class="paragraph">
<p>Note there is also the distinction that users are able to disable enforcement of ABI dependencies using the <code>USE_ABI_DEPENDS</code> variable, but there is no equivalent option for API dependencies.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_18_3_writing_builtin_mk_files">18.3. Writing builtin.mk files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some packages in pkgsrc install headers and libraries that coincide with headers and libraries present in the base system. Aside from a <code>buildlink3.mk</code> file, these packages should also include a <code>builtin.mk</code> file that includes the necessary checks to decide whether using the built-in software or the pkgsrc software is appropriate.</p>
</div>
<div class="paragraph">
<p>The only requirements of a builtin.mk file for <em><code>pkg</code></em> are:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>It should set <code>USE_BUILTIN.<em>pkg</code></em> to either “yes” or “no” after it is included.</p>
</li>
<li>
<p>It should <em>not</em> override any <code>USE_BUILTIN.<em>pkg</code></em> which is already set before the <code>builtin.mk</code> file is included.</p>
</li>
<li>
<p>It should be written to allow multiple inclusion. This is <em>very</em> important and takes careful attention to <code>Makefile</code> coding.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_18_3_1_anatomy_of_a_builtin_mk_file">18.3.1. Anatomy of a builtin.mk file</h3>
<div class="paragraph">
<p>The following is the recommended template for builtin.mk files:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.if !defined(IS_BUILTIN.foo)
#
# IS_BUILTIN.foo is set to "yes" or "no" depending on whether "foo"
# genuinely exists in the system or not.
#
IS_BUILTIN.foo?=        no
# BUILTIN_PKG.foo should be set here if "foo" is built-in and its package
# version can be determined.
#
.  if !empty(IS_BUILTIN.foo:M[yY][eE][sS])
BUILTIN_PKG.foo?=       foo-1.0
.  endif
.endif  # IS_BUILTIN.foo
.if !defined(USE_BUILTIN.foo)
USE_BUILTIN.foo?=       ${IS_BUILTIN.foo}
.  if defined(BUILTIN_PKG.foo)
.    for _depend_ in ${BUILDLINK_API_DEPENDS.foo}
.      if !empty(USE_BUILTIN.foo:M[yY][eE][sS])
USE_BUILTIN.foo!=                                                           \
    ${PKG_ADMIN} pmatch '${_depend_}' ${BUILTIN_PKG.foo}            \
    &amp;&amp; ${ECHO} "yes" || ${ECHO} "no"
.      endif
.    endfor
.  endif
.endif  # USE_BUILTIN.foo
CHECK_BUILTIN.foo?=     no
.if !empty(CHECK_BUILTIN.foo:M[nN][oO])
#
# Here we place code that depends on whether USE_BUILTIN.foo is set to
# "yes" or "no".
#
.endif  # CHECK_BUILTIN.foo</pre>
</div>
</div>
<div class="paragraph">
<p>The first section sets <code>IS_BUILTIN.<em>pkg</code></em> depending on if <em><code>pkg</code></em> really exists in the base system. This should not be a base system software with similar functionality to <em><code>pkg</code></em>; it should only be “yes” if the actual package is included as part of the base system. This variable is only used internally within the <code>builtin.mk</code> file.</p>
</div>
<div class="paragraph">
<p>The second section sets <code>BUILTIN_PKG.<em>pkg</code></em> to the version of <em><code>pkg</code></em> in the base system if it exists (if <code>IS_BUILTIN.<em>pkg</code></em> is “yes”). This variable is only used internally within the <code>builtin.mk</code> file.</p>
</div>
<div class="paragraph">
<p>The third section sets <code>USE_BUILTIN.<em>pkg</code></em> and is <em>required</em> in all <code>builtin.mk</code> files. The code in this section must make the determination whether the built-in software is adequate to satisfy the dependencies listed in <code>BUILDLINK_API_DEPENDS.<em>pkg</code></em>. This is typically done by comparing <code>BUILTIN_PKG.<em>pkg</code></em> against each of the dependencies in <code>BUILDLINK_API_DEPENDS.<em>pkg</code></em>. <code>USE_BUILTIN.<em>pkg</code></em> <em>must</em> be set to the correct value by the end of the <code>builtin.mk</code> file. Note that<code>USE_BUILTIN.<em>pkg</code></em> may be “yes” even if <code>IS_BUILTIN.<em>pkg</code></em> is “no” because we may make the determination that the built-in version of the software is similar enough to be used as a replacement.</p>
</div>
<div class="paragraph">
<p>The last section is guarded by <code>CHECK_BUILTIN.<em>pkg</code></em>, and includes code that uses the value of <code>USE_BUILTIN.<em>pkg</code></em> set in the previous section. This typically includes, e.g., adding additional dependency restrictions and listing additional files to symlink into <code>${BUILDLINK_DIR}</code> (via <code>BUILDLINK_FILES.<em>pkg</code></em>).</p>
</div>
</div>
<div class="sect2">
<h3 id="_18_3_2_global_preferences_for_native_or_pkgsrc_software">18.3.2. Global preferences for native or pkgsrc software</h3>
<div class="paragraph">
<p>When building packages, it&#8217;s possible to choose whether to set a global preference for using either the built-in (native) version or the pkgsrc version of software to satisfy a dependency. This is controlled by setting <code>PREFER_PKGSRC</code> and <code>PREFER_NATIVE</code>. These variables take values of either “yes”, “no”, or a list of packages. <code>PREFER_PKGSRC</code> tells pkgsrc to use the pkgsrc versions of software, while <code>PREFER_NATIVE</code> tells pkgsrc to use the built-in versions. Preferences are determined by the most specific instance of the package in either <code>PREFER_PKGSRC</code> or <code>PREFER_NATIVE</code>. If a package is specified in neither or in both variables, then <code>PREFER_PKGSRC</code> has precedence over <code>PREFER_NATIVE</code>. For example, to require using pkgsrc versions of software for all but the most basic bits on a NetBSD system, you can set:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PREFER_PKGSRC=  yes
PREFER_NATIVE=  getopt skey tcp_wrappers</pre>
</div>
</div>
<div class="paragraph">
<p>A package <em>must</em> have a <code>builtin.mk</code> file to be listed in <code>PREFER_NATIVE</code>, otherwise it is simply ignored in that list.</p>
</div>
<div class="paragraph">
<p><code>PREFER_PKGSRC</code> and <code>PREFER_NATIVE</code> should be set during bootstrap  to ensure that the bootstrap process does not use inapropriate native tools as dependencies for core packages.</p>
</div>
<div class="literalblock">
<div class="content">
<pre># ./bootstrap --prefer-pkgsrc yes --prefer-native openssl</pre>
</div>
</div>
<div class="paragraph">
<p>Switching between settings globally at a later date can introduce complications with dependency resolution. This is caused by packages built with the opposite preference being installed alongside each other. Hence, any changes to these variables after bootstrap will necessitate rebuilding all packages depending on one whose preference has been changed. This is not trivial and should be avoided.</p>
</div>
<div class="paragraph">
<p>When using pkgsrc on Linux systems, there is high risk of "leakage", where programs installed by pkgsrc may inadvertently use a command or library not installed by pkgsrc, e.g. those installed by yum or apt. Such foreign dependencies may be installed, removed, or upgraded to a version incompatible with the pkgsrc package at any time, causing pkgsrc packages to subsequently malfunction. Pkgsrc cannot prevent this, as it has no control over other package managers. Another potential problem is that under Redhat Enterprise and related Linux systems, yum packages are only patched and never upgraded, so eventually they may become too outdated for use by pkgsrc. Even intentionally using foreign dependencies, not considered leakage, can lead to these problems, so it is generally discouraged. In order to minimize such problems, PREFER_PKGSRC defaults to "yes" on Linux systems. This ensures that pkgsrc is aware of any changes to dependency packages and can rebuild or upgrade the entire dependency tree as needed. This default can be overridden by setting --prefer-pkgsrc to "no" or a list of packages, or by setting --prefer-native to "yes".</p>
</div>
<div class="paragraph">
<div class="title">Next</div>
<p>Chapter 19. PLIST issues <a href="chapter-19.html">chapter-19.html</a></p>
</div>
<div class="paragraph">
<div class="title">Previous</div>
<p>Chapter 17. Tools needed for building or running <a href="chapter-17.html">chapter-17.html</a></p>
</div>
</div>
</div>
</div>
<h1 id="_chapter_19_plist_issues" class="sect0">Chapter 19. PLIST issues</h1>
<div class="paragraph">
<p>The <code>PLIST</code> file contains a package&#8217;s “packing list”, i.e. a list of files that belong to the package (relative to the <code>${PREFIX}</code> directory it&#8217;s been installed in) plus some additional statements - see the <a href="https://man.NetBSD.org/NetBSD-9.2/i386/pkg_create.1">pkg_create(1)</a> man page for a full list. This chapter addresses some issues that need attention when dealing with the <code>PLIST</code> file (or files, see below!).</p>
</div>
<div class="sect1">
<h2 id="_19_1_rcs_id">19.1. RCS ID</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Be sure to add a RCS ID line as the first thing in any PLIST file you write:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>@comment $NetBSD $</pre>
</div>
</div>
<div class="paragraph">
<p>An artificial space has been added between NetBSD and $, this is a workaround here to prevent CVS expanding to the filename of the guide. When adding the RCS ID the space should be omitted.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_19_2_semi_automatic_plist_generation">19.2. Semi-automatic PLIST generation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can use the <strong>make print-PLIST</strong> command to output a PLIST that matches any new files since the package was extracted. See <a href="https://www.netbsd.org/docs/pkgsrc/build.html#build.helpful-targets">Section 13.17, “Other helpful targets”</a> for more information on this target.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_19_3_tweaking_output_of_make_print_plist">19.3. Tweaking output of make print-PLIST</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>PRINT_PLIST_AWK</code> variable takes a set of AWK patterns and actions that are used to filter the output of print-PLIST. You can <em>append</em> any chunk of AWK scripting you like to it, but be careful with quoting.</p>
</div>
<div class="paragraph">
<p>For example, to get all files inside the <code>libdata/foo</code> directory removed from the resulting PLIST:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PRINT_PLIST_AWK+=       /^libdata\/foo/ { next; }</pre>
</div>
</div>
<div class="paragraph">
<p>The <code>PRINT_PLIST_AWK</code> transformations are evaluated after the file list and directory list are sorted. <code>EARLY_PRINT_PLIST_AWK</code> is like <code>PRINT_PLIST_AWK</code> except it operates before the file list and directory list are sorted.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_19_4_variable_substitution_in_plist">19.4. Variable substitution in PLIST</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A number of variables are substituted automatically in PLISTs when a package is installed on a system. This includes the following variables:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>${MACHINE_ARCH}</code>, <code>${MACHINE_GNU_ARCH}</code></dt>
<dd>
<p>Some packages like emacs and perl embed information about which architecture they were built on into the pathnames where they install their files. To handle this case, PLIST will be preprocessed before actually used, and the symbol “<code>${MACHINE_ARCH}</code>” will be replaced by what <strong>uname -p</strong> gives. The same is done if the string <code>${MACHINE_GNU_ARCH}</code> is embedded in PLIST somewhere - use this on packages that have GNU autoconf-created configure scripts.</p>
</dd>
</dl>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title"><strong>Legacy note</strong></div>
There used to be a symbol “<code>$ARCH</code>” that was replaced by the output of <strong>uname -m</strong>, but that&#8217;s no longer supported and has been removed.
</td>
</tr>
</table>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>${OPSYS}</code>, <code>${LOWER_OPSYS}</code>, <code>${OS_VERSION}</code></dt>
<dd>
<p>Some packages want to embed the OS name and version into some paths. To do this, use these variables in the  <code>PLIST</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code>${OPSYS}</code> - output of “<strong>uname -s</strong>”</p>
</li>
<li>
<p><code>${LOWER_OPSYS}</code> - lowercase common name (eg. “solaris”)</p>
</li>
<li>
<p><code>${OS_VERSION}</code> - “<strong>uname -r</strong>”</p>
</li>
</ul>
</div>
</dd>
</dl>
</div>
<div class="paragraph">
<p>For a list of values which are replaced by default, the output of <strong>make help topic=PLIST_SUBST</strong> as well as searching the <code>pkgsrc/mk</code> directory with <strong>grep</strong> for <code>PLIST_SUBST</code> should help.</p>
</div>
<div class="paragraph">
<p>If you want to change other variables not listed above, you can add variables and their expansions to this variable in the following way, similar to <code>MESSAGE_SUBST</code> (see <a href="https://www.netbsd.org/docs/pkgsrc/components.html#components.optional">Section 12.5, “Optional files”</a>):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PLIST_SUBST+=   SOMEVAR="somevalue"</pre>
</div>
</div>
<div class="paragraph">
<p>This replaces all occurrences of “${SOMEVAR}” in the <code>PLIST</code> with “somevalue”.</p>
</div>
<div class="paragraph">
<p>The <code>PLIST_VARS</code> variable can be used to simplify the common case of conditionally including some <code>PLIST</code> entries. It can be done by adding <code>PLIST_VARS</code>+=foo and setting the corresponding <code>PLIST.foo</code> variable to <code>yes</code> if the entry should be included. This will substitute “<code>${PLIST.foo}</code>” in the <code>PLIST</code> with either “<code>"&#8220;`” or “`&#8221;@comment"</code>”. For example, in <code>Makefile</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PLIST_VARS+=    foo
.if condition
PLIST.foo=      yes
.else</pre>
</div>
</div>
<div class="paragraph">
<p>And then in <code>PLIST</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>@comment $NetBSD $
bin/bar
man/man1/bar.1
${PLIST.foo}bin/foo
${PLIST.foo}man/man1/foo.1
${PLIST.foo}share/bar/foo.data</pre>
</div>
</div>
<div class="paragraph">
<p>An artificial space has been added between NetBSD and $, this is a workaround here to prevent CVS expanding to the filename of the guide. When adding the RCS ID the space should be omitted.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_19_5_man_page_compression">19.5. Man page compression</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Man pages should be installed in compressed form if <code>MANZ</code> is set (in <code>bsd.own.mk</code>), and uncompressed otherwise. To handle this in the <code>PLIST</code> file, the suffix “.gz” is appended/removed automatically for man pages according to <code>MANZ</code> and <code>MANCOMPRESSED</code> being set or not, see above for details. This modification of the <code>PLIST</code> file is done on a copy of it, not <code>PLIST</code> itself.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_19_6_changing_plist_source_with_plist_src">19.6. Changing PLIST source with PLIST_SRC</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To use one or more files as source for the <code>PLIST</code> used in generating the binary package, set the variable <code>PLIST_SRC</code> to the names of that file(s). The files are later concatenated using <a href="https://man.NetBSD.org/NetBSD-9.2/i386/cat.1">cat(1)</a>, and the order of things is important. The default for <code>PLIST_SRC</code> is <code>${PKGDIR}/PLIST</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_19_7_platform_specific_and_differing_plists">19.7. Platform-specific and differing PLISTs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some packages decide to install a different set of files based on the operating system being used. These differences can be automatically handled by using the following files:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PLIST.common</code></p>
</li>
<li>
<p><code>PLIST.${OPSYS}</code></p>
</li>
<li>
<p><code>PLIST.${MACHINE_ARCH}</code></p>
</li>
<li>
<p><code>PLIST.${OPSYS}-${MACHINE_ARCH}</code></p>
</li>
<li>
<p><code>PLIST.common_end</code></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_19_8_build_specific_plists">19.8. Build-specific PLISTs</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Some packages decide to generate hard-to-guess file names during installation that are hard to wire down.</p>
</div>
<div class="paragraph">
<p>In such cases, you can set the <code>GENERATE_PLIST</code> variable to shell code terminated (with a semicolon) that will output PLIST entries which will be appended to the PLIST</p>
</div>
<div class="paragraph">
<p>You can find one example in editors/xemacs:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GENERATE_PLIST+=        ${ECHO} bin/${DISTNAME}-`${WRKSRC}/src/xemacs -sd`.dmp ;</pre>
</div>
</div>
<div class="paragraph">
<p>which will append something like <code>bin/xemacs-21.4.23-54e8ea71.dmp</code> to the <code>PLIST</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_19_9_sharing_directories_between_packages">19.9. Sharing directories between packages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>A “shared directory” is a directory where multiple (and unrelated) packages install files. These directories were problematic because you had to add special tricks in the PLIST to conditionally remove them, or have some centralized package handle them.</p>
</div>
<div class="paragraph">
<p>In pkgsrc, it is now easy: Each package should create directories and install files as needed; <strong>pkg_delete</strong> will remove any directories left empty after uninstalling a package.</p>
</div>
<div class="paragraph">
<p>If a package needs an empty directory to work, create the directory during installation as usual, and also add an entry to the PLIST:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>@pkgdir path/to/empty/directory</pre>
</div>
</div>
<div class="paragraph">
<p>or take a look at <code>MAKE_DIRS</code> and <code>OWN_DIRS</code>.</p>
</div>
<div class="paragraph">
<div class="title">Next</div>
<p>Chapter 20. The pkginstall framework <a href="chapter-20.html">chapter-20.html</a></p>
</div>
<div class="paragraph">
<div class="title">Previous</div>
<p>Chapter 18. Buildlink methodology <a href="chapter-18.html">chapter-18.html</a></p>
</div>
</div>
</div>
<h1 id="_chapter_20_the_pkginstall_framework" class="sect0">Chapter 20. The pkginstall framework</h1>
<div class="paragraph">
<p>This chapter describes the framework known as <code>pkginstall</code>, whose key features are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Generic installation and manipulation of directories and files outside the pkgsrc-handled tree, <code>LOCALBASE</code>.</p>
</li>
<li>
<p>Automatic handling of configuration files during installation, provided that packages are correctly designed.</p>
</li>
<li>
<p>Generation and installation of system startup scripts.</p>
</li>
<li>
<p>Registration of system users and groups.</p>
</li>
<li>
<p>Registration of system shells.</p>
</li>
<li>
<p>Automatic updating of fonts databases.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The following sections inspect each of the above points in detail.</p>
</div>
<div class="paragraph">
<p>You may be thinking that many of the things described here could be easily done with simple code in the package&#8217;s post-installation target (<code>post-install</code>).  <em>This is incorrect</em>, as the code in them is only executed when building from source. Machines using binary packages could not benefit from it at all (as the code itself could be unavailable). Therefore, the only way to achieve any of the items described above is by means of the installation scripts, which are automatically generated by pkginstall.</p>
</div>
<div class="sect1">
<h2 id="_20_1_files_and_directories_outside_the_installation_prefix">20.1. Files and directories outside the installation prefix</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As you already know, the <code>PLIST</code> file holds a list of files and directories that belong to a package. The names used in it are relative to the installation prefix (<code>${PREFIX}</code>), which means that it cannot register files outside this directory (absolute path names are not allowed). Despite this restriction, some packages need to install files outside this location; e.g., under <code>${VARBASE}</code> or <code>${PKG_SYSCONFDIR}</code>. The only way to achieve this is to create such files during installation time by using installation scripts.</p>
</div>
<div class="paragraph">
<p>The generic installation scripts are shell scripts that can
contain arbitrary code.  The list of scripts to execute is taken from
the <code>INSTALL_FILE</code> variable, which defaults to
<code>INSTALL</code>.  A similar variable exists for package
removal (<code>DEINSTALL_FILE</code>, whose default is
<code>DEINSTALL</code>).  These scripts can run arbitrary
commands, so they have the potential to create and manage files
anywhere in the file system.</p>
</div>
<div class="paragraph">
<p>Using these general installation files is not recommended, but may be needed in some special cases. One reason for avoiding them is that the user has to trust the packager that there is no unwanted or simply erroneous code included in the installation script. Also, previously there were many similar scripts for the same functionality, and fixing a common error involved finding and changing all of them.</p>
</div>
<div class="paragraph">
<p>The pkginstall framework offers another, standardized way. It provides generic scripts to abstract the manipulation of such files and directories based on variables set in the package&#8217;s <code>Makefile</code>. The rest of this section describes these variables.</p>
</div>
<div class="sect2">
<h3 id="_20_1_1_directory_manipulation">20.1.1. Directory manipulation</h3>
<div class="paragraph">
<p>The following variables can be set to request the creation of directories anywhere in the file system:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>MAKE_DIRS</code> and <code>OWN_DIRS</code> contain a list of directories that should be created and should attempt to be destroyed by the installation scripts. The difference between the two is that the latter prompts the administrator to remove any directories that may be left after deinstallation (because they were not empty), while the former does not. Example:</p>
<div class="literalblock">
<div class="content">
<pre>MAKE_DIRS+=             ${VARBASE}/foo/private</pre>
</div>
</div>
</li>
<li>
<p><code>MAKE_DIRS_PERMS</code> and <code>OWN_DIRS_PERMS</code> contain a list of tuples describing which directories should be created and should attempt to be destroyed by the installation scripts. Each tuple holds the following values, separated by spaces: the directory name, its owner, its group and its numerical mode. For example:</p>
<div class="literalblock">
<div class="content">
<pre>MAKE_DIRS_PERMS+=       ${VARBASE}/foo/private \
                        ${REAL_ROOT_USER} ${REAL_ROOT_GROUP} 0700</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The difference between the two is exactly the same as their non-PERMS counterparts.</p>
</div>
</div>
<div class="sect2">
<h3 id="_20_1_2_file_manipulation">20.1.2. File manipulation</h3>
<div class="paragraph">
<p>Creating non-empty files outside the installation prefix is tricky because the <code>PLIST</code> forces all files to be inside it. To overcome this problem, the only solution is to extract the file in the known place (i.e., inside the installation prefix) and copy it to the appropriate location during installation (done by the installation scripts generated by pkginstall). We will call the former the <em>master file</em> in the following paragraphs, which describe the variables that can be used to automatically and consistently handle files outside the installation prefix:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CONF_FILES</code> and <code>REQD_FILES</code> are pairs of master and target files. During installation time, the master file is copied to the target one if and only if the latter does not exist. Upon deinstallation, the target file is removed provided that it was not modified by the installation.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The difference between the two is that the latter prompts the administrator to remove any files that may be left after deinstallation (because they were not empty), while the former does not.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>CONF_FILES_PERMS</code> and <code>REQD_FILES_PERMS</code> contain tuples describing master files as well as their target locations. For each of them, it also specifies their owner, their group and their numeric permissions, in this order.  For example:</p>
<div class="literalblock">
<div class="content">
<pre>REQD_FILES_PERMS+=      ${PREFIX}/share/somefile ${VARBASE}/somefile \
                        ${REAL_ROOT_USER} ${REAL_ROOT_GROUP} 0700</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>The difference between the two is exactly the same as their non-PERMS counterparts.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_20_2_configuration_files">20.2. Configuration files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Configuration files are special in the sense that they are installed in their own specific directory, <code>PKG_SYSCONFDIR</code>, and need special treatment during installation (most of which is automated by pkginstall). The main concept you must bear in mind is that files marked as configuration files are automatically copied to the right place (somewhere inside <code>PKG_SYSCONFDIR</code>) during installation <em>if and only if</em> they didn&#8217;t exist before. Similarly, they will not be removed if they have local modifications. This ensures that administrators never lose any custom changes they may have made.</p>
</div>
<div class="sect2">
<h3 id="_20_2_1_how_pkg_sysconfdir_is_set">20.2.1. How PKG_SYSCONFDIR is set</h3>
<div class="paragraph">
<p>As said before, the <code>PKG_SYSCONFDIR</code> variable specifies where configuration files shall be installed. Its contents are set based upon the following variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PKG_SYSCONFBASE</code>: The configuration&#8217;s root directory. Defaults to <code>${PREFIX}/etc</code> although it may be overridden by the user to point t his preferred location (e.g., <code>/etc</code>, <code>/etc/pkg</code>, etc.). Packages must not use it directly.</p>
</li>
<li>
<p><code>PKG_SYSCONFSUBDIR</code>: A subdirectory of <code>PKG_SYSCONFBASE</code> under which the configuration files for the package being built shall be installed. The definition of this variable only makes sense in the package&#8217;s <code>Makefile</code> (i.e., it is not user-customizable).</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As an example, consider the Apache package, <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/www/apache24/index.html"><code>www/apache24</code></a>, which places its configuration files under the <code>httpd/</code> subdirectory of <code>PKG_SYSCONFBASE</code>. This should be set in the package Makefile.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PKG_SYSCONFVAR</code>: Specifies the name of the variable that holds this package&#8217;s configuration directory (if different from <code>PKG_SYSCONFBASE</code>). It defaults to <code>PKGBASE</code>'s value, and is always prefixed with <code>PKG_SYSCONFDIR</code>.</p>
</li>
<li>
<p><code>PKG_SYSCONFDIR.${PKG_SYSCONFVAR}</code>: Holds the directory where the configuration files for the package identified by <code>PKG_SYSCONFVAR</code>'s shall be placed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Based on the above variables, pkginstall determines the value of <code>PKG_SYSCONFDIR</code>, which is the <em>only</em> variable that can be used within a package to refer to its configuration directory. The algorithm used to set its value is basically the following:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If <code>PKG_SYSCONFDIR.${PKG_SYSCONFVAR}</code> is set, its value is used.</p>
</li>
<li>
<p>If the previous variable is not defined but <code>PKG_SYSCONFSUBDIR</code> is set in the package&#8217;s <code>Makefile</code>, the resulting value is <code>${PKG_SYSCONFBASE}/${PKG_SYSCONFSUBDIR}</code>.</p>
</li>
<li>
<p>Otherwise, it is set to <code>${PKG_SYSCONFBASE}</code>.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>It is worth mentioning that <code>${PKG_SYSCONFDIR}</code> is automatically added to <code>OWN_DIRS</code>. See <a href="https://www.netbsd.org/docs/pkgsrc/pkginstall.html#dirs-outside-prefix">Section 20.1.1, “Directory manipulation”</a> what this means. This does not apply to subdirectories of <code>${PKG_SYSCONFDIR}</code>, they still have to be created with OWN_DIRS or MAKE_DIRS.</p>
</div>
</div>
<div class="sect2">
<h3 id="_20_2_2_telling_the_software_where_configuration_files_are">20.2.2. Telling the software where configuration files are</h3>
<div class="paragraph">
<p>Given that pkgsrc (and users!) expect configuration files to be in a known place, you need to teach each package where it shall install its files. In some cases you will have to patch the package Makefiles to achieve it. If you are lucky, though, it may be as easy as passing an extra flag to the configuration script; this is the case of GNU Autoconf- generated files:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CONFIGURE_ARGS+= --sysconfdir=${PKG_SYSCONFDIR}</pre>
</div>
</div>
<div class="paragraph">
<p>Note that this specifies where the package has to <em>look for</em> its configuration files, not where they will be originally installed (although the difference is never explicit, unfortunately).</p>
</div>
</div>
<div class="sect2">
<h3 id="_20_2_3_patching_installations">20.2.3. Patching installations</h3>
<div class="paragraph">
<p>As said before, pkginstall automatically handles configuration files. This means that <strong>the packages themselves must not touch the contents of <code>${PKG_SYSCONFDIR}</code> directly</strong>. Bad news is that many software installation scripts will, out of the box, mess with the contents of that directory. So what is the correct procedure to fix this issue?</p>
</div>
<div class="paragraph">
<p>You must teach the package (usually by manually patching it) to install any configuration files under the examples hierarchy, <code>share/examples/${PKGBASE}/</code>. This way, the <code>PLIST</code> registers them and the administrator always has the original copies available.</p>
</div>
<div class="paragraph">
<p>Once the required configuration files are in place (i.e., under the examples hierarchy), the pkginstall framework can use them as master copies during the package installation to update what is in <code>${PKG_SYSCONFDIR}</code>. To achieve this, the variables <code>CONF_FILES</code> and <code>CONF_FILES_PERMS</code> are used. Check out <a href="https://www.netbsd.org/docs/pkgsrc/pkginstall.html#files-outside-prefix">Section 20.1.2, “File manipulation”</a> for information about their syntax and their purpose.  Here is an example, taken from the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/mail/mutt/index.html"><code>mail/mutt</code></a> package:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>EGDIR=        ${PREFIX}/share/doc/mutt/samples
CONF_FILES=   ${EGDIR}/Muttrc ${PKG_SYSCONFDIR}/Muttrc</pre>
</div>
</div>
<div class="paragraph">
<p>Note that the EGDIR variable is specific to that package and has no meaning outside it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_20_2_4_disabling_handling_of_configuration_files">20.2.4. Disabling handling of configuration files</h3>
<div class="paragraph">
<p>The automatic copying of config files can be toggled by setting the environment variable <code>PKG_CONFIG</code> prior to package installation.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_20_3_system_startup_scripts">20.3. System startup scripts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>System startup scripts are special files because they must be installed in a place known by the underlying OS, usually outside the installation prefix. Therefore, the same rules described in <a href="https://www.netbsd.org/docs/pkgsrc/pkginstall.html#files-and-dirs-outside-prefix">Section 20.1, “Files and directories outside the installation prefix”</a> apply, and the same solutions can be used. However, pkginstall provides a special mechanism to handle these files.</p>
</div>
<div class="paragraph">
<p>In order to provide system startup scripts, the package has to:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Store the script inside <code>${FILESDIR}</code>, with the <code>.sh</code> suffix appended. Considering the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/print/cups-base/index.html"><code>print/cups-base</code></a> package as an example, it has a <code>cupsd.sh</code> in its files directory.</p>
</li>
<li>
<p>Tell pkginstall to handle it, appending the name of the script, without its extension, to the <code>RCD_SCRIPTS</code> variable. Continuing the previous example:</p>
<div class="literalblock">
<div class="content">
<pre>RCD_SCRIPTS+=   cupsd</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Once this is done, pkginstall will do the following steps for each script in an automated fashion:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Process the file found in the files directory applying all the substitutions described in the <code>FILES_SUBST</code> variable.</p>
</li>
<li>
<p>Copy the script from the files directory to the examples hierarchy, <code>${PREFIX}/share/examples/rc.d/</code>. Note that this master file must be explicitly registered in the <code>PLIST</code>.</p>
</li>
<li>
<p>Add code to the installation scripts to copy the startup script from the examples hierarchy into the system-wide startup scripts directory.</p>
</li>
</ol>
</div>
<div class="sect2">
<h3 id="_20_3_1_disabling_handling_of_system_startup_scripts">20.3.1. Disabling handling of system startup scripts</h3>
<div class="paragraph">
<p>The automatic copying of config files can be toggled by setting the environment variable <code>PKG_RCD_SCRIPTS</code> prior to package installation. Note that the scripts will be always copied inside the examples hierarchy, <code>${PREFIX}/share/examples/rc.d/</code>, no matter what the value of this variable is.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_20_4_system_users_and_groups">20.4. System users and groups</h2>
<div class="sectionbody">
<div class="paragraph">
<p>If a package needs to create special users and/or groups during installation, it can do so by using the pkginstall framework.</p>
</div>
<div class="paragraph">
<p>Users can be created by adding entries to the <code>PKG_USERS</code> variable. Each entry has the following syntax:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>user:group</pre>
</div>
</div>
<div class="paragraph">
<p>Further specification of user details may be done by setting per-user variables. <code>PKG_UID.<em>user</code></em> is the numeric UID for the user. <code>PKG_GECOS.<em>user</code></em> is the user&#8217;s description or comment. <code>PKG_HOME.<em>user</code></em> is the user&#8217;s home directory, and defaults to <code>/nonexistent</code> if not specified. <code>PKG_SHELL.<em>user</code></em> is the user&#8217;s shell, and defaults to <code>/sbin/nologin</code> if not specified.</p>
</div>
<div class="paragraph">
<p>Similarly, groups can be created by adding entries to the <code>PKG_GROUPS</code> variable, whose syntax is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>group</pre>
</div>
</div>
<div class="paragraph">
<p>The numeric GID of the group may be set by defining <code>PKG_GID.<em>group</code></em>.</p>
</div>
<div class="paragraph">
<p>If a package needs to create the users and groups at an earlier stage, then it can set <code>USERGROUP_PHASE</code> to either <code>configure</code>,<code>build</code>, or <code>pre-install</code> to indicate the phase before which the users and groups are created. In this case, the numeric UIDs and GIDs of the created users and groups are automatically hardcoded into the final installation scripts.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_20_5_system_shells">20.5. System shells</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Packages that install system shells should register them in the shell database, <code>/etc/shells</code>, to make things easier to the administrator. This must be done from the installation scripts to keep binary packages working on any system. pkginstall provides an easy way to accomplish this task.</p>
</div>
<div class="paragraph">
<p>When a package provides a shell interpreter, it has to set the <code>PKG_SHELL</code> variable to its absolute file name. This will add some hooks to the installation scripts to handle it. Consider the following example, taken from <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/shells/zsh/index.html"><code>shells/zsh</code></a>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PKG_SHELL=      ${PREFIX}/bin/zsh</pre>
</div>
</div>
<div class="sect2">
<h3 id="_20_5_1_disabling_shell_registration">20.5.1. Disabling shell registration</h3>
<div class="paragraph">
<p>The automatic registration of shell interpreters can be disabled by the administrator by setting the <code>PKG_REGISTER_SHELLS</code> environment variable to <code>NO</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_20_6_fonts">20.6. Fonts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Packages that install X11 fonts should update the database files that index the fonts within each fonts directory. This can easily be accomplished within the pkginstall framework.</p>
</div>
<div class="paragraph">
<p>When a package installs X11 fonts, it must list the directories in which fonts are installed in the <code>FONTS_DIRS.<em>type</code></em> variables, where <em><code>type</code></em> can be one of “ttf”, “type1” or “x11”.  This will add hooks to the installation scripts to run the appropriate commands to update the fonts database files within each of those directories. For convenience, if the directory path is relative, it is taken to be relative to the package&#8217;s installation prefix. Consider the following example, taken from <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/fonts/dbz-ttf/index.html"><code>fonts/dbz-ttf</code></a>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>FONTS_DIRS.ttf= ${PREFIX}/share/fonts/X11/TTF</pre>
</div>
</div>
<div class="sect2">
<h3 id="_20_6_1_disabling_automatic_update_of_the_fonts_databases">20.6.1. Disabling automatic update of the fonts databases</h3>
<div class="paragraph">
<p>The automatic update of fonts databases can be disabled by the administrator by setting the <code>PKG_UPDATE_FONTS_DB</code> environment variable to <code>NO</code>.</p>
</div>
</div>
</div>
</div>
<h1 id="_chapter_21_making_your_package_work" class="sect0">Chapter 21. Making your package work</h1>
<div class="sect1">
<h2 id="_21_1_general_operation">21.1. General operation</h2>
<div class="sectionbody">
<div class="paragraph">
<p>One appealing feature of pkgsrc is that it runs on many different platforms. As a result, it is important to ensure, where possible, that packages in pkgsrc are portable. This chapter mentions some particular details you should pay attention to while working on pkgsrc.</p>
</div>
<div class="sect2">
<h3 id="_21_1_1_how_to_pull_in_user_settable_variables_from_mk_conf">21.1.1. How to pull in user-settable variables from mk.conf</h3>
<div class="paragraph">
<p>The pkgsrc user can configure pkgsrc by overriding several variables in the file pointed to by <code>MAKECONF</code>, which is <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> by default. When you want to use those variables in the preprocessor directives of <a href="https://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> (for example <code>.if</code> or <code>.for</code>), you need to include the file <code>../../mk/bsd.prefs.mk</code> before, which in turn loads the user preferences.</p>
</div>
<div class="paragraph">
<p>But note that some variables may not be completely defined after <code>../../mk/bsd.prefs.mk</code> has been included, as they may contain references to variables that are not yet defined. In shell commands (the lines in <code>Makefile</code> that are indented with a tab) this is no problem, since variables are only expanded when they are used. But in the preprocessor directives mentioned above and in dependency lines (of the form target: dependencies) the variables are expanded at load time.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="title"><strong>Note</strong></div>
<div class="paragraph">
<p>To check whether a variable can be used at load time, run pkglint -Wall on your package.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_21_1_2_user_interaction">21.1.2. User interaction</h3>
<div class="paragraph">
<p>Occasionally, packages require interaction from the user, and this can be in a number of ways:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>When fetching the distfiles, some packages require user interaction such as entering username/password or accepting a license on a web page.</p>
</li>
<li>
<p>When extracting the distfiles, some packages may ask for passwords.</p>
</li>
<li>
<p>help to configure the package before it is built</p>
</li>
<li>
<p>help during the build process</p>
</li>
<li>
<p>help during the installation of a package</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A package can set the <code>INTERACTIVE_STAGE</code> variable to define which stages need interaction. This should be done in the package&#8217;s <code>Makefile</code>, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>INTERACTIVE_STAGE=      configure install</pre>
</div>
</div>
<div class="paragraph">
<p>The user can then decide to skip this package by setting the <code>BATCH</code> variable. Packages that require interaction are also excluded from bulk builds.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_1_3_handling_licenses">21.1.3. Handling licenses</h3>
<div class="paragraph">
<p>Authors of software can choose the licence under which software can be copied. The Free Software Foundation has declared some licenses "Free", and the Open Source Initiative has a definition of "Open Source".</p>
</div>
<div class="paragraph">
<p>By default, pkgsrc allows packages with Free or Open Source licenses to be built. To allow packages with other licenses to be built as well, the pkgsrc user needs to add these licenses to the <code>ACCEPTABLE_LICENSES</code> variable in <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>. Note that this variable only affects which packages may be <em>built</em>, while the license terms often also restrict the actual use of the package and its redistribution.</p>
</div>
<div class="paragraph">
<p>One might want to only install packages with a BSD license, or the GPL, and not the other. The free licenses are added to the default <code>ACCEPTABLE_LICENSES</code> variable. The pkgsrc user can override the default by setting the <code>ACCEPTABLE_LICENSES</code> variable with "=" instead of "+=". The licenses accepted by default are defined in the <code>DEFAULT_ACCEPTABLE_LICENSES</code> variable in the file <code>pkgsrc/mk/license.mk</code>.</p>
</div>
<div class="paragraph">
<p>The license tag mechanism is intended to address copyright-related issues surrounding building, installing and using a package, and not to address redistribution issues (see <code>RESTRICTED</code> and <code>NO_SRC_ON_FTP</code>, etc.). Packages with redistribution restrictions should set these tags.</p>
</div>
<div class="paragraph">
<p>Denoting that a package may be copied according to a particular license is done by placing the license in <code>pkgsrc/licenses</code> and setting the <code>LICENSE</code> variable to a string identifying the license, e.g. in <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/graphics/xv/index.html"><code>graphics/xv</code></a>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>LICENSE=        xv-license</pre>
</div>
</div>
<div class="paragraph">
<p>When trying to build, the user will get a notice that the package is covered by a license which has not been placed in the <code>ACCEPTABLE_LICENSES</code> variable:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% make
===&gt; xv-3.10anb9 has an unacceptable license: xv-license.
===&gt;     To view the license, enter "/usr/bin/make show-license".
===&gt;     To indicate acceptance, add this line to your /etc/mk.conf:
===&gt;     ACCEPTABLE_LICENSES+=xv-license
*** Error code 1</pre>
</div>
</div>
<div class="paragraph">
<p>The license can be viewed with <strong>make show-license</strong>, and if the user so chooses, the line printed above can be added to <a href="https://www.netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> to convey to pkgsrc that it should not in the future fail because of that license:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>ACCEPTABLE_LICENSES+=xv-license</pre>
</div>
</div>
<div class="paragraph">
<p>The use of <code>LICENSE=shareware</code>, <code>LICENSE=no-commercial-use</code>, and similar language is deprecated because it does not crisply refer to a particular license text. Another problem with such usage is that it does not enable a user to tell pkgsrc to proceed for a single package without also telling pkgsrc to proceed for all packages with that tag.</p>
</div>
<div class="sect3">
<h4 id="_21_1_3_1_adding_a_package_with_a_new_license">21.1.3.1. Adding a package with a new license</h4>
<div class="paragraph">
<p>When adding a package with a new license, the following steps are required:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Check whether the license qualifies as Free or Open Source by referencing <a href="https://www.gnu.org/licenses/license-list.en.html">Various Licenses and Comments about Them</a> and <a href="https://opensource.org/licenses/alphabetical">Licenses by Name | Open Source Initiative</a>. If this is the case, the filename in <code>pkgsrc/licenses/</code> does not need the <code>-license</code> suffix, and the license name should be added to:</p>
<div class="ulist">
<ul>
<li>
<p>DEFAULT_ACCEPTABLE_LICENSES in <code>pkgsrc/mk/license.mk</code></p>
</li>
<li>
<p>default_acceptable_licenses in <code>pkgsrc/pkgtools/pkg_install/files/lib/license.c</code></p>
</li>
</ul>
</div>
</li>
<li>
<p>The license text should be added to <code>pkgsrc/licenses</code> for displaying. A list of known licenses can be seen in this directory.</p>
</li>
</ol>
</div>
</div>
<div class="sect3">
<h4 id="_21_1_3_2_change_to_the_license">21.1.3.2. Change to the license</h4>
<div class="paragraph">
<p>When the license changes (in a way other than formatting), make sure that the new license has a different name (e.g., append the version number if it exists, or the date). Just because a user told pkgsrc to build programs under a previous version of a license does not mean that pkgsrc should build programs under the new licenses. The higher-level point is that pkgsrc does not evaluate licenses for reasonableness; the only test is a mechanistic test of whether a particular text has been approved by either of two bodies (FSF or OSI).</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_21_1_4_restricted_packages">21.1.4. Restricted packages</h3>
<div class="paragraph">
<p>Some licenses restrict how software may be re-distributed. By declaring the restrictions, package tools can automatically refrain from e.g. placing binary packages on FTP sites.</p>
</div>
<div class="paragraph">
<p>There are four possible restrictions, which are the cross product of sources (distfiles) and binaries not being placed on FTP sites and CD-ROMs. Because this is rarely the exact language in any license, and because non-Free licenses tend to be different from each other, pkgsrc adopts a definition of FTP and CD-ROM. "FTP" means making the source or binary file available over the Internet at no charge. "CD-ROM" means making the source or binary available on some kind of media, together with other source and binary packages, which is sold for a distribution charge.</p>
</div>
<div class="paragraph">
<p>In order to encode these restrictions, the package system defines five make variables that can be set to note these restrictions:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>RESTRICTED</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This variable should be set whenever a restriction exists (regardless of its kind). Set this variable to a string containing the reason for the restriction. It should be understood that those wanting to understand the restriction	will have to read the license, and perhaps seek advice of counsel.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NO_BIN_ON_CDROM</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Binaries may not be placed on CD-ROM containing other binary packages, for which a distribution charge may be made. In this case, set this variable to	<code>${RESTRICTED}</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NO_BIN_ON_FTP</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Binaries may not made available on the Internet without	charge. In this case, set this variable to <code>${RESTRICTED}</code>.  If this variable is set, binary packages will not be included on ftp.NetBSD.org.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NO_SRC_ON_CDROM</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Distfiles may not be placed on CD-ROM, together with other distfiles, for which a fee may be charged. In this case, set this variable to <code>${RESTRICTED}</code>.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>NO_SRC_ON_FTP</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Distfiles may not made available via FTP at no charge. In this case, set this variable to <code>${RESTRICTED}</code>. If this variable is set, the distfile(s) will not be mirrored on ftp.NetBSD.org.</p>
</div>
<div class="paragraph">
<p>Please note that packages will be removed from pkgsrc when the distfiles are not distributable and cannot be obtained for a period of one full quarter branch. Packages with manual/interactive fetch must have a maintainer and it is his/her responsibility to ensure this.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_1_5_handling_dependencies">21.1.5. Handling dependencies</h3>
<div class="paragraph">
<p>Your package may depend on some other package being present,and there are various ways of expressing this dependency.pkgsrc supports the <code>DEPENDS</code>, <code>BUILD_DEPENDS</code>, <code>TOOL_DEPENDS</code>, and <code>TEST_DEPENDS</code> definitions, the <code>USE_TOOLS</code> definition, as well as dependencies via <code>buildlink3.mk</code>, which is the preferred way to handle dependencies, and which uses the variables named above. See <a href="https://www.netbsd.org/docs/pkgsrc/buildlink.html">Chapter 18, Buildlink methodology</a> for more information.</p>
</div>
<div class="paragraph">
<p>The basic difference is that the <code>DEPENDS</code> definition registers that pre-requisite in the binary package so it will be pulled in when the binary package is later installed, whilst the <code>BUILD_DEPENDS</code>, <code>TOOL_DEPENDS</code>, and <code>TEST_DEPENDS</code> definitions do not, marking a dependency that is only needed for building or testing the resulting package. See also <a href="https://www.netbsd.org/docs/pkgsrc/creating.html">Chapter 14, Creating a new pkgsrc package from scratch</a> for more information.</p>
</div>
<div class="paragraph">
<p>This means that if you only need a package present whilst you are building or testing, it should be noted as a <code>TOOL_DEPENDS</code>, <code>BUILD_DEPENDS</code>, or <code>TEST_DEPENDS</code>. When cross-compiling, <code>TOOL_DEPENDS</code> are <em>native</em> packages, i.e. packages for the architecture where the package is built; <code>BUILD_DEPENDS</code> are <em>target</em> packages, i.e., packages for the architecture for which the package is built.</p>
</div>
<div class="paragraph">
<p>The format for a <code>DEPENDS</code>, <code>BUILD_DEPENDS</code>, <code>TOOL_DEPENDS</code>, and <code>TEST_DEPENDS</code> definition is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;pre-req-package-name&gt;:../../&lt;category&gt;/&lt;pre-req-package&gt;</pre>
</div>
</div>
<div class="paragraph">
<p>Please note that the “pre-req-package-name” may include any of the wildcard version numbers recognized by <a href="https://man.NetBSD.org/NetBSD-9.2/i386/pkg_info.1">pkg_info(1)</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If your package needs another package&#8217;s binaries or libraries to build and run, and if that package has a <code>buildlink3.mk</code> file available, use it:</p>
<div class="literalblock">
<div class="content">
<pre>.include "../../graphics/jpeg/buildlink3.mk"</pre>
</div>
</div>
</li>
<li>
<p>If your package needs another package&#8217;s binaries or libraries only for building, and if that package has a <code>buildlink3.mk</code> file available, use it:</p>
<div class="literalblock">
<div class="content">
<pre>.include "../../graphics/jpeg/buildlink3.mk"</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>but set <code>BUILDLINK_DEPMETHOD.<em>jpeg</code></em>?=build to make it a build dependency only. This case is rather rare.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>If your package needs binaries from another package to build, use the <code>TOOL_DEPENDS</code> definition:</p>
<div class="literalblock">
<div class="content">
<pre>TOOL_DEPENDS+= itstool-[0-9]*:../../textproc/itstool</pre>
</div>
</div>
</li>
<li>
<p>If your package needs static libraries to link against, header files to include, etc. from another package to build, use the <code>BUILD_DEPENDS</code> definition.</p>
</li>
<li>
<p>If your package needs a library with which to link and there is no <code>buildlink3.mk</code> file available, create one. Using <code>DEPENDS</code> won&#8217;t be sufficient because the include files and libraries will be hidden from the compiler.</p>
</li>
<li>
<p>If your package needs some executable to be able to run correctly and if there&#8217;s no <code>buildlink3.mk</code> file, this is specified using the <code>DEPENDS</code> variable. The <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/print/lyx/index.html"><code>print/lyx</code></a> package needs to be able to execute the latex binary from the tex-latex-bin package when it runs, and that is specified:</p>
<div class="literalblock">
<div class="content">
<pre>DEPENDS+=        tex-latex-bin-[0-9]*:../../print/tex-latex-bin</pre>
</div>
</div>
</li>
<li>
<p>If your package includes a test suite that has extra dependencies only required for this purpose (frequently this can be run as a “make test” target), use the <code>TEST_DEPENDS</code> variable.</p>
</li>
<li>
<p>You can use wildcards in package dependencies. Note that such wildcard dependencies are retained when creating binary packages. The dependency is checked when installing the binary package and any package which matches the pattern will be	used. Wildcard dependencies should be used with care.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The “-[0-9]* "should be used instead of “-<strong>” to avoid potentially ambiguous matches such as “tk-postgresql” matching a “tk-</strong>” <code>DEPENDS</code>.</p>
</div>
<div class="paragraph">
<p>wildcards can also be used to specify that a package will only build against a certain minimum version of a pre-requisite:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DEPENDS+=       ImageMagick&gt;=6.0:../../graphics/ImageMagick</pre>
</div>
</div>
<div class="paragraph">
<p>This means that the package will build using version 6.0 of ImageMagick or newer. Such a dependency may be warranted if, for example, the command line options of an executable have changed.</p>
</div>
<div class="paragraph">
<p>If you need to depend on minimum versions of libraries, set <code>BUILDLINK_API_DEPENDS.<em>pkg</code></em> to the appropriate pattern before including its <code>buildlink3.mk</code> file, e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>BUILDLINK_API_DEPENDS.jpeg+=    jpeg&gt;=9.0
.include "../../graphics/jpeg/buildlink3.mk"</pre>
</div>
</div>
<div class="paragraph">
<p>For security fixes, please update the package vulnerabilities file. See <a href="https://www.netbsd.org/docs/pkgsrc/fixes.html#security-handling">Section 21.1.9, “Handling packages with security problems”</a> for more information.</p>
</div>
<div class="paragraph">
<p>If your package needs files from another package to build, add the relevant distribution files to <code>DISTFILES</code>, so they will be extracted automatically. See the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/print/ghostscript/index.html"><code>print/ghostscript</code></a> package for an example. (It relies on the jpeg sources being present in source form during the build.)</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_1_6_handling_conflicts_with_other_packages">21.1.6. Handling conflicts with other packages</h3>
<div class="paragraph">
<p>Your package may conflict with other packages a user might already have installed on his system, e.g. if your package installs the same set of files as another package in the pkgsrc tree or has the same <code>PKGNAME</code>.</p>
</div>
<div class="paragraph">
<p>For example, <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/x11/libXaw3d/index.html"><code>x11/libXaw3d</code></a> and <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/x11/Xaw-Xpm/index.html"><code>x11/Xaw-Xpm</code></a> install the same shared library, thus you set in <code>pkgsrc/x11/libXaw3d/Makefile</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CONFLICTS=      Xaw-Xpm-[0-9]*</pre>
</div>
</div>
<div class="paragraph">
<p>and in <code>pkgsrc/x11/Xaw-Xpm/Makefile</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CONFLICTS=      libXaw3d-[0-9]*</pre>
</div>
</div>
<div class="paragraph">
<p><a href="https://man.NetBSD.org/NetBSD-9.2/i386/pkg_add.1">pkg_add(1)</a> is able to detect attempts to install packages that conflict with existing packages and abort. However, in many situations this is too late in the process. Binary package managers will not know about the conflict until they attempt to install the package after already downloading it and all its dependencies. Users may also waste time building a package and its dependencies only to find out at the end that it conflicts with another package they have installed.</p>
</div>
<div class="paragraph">
<p>To avoid these issues <code>CONFLICTS</code> entries should be added in all cases where it is known that packages conflict with each other. These <code>CONFLICTS</code> entries are exported in <a href="https://man.NetBSD.org/NetBSD-9.2/i386/pkg_summary.5">pkg_summary(5)</a> files and consumed by binary package managers to inform users that packages cannot be installed onto the target system.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_1_7_packages_that_cannot_or_should_not_be_built">21.1.7. Packages that cannot or should not be built</h3>
<div class="paragraph">
<p>There are several reasons why a package might be instructed to not build under certain circumstances. If the package builds and runs on most platforms, the exceptions should be noted with <code>BROKEN_ON_PLATFORM</code>. If the package builds and runs on a small handful of platforms, set <code>BROKEN_EXCEPT_ON_PLATFORM</code> instead. Both <code>BROKEN_ON_PLATFORM</code> and <code>BROKEN_EXCEPT_ON_PLATFORM</code> are OS triples (OS-version-platform) that can use glob-style wildcards.</p>
</div>
<div class="paragraph">
<p>If a package is not appropriate for some platforms (as opposed to merely broken), a different set of variables should be used as this affects failure reporting and statistics. If the package is appropriate for most platforms, the exceptions should be noted with <code>NOT_FOR_PLATFORM</code>. If the package is appropriate for only a small handful of platforms (often exactly one), set <code>ONLY_FOR_PLATFORM</code> instead. Both <code>ONLY_FOR_PLATFORM</code> and <code>NOT_FOR_PLATFORM</code> are OS triples (OS-version-platform) that can use glob-style wildcards.</p>
</div>
<div class="paragraph">
<p>Some packages are tightly bound to a specific version of an operating system, e.g. LKMs or <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/sysutils/lsof/index.html"><code>sysutils/lsof</code></a>. Such binary packages are not backwards compatible with other versions of the OS, and should be uploaded to a version specific directory on the FTP server. Mark these packages by setting <code>OSVERSION_SPECIFIC</code> to “yes”. This variable is not currently used by any of the package system internals, but may be used in the future.</p>
</div>
<div class="paragraph">
<p>If the package should be skipped (for example, because it provides functionality already provided by the system), set <code>PKG_SKIP_REASON</code> to a descriptive message. If the package should fail because some preconditions are not met, set <code>PKG_FAIL_REASON</code> to a descriptive message.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_1_8_packages_which_should_not_be_deleted_once_installed">21.1.8. Packages which should not be deleted, once installed</h3>
<div class="paragraph">
<p>To ensure that a package may not be deleted, once it has been installed, the <code>PKG_PRESERVE</code> definition should be set in the package Makefile. This will be carried into any binary package that is made from this pkgsrc entry. A “preserved” package will not be deleted using <a href="https://man.NetBSD.org/NetBSD-9.2/i386/pkg_delete.1">pkg_delete(1)</a> unless the “-f” option is used.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_1_9_handling_packages_with_security_problems">21.1.9. Handling packages with security problems</h3>
<div class="paragraph">
<p>When a vulnerability is found, this should be noted in <code>localsrc/security/advisories/pkg-vulnerabilities</code>. Entries in that file consist of three parts:
* package version pattern</p>
</div>
<div class="ulist">
<ul>
<li>
<p>type of vulnerability (please cut&#8217;n&#8217;paste an existing one where possible)</p>
</li>
<li>
<p>URL providing additional information about the issue</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>For the package version pattern please always use `&lt;' to mark an upper bound (not `&#8656;'!). This will avoid possible problems due unrelated <code>PKGREVISION</code> bumps not related to security fixes. Lower bounds can be added too, using '&gt;' or '&gt;='. For example, “<code>foo&gt;=1&lt;1.2</code>” would mark versions 1.0 (included) to 1.2 (excluded) of “<code>foo</code>” as affected by the security issue.</p>
</div>
<div class="paragraph">
<p>Entries should always be added at the bottom of the file.</p>
</div>
<div class="paragraph">
<p>When fixing packages, please modify the upper bound of the corresponding entry. To continue the previous example, if a fix was backported to version 1.1nb2, change the previous pattern to “<code>foo&gt;=1&lt;1.1nb2</code>”.</p>
</div>
<div class="paragraph">
<p>To locally test a package version pattern against a <code>PKGNAME</code> you can use the <strong>pkg_admin pmatch</strong> command.</p>
</div>
<div class="paragraph">
<p>The URL should be as permanent as possible and provide as much information about the issue as possible. CVE entries are preferred.</p>
</div>
<div class="paragraph">
<p>After committing that file, ask <a href="mailto:pkgsrc-security@NetBSD.org">pkgsrc-security@NetBSD.org</a> to update the file on ftp.NetBSD.org.</p>
</div>
<div class="paragraph">
<p>After fixing the vulnerability by a patch, its <code>PKGREVISION</code> should be increased (this is of course not necessary if the problem is fixed by using a newer release of the software), and the pattern in the pkg-vulnerabilities file must be updated.</p>
</div>
<div class="paragraph">
<p>Also, if the fix should be applied to the stable pkgsrc branch, be sure to submit a pullup request!</p>
</div>
<div class="paragraph">
<p>Binary packages already on ftp.NetBSD.org will be handled semi-automatically by a weekly cron job.</p>
</div>
<div class="paragraph">
<p>In case a security issue is disputed, please contact <a href="mailto:pkgsrc-security@NetBSD.org">pkgsrc-security@NetBSD.org</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_1_10_how_to_handle_incrementing_versions_when_fixing_an_existing_package">21.1.10. How to handle incrementing versions when fixing an existing package</h3>
<div class="paragraph">
<p>When making fixes to an existing package it can be useful to change the version number in <code>PKGNAME</code>. To avoid conflicting with future versions by the original author, a “nb1”, “nb2”, &#8230;&#8203; suffix can be used on package versions by setting <code>PKGREVISION=1</code> (2, &#8230;&#8203;). The “nb” is treated like a “.” by the package tools. e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTNAME=       foo-17.42
PKGREVISION=    9</pre>
</div>
</div>
<div class="paragraph">
<p>will result in a <code>PKGNAME</code> of “foo-17.42nb9”. If you want to use the original value of <code>PKGNAME</code> without the “nbX” suffix, e.g. for setting <code>DIST_SUBDIR</code>, use <code>PKGNAME_NOREV</code>.</p>
</div>
<div class="paragraph">
<p>When a new release of the package is released, the <code>PKGREVISION</code> should be removed, e.g. on a new minor release of the above package, things should be like:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTNAME=       foo-17.43</pre>
</div>
</div>
<div class="paragraph">
<p><code>PKGREVISION</code> should be incremented for any non-trivial change in the resulting binary package.  Without a <code>PKGREVISION</code> bump, someone with the previous version installed has no way of knowing that their package is out of date. Thus, changes without increasing <code>PKGREVISION</code> are essentially labeled "this is so trivial that no reasonable person would want to upgrade", and this is the rough test for when increasing <code>PKGREVISION</code> is appropriate. Examples of changes that do not merit increasing <code>PKGREVISION</code> are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Changing <code>HOMEPAGE</code>, <code>MAINTAINER</code>, <code>OWNER</code>, or comments in Makefile.</p>
</li>
<li>
<p>Changing build variables if the resulting binary package is the same.</p>
</li>
<li>
<p>Changing <code>DESCR</code>.</p>
</li>
<li>
<p>Adding <code>PKG_OPTIONS</code> if the default options don&#8217;t change.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Examples of changes that do merit an increase to <code>PKGREVISION</code> include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Security fixes</p>
</li>
<li>
<p>Changes or additions to a patch file</p>
</li>
<li>
<p>Changes to the <code>PLIST</code></p>
</li>
<li>
<p>A dependency is changed or renamed.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>PKGREVISION must also be incremented when dependencies have ABI changes.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_1_11_substituting_variable_text_in_the_package_files_the_subst_framework">21.1.11. Substituting variable text in the package files (the SUBST framework)</h3>
<div class="paragraph">
<p>When you want to replace the same text in multiple files, or multiple times in the same file, it is cumbersome to maintain a patch file for this. This is where the SUBST framework steps in. It provides an easy-to-use interface for replacing text in files. It just needs the following information:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>In which phase of the package build cycle should the replacement happen?</p>
</li>
<li>
<p>In which files should the replacement happen?</p>
</li>
<li>
<p>Which text should be replaced with what?</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This information is encoded in a block of <code>SUBST</code> variables. A minimal example is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SUBST_CLASSES+=         paths
SUBST_STAGE.paths=      pre-configure
SUBST_FILES.paths=      src/*.c
SUBST_SED.paths=        -e 's,/usr/local,${PREFIX},g'</pre>
</div>
</div>
<div class="paragraph">
<p>Translated into English, it means: In the pre-configure stage (that is, after applying the patches from the patches/ directory and before running the configure script and the portability check), replace the text <code>/usr/local</code> with the content of the variable <code>PREFIX</code>.</p>
</div>
<div class="paragraph">
<p>Each SUBST block starts by appending an identifier to <code>SUBST_CLASSES</code> (note the <code>+=</code>). This identifier can be chosen freely by the package. If there should ever be duplicate identifiers, the pkgsrc infrastructure will catch this and fail early, so don&#8217;t worry about name collisions.</p>
</div>
<div class="paragraph">
<p>Except for <code>SUBST_CLASSES</code>, all variables in a SUBST block are parameterized using this identifier. In the remainder of this section, these parameterized variables are written as <code>SUBST_STAGE.*</code>.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SUBST_CLASSES+=         paths
SUBST_STAGE.paths=      pre-configure
SUBST_MESSAGE.paths=    Fixing absolute paths.
SUBST_FILES.paths=      src/*.c
SUBST_FILES.paths+=     scripts/*.sh
SUBST_SED.paths=        -e 's,"/usr/local,"${PREFIX},g'
SUBST_SED.paths+=       -e 's,"/var/log,"${VARBASE}/log,g'
SUBST_VARS.paths=       LOCALBASE PREFIX PKGVERSION</pre>
</div>
</div>
<div class="paragraph">
<p>To get a complete picture about the SUBST substitutions, run <strong>bmake show-all-subst</strong>. If something doesn&#8217;t work as expected, run pkglint on the package, which detects several typical mistakes surrounding the SUBST blocks. For any questions that might remain after this, have a look at <code>mk/subst.mk</code>.</p>
</div>
<div class="sect3">
<h4 id="_21_1_11_1_choosing_the_time_where_the_substitutions_happen">21.1.11.1. Choosing the time where the substitutions happen</h4>
<div class="paragraph">
<p>The <code>SUBST_STAGE.*</code> is one of {pre,do,post}-{extract,patch,configure,build,test,install}. Of these, <code>pre-configure</code> is used most often, by far. The most popular stages are, in chronological order:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>post-extract</code></dt>
<dd>
<p>The substitutions are applied immediately after the distfiles are extracted. Running <strong>bmake extract</strong> on the package will leave no traces of the original files.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When the substitution applies to files for which there is also a patch in the <code>patches/</code> directory, this means that the patches will be computed based on the result of the substitution. When these patches are sent to the upstream maintainer later, to be fixed in the upstream package, these patches may no longer match what the upstream author is used to. Because of this, <code>pre-configure</code> is often a better choice.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>pre-configure</code></dt>
<dd>
<p>The substitutions are applied after the patches from the <code>patches/</code> directory. This makes it possible to run <strong>bmake patch</strong> on the package, after which the patches can be edited using the tools pkgvi and mkpatches from the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkgdif/index.html"><code>pkgtools/pkgdiff</code></a> package.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>When updating the patches, it is helpful to explicitly separate the <strong>bmake patch</strong> from the <strong>bmake configure</strong>, and to only edit the patches between these commands. Otherwise the substitutions from the SUBST block will end up in the patch file. When this happens in really obvious ways, pkglint will complain about patches that contain a hard-coded <code>/usr/pkg</code> instead of the correct and intended <code>@PREFIX@</code>, but it can only detect these really obvious cases.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>do-configure</code></dt>
<dd>
<p>This stage should only be used if the package defines a <code>pre-configure</code> action itself, and the substitution must happen after that. Typical examples are packages that use the <code>pre-configure</code> stage to regenerate the GNU configure script from <code>configure.ac</code>.</p>
</dd>
<dt class="hdlist1"><code>post-configure</code></dt>
<dd>
<p>This stage is used to fix up any mistakes by the configure stage.</p>
</dd>
<dt class="hdlist1"><code>pre-build</code></dt>
<dd>
<p>This stage should only be used for substitutions that are clearly related to building the package, not for fixing the configuration. Substitutions for pathnames (such as replacing <code>/usr/local</code> with <code>${PREFIX}</code>) or user names (such as replacing <code>@MY_USER@</code> with the actual username) belong in pre-configure or post-configure instead.</p>
</dd>
<dt class="hdlist1"><code>post-build</code></dt>
<dd>
<p>Just as with pre-build, this stage should only be used for substitutions that are clearly related to building the package, not for fixing the configuration. Substitutions for pathnames (such as replacing <code>/usr/local</code> with <code>${PREFIX}</code>) or user names (such as replacing <code>@MY_USER@</code> with the actual username) belong in pre-configure or post-configure instead.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A typical use is to update pkg-config files to include the rpath compiler options.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1"><code>pre-install</code></dt>
<dd>
<p>In general, the install phase should be as simple as possible. As with the pre-build and post-build stages, it should not be used to fix pathnames or user names, these belong in pre-configure instead. There are only few legitimate use cases for applying substitutions in this stage.</p>
</dd>
</dl>
</div>
</div>
<div class="sect3">
<h4 id="_21_1_11_2_choosing_the_files_where_the_substitutions_happen">21.1.11.2. Choosing the files where the substitutions happen</h4>
<div class="paragraph">
<p>The <code>SUBST_FILES.*</code> variable contains a list of filename patterns. These patterns are relative to <code>WRKSRC</code> since that is where most substitutions happen. A typical example is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SUBST_FILES.path=       Makefile */Makefile */*/Makefile *.[ch]</pre>
</div>
</div>
<div class="paragraph">
<p>The above patterns, especially the last, are quite broad. The SUBST implementation checks that each filename pattern that is mentioned here has an effect. For example, if none of the <code>* /*/Makefile</code> files contains the patterns to be found and substituted, that filename pattern is redundant and should be left out. By default, the SUBST framework will complain with an error message. If the text to be substituted occurs in some of the files from a single pattern, but not in all of them, that is totally ok, and the SUBST framework will only print an INFO message for those files.</p>
</div>
<div class="paragraph">
<p>If there is a good reason for having redundant filename patterns, set <code>SUBST_NOOP_OK.*</code> to <code>yes</code>.</p>
</div>
<div class="paragraph">
<p>Another popular way of choosing the files for the substitutions is via a shell command, like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>C_FILES_CMD=            cd ${WRKSRC} &amp;&amp; ${FIND} . -name '*.c'
SUBST_FILES.path=       ${C_FILES_CMD:sh}</pre>
</div>
</div>
<div class="paragraph">
<p>The variable name <code>C_FILES_CMD</code> in this example is freely chosen and independent of the SUBST framework.</p>
</div>
<div class="paragraph">
<p>In this variant, the <code>SUBST_FILES.<strong></code> variable lists each file individually. Thereby chances are higher that there are filename patterns in which no substitution happens. Since the SUBST framework cannot know whether the filename patterns in <code>SUBST_FILES.</strong></code> have been explicitly listed in the Makefile (where any redundant filename pattern would be suspicious) or been generated by a shell command (in which redundant filename patterns are more likely and to be expected), it will complain about these redundant filename patterns. Therefore, SUBST blocks that use a shell command to generate the list of filename patterns often need to set <code>SUBST_NOOP_OK.*</code> to <code>yes</code>.</p>
</div>
</div>
<div class="sect3">
<h4 id="_21_1_11_3_choosing_what_to_substitute">21.1.11.3. Choosing what to substitute</h4>
<div class="paragraph">
<p>In most cases, the substitutions are given using one or more <a href="http://man.NetBSD.org/NetBSD-9.2/i386/sed.1">sed(1)</a> commands, like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SUBST_SED.path=         -e 's|/usr/local|${PREFIX}|g'</pre>
</div>
</div>
<div class="paragraph">
<p>Each of the sed commands needs to be preceded by the <code>-e</code> option and should be specified on a line of its own, to avoid hiding short sed commands at the end of a line.</p>
</div>
<div class="paragraph">
<p>Since the sed commands often contain shell metacharacters as the separator (the <code>|</code> in the above example), it is common to enclose them in single quotes.</p>
</div>
<div class="paragraph">
<p>A common substitution is to replace placeholders of the form <code>@VARNAME@</code> with their pkgsrc counterpart variable <code>${VARNAME}</code>. A typical example is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SUBST_VARS.path=        PREFIX</pre>
</div>
</div>
<div class="paragraph">
<p>This type of substitutions is typically done by the GNU configure scripts during the do-configure stage, but in some cases these need to be overridden. The same pattern is also used when a package defines patches that replace previously hard-coded paths like <code>/usr/local</code> with a <code>@PREFIX@</code> placeholder first, which then gets substituted by the actual <code>${PREFIX}</code> in the pre-configure stage. In many of these cases, it works equally well to just use the SUBST framework to directly replace <code>/usr/local</code> with <code>${PREFIX}</code>, thereby omitting the intermediate patch file.</p>
</div>
<div class="paragraph">
<p>If the above is not flexible enough, it is possible to not use sed at all for the substitution but to specify an entirely different command, like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SUBST_FILTER_CMD.path=  LC_ALL=C ${TR} -d '\r'</pre>
</div>
</div>
<div class="paragraph">
<p>This is used for the few remaining packages in which the distributed files use Windows-style line endings that need to be converted to UNIX-style line endings.</p>
</div>
</div>
<div class="sect3">
<h4 id="_21_1_11_4_other_subst_variables">21.1.11.4. Other SUBST variables</h4>
<div class="paragraph">
<p>When a SUBST block is applied during a package build, a message is logged. The default message is fine for most purposes but can be overridden by setting <code>SUBST_MESSAGE.*</code> to an individual message.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_21_2_the_fetch_phase">21.2. The fetch phase</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_21_2_1_packages_whose_distfiles_arent_available_for_plain_downloading">21.2.1. Packages whose distfiles aren&#8217;t available for plain downloading</h3>
<div class="paragraph">
<p>If you need to download from a dynamic URL you can set <code>DYNAMIC_MASTER_SITES</code> and a <strong>make fetch</strong> will call <code>files/getsite.sh</code> with the name of each file to download as an argument, expecting it to output the URL of the directory from which to download it. <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/graphics/ns-cult3d/index.html"><code>graphics/ns-cult3d</code></a> is an example of this usage.</p>
</div>
<div class="paragraph">
<p>If the download can&#8217;t be automated, because the user must submit personal information to apply for a password, or must pay for the source, or whatever, you can set <code>FETCH_MESSAGE</code> to a list of lines that are displayed to the user before aborting the build. Example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>FETCH_MESSAGE=  "Please download the files"
FETCH_MESSAGE+= "    "${DISTFILES:Q}
FETCH_MESSAGE+= "manually from "${MASTER_SITES:Q}"."</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_21_2_2_how_to_handle_modified_distfiles_with_the_old_name">21.2.2. How to handle modified distfiles with the 'old' name</h3>
<div class="paragraph">
<p>Sometimes authors of a software package make some modifications after the software was released, and they put up a new distfile without changing the package&#8217;s version number. If a package is already in pkgsrc at that time, the checksum will no longer match. The contents of the new distfile should be compared against the old one before changing anything, to make sure the distfile was really updated on purpose, and that no trojan horse or so crept in. Please mention that the distfiles were compared and what was found in your commit message.</p>
</div>
<div class="paragraph">
<p>Then, the correct way to work around this is to set <code>DIST_SUBDIR</code> to a unique directory name, usually based on <code>PKGNAME_NOREV</code> (but take care with python or ruby packages, where <code>PKGNAME</code> includes a variable prefix). All <code>DISTFILES</code> and <code>PATCHFILES</code> for this package will be put in that subdirectory of the local distfiles directory. (See <a href="http://netbsd.org/docs/pkgsrc/fixes.html#bumping-pkgrevision">Section 21.1.10, “How to handle incrementing versions when fixing an existing package”</a> for more details.) In case this happens more often, <code>PKGNAME</code> can be used (thus including the <code>nbX</code> suffix) or a date stamp can be appended, like <code>${PKGNAME_NOREV}-YYYYMMDD</code>.</p>
</div>
<div class="paragraph">
<p><code>DIST_SUBDIR</code> is also used when a distfile&#8217;s name does not contain a version and the distfile is apt to change. In cases where the likelihood of this is very small, <code>DIST_SUBDIR</code> might not be required. Additionally, <code>DIST_SUBDIR</code> must not be removed unless the distfile name changes, even if a package is being moved or renamed.</p>
</div>
<div class="paragraph">
<p>Do not forget regenerating the <code>distinfo</code> file after that, since it contains the <code>DIST_SUBDIR</code>path in the filenames. Also, increase the PKGREVISION if the installed package is different. Furthermore, a mail to the package&#8217;s authors seems appropriate telling them that changing distfiles after releases without changing the file names is not good practice.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_2_3_packages_hosted_on_github_com">21.2.3. Packages hosted on github.com</h3>
<div class="paragraph">
<p>Helper methods exist for packages hosted on github.com which will often have distfile names that clash with other packages, for example <code>1.0.tar.gz</code>. Use one of the three recipes from below:</p>
</div>
<div class="sect3">
<h4 id="_21_2_3_1_fetch_based_on_a_tagged_release">21.2.3.1. Fetch based on a tagged release</h4>
<div class="paragraph">
<p>If your distfile URL looks similar to <code><a href="https://github.com/username/example/archive/v1.0.zip" class="bare">https://github.com/username/example/archive/v1.0.zip</a></code>, then you are packaging a tagged release.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTNAME=       example-1.0
MASTER_SITES=   ${MASTER_SITE_GITHUB:=username/}
#GITHUB_PROJECT= example    # can be omitted if same as DISTNAME
GITHUB_TAG=     v${PKGVERSION_NOREV}
EXTRACT_SUFX=   .zip</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_21_2_3_2_fetch_based_on_a_specific_commit_before_the_first_release">21.2.3.2. Fetch based on a specific commit before the first release</h4>
<div class="paragraph">
<p>If your distfile looks similar to <code><a href="https://github.com/username/example/archive/988881adc9fc3655077dc2d4d757d480b5ea0e11" class="bare">https://github.com/username/example/archive/988881adc9fc3655077dc2d4d757d480b5ea0e11</a></code> and is from a commit before the first release, then set the package version to 0.0.0.N, where N is the number of commits to the repository, and set GITHUB_TAG to the commit hash. This will (almost) ensure that the first tagged release will have a version greater than this one so that package upgrades will function properly.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTNAME=       example-0.0.0.347
MASTER_SITES=   ${MASTER_SITE_GITHUB:=username/}
#GITHUB_PROJECT= example    # can be omitted if same as DISTNAME
GITHUB_TAG=     988881adc9fc3655077dc2d4d757d480b5ea0e11</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_21_2_3_3_fetch_based_on_a_specific_commit_after_a_release">21.2.3.3. Fetch based on a specific commit after a release</h4>
<div class="paragraph">
<p>If your distfile looks similar to <code><a href="https://github.com/username/example/archive/988881adc9fc3655077dc2d4d757d480b5ea0e11" class="bare">https://github.com/username/example/archive/988881adc9fc3655077dc2d4d757d480b5ea0e11</a></code> and is from a commit after a release, then include the last release version and the commit count since that release in the package version and set GITHUB_TAG to the commit hash. The latest release and commit count are shown in the output of "git describe --tags":</p>
</div>
<div class="literalblock">
<div class="content">
<pre># git clone https://github.com/username/example
# cd example
# git describe --tags
1.2.3-5-g988881a</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTNAME=       example-1.2.3.5
MASTER_SITES=   ${MASTER_SITE_GITHUB:=username/}
#GITHUB_PROJECT= example    # can be omitted if same as DISTNAME
GITHUB_TAG=     988881adc9fc3655077dc2d4d757d480b5ea0e11</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_21_2_3_4_fetch_based_on_release">21.2.3.4. Fetch based on release</h4>
<div class="paragraph">
<p>If your distfile URL looks similar to <code><a href="https://github.com/username/example/releases/download/rel-1.6/offensive-1.6.zip" class="bare">https://github.com/username/example/releases/download/rel-1.6/offensive-1.6.zip</a></code>, then you are packaging a release.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTNAME=       offensive-1.6
PKGNAME=        ${DISTNAME:S/offensive/proper/}
MASTER_SITES=   ${MASTER_SITE_GITHUB:=username/}
GITHUB_PROJECT= example
GITHUB_RELEASE= rel-${PKGVERSION_NOREV} # usually just set this to ${DISTNAME}
EXTRACT_SUFX=   .zip</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_21_3_the_configure_phase">21.3. The configure phase</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_21_3_1_shared_libraries_libtool">21.3.1. Shared libraries - libtool</h3>
<div class="paragraph">
<p>pkgsrc supports many different machines, with different object formats like a.out and ELF, and varying abilities to do shared library and dynamic loading at all. To accompany this, varying commands and options have to be passed to the compiler, linker, etc. to get the Right Thing, which can be pretty annoying especially if you don&#8217;t have all the machines at your hand to test things. The <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/devel/libtool/index.html"><code>devel/libtool</code></a> pkg can help here, as it just “knows” how to build both static and dynamic libraries from a set of source files, thus being platform-independent.</p>
</div>
<div class="paragraph">
<p>Here&#8217;s how to use libtool in a package in seven simple steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Add <code>USE_LIBTOOL=yes</code> to the package Makefile.</p>
</li>
<li>
<p>For library objects, use “${LIBTOOL} --mode=compile ${CC}” in place of “${CC}”. You could even add it to the definition of <code>CC</code>, if only libraries are being built in a given Makefile. This one command	will build both PIC and non-PIC library objects, so you need not	have separate shared and non-shared library rules.</p>
</li>
<li>
<p>For the linking of the library, remove any “ar”, “ranlib”, and “ld -Bshareable” commands, and instead use:</p>
<div class="literalblock">
<div class="content">
<pre>${LIBTOOL} --mode=link \
${CC} -o ${.TARGET:.a=.la} \
    ${OBJS:.o=.lo} \
    -rpath ${PREFIX}/lib \
    -version-info major:minor</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>Note that the library is changed to have a <code>.la</code> extension, and the objects are changed to have a <code>.lo</code> extension. Change <code>OBJS</code> as necessary. This automatically creates all of the <code>.a</code>, <code>.so.major.minor</code>, and ELF symlinks (if necessary) in the build directory. Be sure to include “-version-info”, especially when major and minor are zero, as libtool will otherwise strip off the shared library version.</p>
</div>
<div class="paragraph">
<p>From the libtool manual:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>So, libtool library versions are described by three integers:    CURRENT
The most recent interface number that this library implements.
REVISION
The implementation number of the CURRENT interface.
AGE
The difference between the newest and oldest interfaces that
this library implements.  In other words, the library implements
all the interface numbers in the range from number `CURRENT -
AGE' to `CURRENT'.
If two libraries have identical CURRENT and AGE numbers, then the
dynamic linker chooses the library with the greater REVISION number.</pre>
</div>
</div>
<div class="paragraph">
<p>The “-release” option will produce different results for a.out and ELF (excluding symlinks) in only one case. An ELF library of the form “libfoo-release.so.<em>x</em>.<em>y</em>” will have a symlink of “libfoo.so.<em>x</em>.<em>y</em>” on an a.out platform. This is handled automatically.</p>
</div>
<div class="paragraph">
<p>The “-rpath argument” is the install directory of the library being built.</p>
</div>
<div class="paragraph">
<p>In the <code>PLIST</code>, include only the <code>.la</code> file, the other files will be added automatically.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When linking shared object (<code>.so</code>)	files, i.e. files that are loaded via <a href="http://man.NetBSD.org/NetBSD-9.2/i386/dlopen.3">dlopen(3)</a>, NOT shared libraries, use “-module -avoid-version” to prevent them getting version tacked on.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The <code>PLIST</code> file gets the <code>foo.so</code> entry.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When linking programs that depend on these libraries <em>before</em> they are installed, preface the <a href="http://man.NetBSD.org/NetBSD-9.2/i386/cc.1">cc(1)</a> or <a href="http://man.NetBSD.org/NetBSD-9.2/i386/ld.1">ld(1)</a> line with “${LIBTOOL} --mode=link”, and it will find the correct libraries (static or shared), but please be aware that libtool will not allow you to specify a relative path in -L (such as “-L../somelib”), because it	expects you to change that argument to be the <code>.la</code> file. e.g.</p>
<div class="literalblock">
<div class="content">
<pre>${LIBTOOL} --mode=link ${CC} -o someprog -L../somelib -lsomelib</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>should be changed to:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>${LIBTOOL} --mode=link ${CC} -o someprog ../somelib/somelib.la</pre>
</div>
</div>
<div class="paragraph">
<p>and it will do the right thing with the libraries.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>When installing libraries, preface the install(1) or cp(1) command with “${LIBTOOL} --mode=install”, and change the library name to .la. e.g.</p>
<div class="literalblock">
<div class="content">
<pre>${LIBTOOL} --mode=install ${BSD_INSTALL_LIB} ${SOMELIB:.a=.la} ${PREFIX}/lib</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>This will install the static <code>.a</code>, shared library, any needed symlinks, and run <a href="http://man.NetBSD.org/NetBSD-9.2/i386/ldconfig.8">ldconfig(8)</a>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In your <code>PLIST</code>, include only the <code>.la</code> file (this is a change from previous behaviour).</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_21_3_2_using_libtool_on_gnu_packages_that_already_support_libtool">21.3.2. Using libtool on GNU packages that already support libtool</h3>
<div class="paragraph">
<p>Add <code>USE_LIBTOOL=yes</code> to the package Makefile. This will override the package&#8217;s own libtool in most cases.  For older libtool using packages,  libtool is made by ltconfig script during the do-configure step; you can check the libtool script location by doing <strong>make configure; find work*/ -name libtool</strong>.</p>
</div>
<div class="paragraph">
<p><code>LIBTOOL_OVERRIDE</code> specifies which libtool scripts, relative to <code>WRKSRC</code>, to override.  By default, it is set to “libtool <strong>/libtool */</strong>/libtool”.  If this does not match the location of the package&#8217;s libtool script(s), set it as appropriate.</p>
</div>
<div class="paragraph">
<p>If you do not need <code>*.a</code> static libraries built and installed, then use <code>SHLIBTOOL_OVERRIDE</code> instead.</p>
</div>
<div class="paragraph">
<p>If your package makes use of the platform-independent library for loading dynamic shared objects, that comes with libtool (libltdl), you should include devel/libltdl/buildlink3.mk.</p>
</div>
<div class="paragraph">
<p>Some packages use libtool incorrectly so that the package may not work or build in some circumstances. Some of the more common errors are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The inclusion of a shared object (-module) as a dependent library in an executable or library. This in itself isn&#8217;t a problem if one of two things has been done:</p>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>The shared object is named correctly, i.e. <code>libfoo.la</code>, not <code>foo.la</code></p>
</li>
<li>
<p>The -dlopen option is used when linking an executable.</p>
</li>
</ol>
</div>
</li>
<li>
<p>The use of libltdl without the correct calls to initialisation routines. The function lt_dlinit() should be called and the macro <code>LTDL_SET_PRELOADED_SYMBOLS</code> included in executables.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_21_3_3_gnu_autoconfautomake">21.3.3. GNU Autoconf/Automake</h3>
<div class="paragraph">
<p>If a package needs GNU autoconf or automake to be executed to regenerate the <code>configure</code> script and <code>Makefile.in</code> makefile templates from <code>configure.ac</code> and <code>Makefile.am</code>, then they should be executed in a pre-configure target:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>USE_TOOLS+=	autoconf automake autoreconf
GNU_CONFIGURE=	yes
...
pre-configure:
        set -e; cd ${WRKSRC} &amp;&amp; autoreconf -fi
...</pre>
</div>
</div>
<div class="paragraph">
<p>Packages which use GNU Automake will sometimes require GNU Make (<code>gmake</code> in <code>USE_TOOLS</code>), but not always.  Note that autoreconf only needs to be executed if <code>configure.ac</code> or Makefiles are modified, or <code>configure</code> is not present.</p>
</div>
<div class="paragraph">
<p>There are times when the configure process makes additional changes to the generated files, which then causes the build process to try to re-execute the automake sequence. This is prevented by touching various files in the configure stage. If this causes problems with your package you can set <code>AUTOMAKE_OVERRIDE=NO</code> in the package Makefile.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_3_4_meson_ninja">21.3.4. Meson / ninja</h3>
<div class="paragraph">
<p>Packages using Meson to configure need to include:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.include "../../devel/meson/build.mk"</pre>
</div>
</div>
<div class="paragraph">
<p>In nearly all cases (any program with dependencies), pkg-config needs to be added to <code>USE_TOOLS</code>.  If the package installs translation files for non-English languages, also add msgfmt and xgettext:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>USE_TOOLS+=	pkg-config msgfmt xgettext</pre>
</div>
</div>
<div class="paragraph">
<p>If any options need to be passed to Meson, use <code>MESON_ARGS</code> instead of <code>CONFIGURE_ARGS</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MESON_ARGS+=	-Dx11=false</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_21_4_programming_languages">21.4. Programming languages</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_21_4_1_c_c_and_fortran">21.4.1. C, C++, and Fortran</h3>
<div class="paragraph">
<p>Compilers for the C and C++ languages comes with the NetBSD base system. By default, pkgsrc assumes that a package is written in C and will hide all other compilers (via the wrapper framework, see <a href="http://netbsd.org/docs/pkgsrc/buildlink.html">Chapter 18, Buildlink methodology</a>).</p>
</div>
<div class="paragraph">
<p>To declare which language&#8217;s compiler a package needs, set the <code>USE_LANGUAGES</code> variable. Allowed values currently are:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>   c99, c++, c++03, gnu++03, c++0x, gnu++0x, c++11, gnu++11,
c++14, gnu++14, c++17, gnu++17, c++20, gnu++20, fortran,
fortran77, java, objc, obj-c++, and ada.</pre>
</div>
</div>
<div class="paragraph">
<p>(and any combination).  The default is “c”. Packages using GNU configure scripts, even if written in C++, usually need a C compiler for the configure phase.</p>
</div>
<div class="paragraph">
<p>To express a general requirement on a specific C or C version, normally only ``GCC_REQD`` needs to be set. For example, GCC 7 includes support for C17, so if the package uses C++17 it should specify:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>GCC_REQD+=	7</pre>
</div>
</div>
<div class="paragraph">
<p>Language variants like ``c11`` for ``USE_LANGUAGES`` should only be specified if the package does not explicitly set ``-std=...`` when compiling (i.e. the package assumes the compiler defaults to C11 or some other standard).  This is usually a bug in the upstream build system.</p>
</div>
<div class="paragraph">
<p>GCC version 5 includes support for C14, while GCC 4.7 includes more-or-less complete support for C11.  For more information, consult <a href="https://gcc.gnu.org/projects/cxx-status.html">GCC&#8217;s own documentation on programming language support.</a></p>
</div>
</div>
<div class="sect2">
<h3 id="_21_4_2_java">21.4.2. Java</h3>
<div class="paragraph">
<p>If a program is written in Java, use the Java framework in pkgsrc. The package must include <code>../../mk/java-vm.mk</code>.This Makefile fragment provides the following variables:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>USE_JAVA</code> defines if a build dependency on the JDK is added. If <code>USE_JAVA</code> is set to “run”, then there is only a runtime dependency on the JDK. The default is “yes”, which also adds a build dependency on the JDK.</p>
</li>
<li>
<p>Set <code>USE_JAVA2</code> to declare that a package needs a Java2 implementation. The supported values are “yes”, “1.4”, and “1.5”. “yes” accepts any Java2 implementation, “1.4” insists on versions 1.4 or above, and “1.5” only accepts versions 1.5 or above. This variable is not set by default.</p>
</li>
<li>
<p><code>PKG_JAVA_HOME</code> is automatically set to the runtime location of the used Java implementation dependency. It may be used to set <code>JAVA_HOME</code> to a good value if the program needs this variable to be defined.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_21_4_3_go">21.4.3. Go</h3>
<div class="paragraph">
<p>If a program is written in Go and has any dependencies on other Go modules, have the package include <code>../../lang/go/go-module.mk</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate a list of those dependencies with <strong>make clean &amp;&amp; make patch &amp;&amp; make show-go-modules &gt; go-modules.mk</strong>.</p>
</li>
<li>
<p>Prepend <code>.include "go-modules.mk"</code> to any other <code>.include</code>s.</p>
</li>
<li>
<p>Incorporate these modules in <code>distinfo</code> with <strong>make makesum</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_21_4_4_rust">21.4.4. Rust</h3>
<div class="paragraph">
<p>If a program is written in Rust and uses Cargo to build, have the package include <code>../../lang/rust/cargo.mk</code>.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate a list of those dependencies with <strong>make CARGO_ARGS="build --release" build &amp;&amp; make print-cargo-depends &gt; cargo-depends.mk</strong>.</p>
</li>
<li>
<p>Prepend <code>.include "cargo-depends.mk"</code> to any other <code>.include</code>s.</p>
</li>
<li>
<p>Incorporate these modules in <code>distinfo</code> with <strong>make makesum</strong>.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_21_4_5_packages_containing_perl_scripts">21.4.5. Packages containing Perl scripts</h3>
<div class="paragraph">
<p>If your package contains interpreted Perl scripts, add “perl” to the <code>USE_TOOLS</code> variable and set <code>REPLACE_PERL</code> to ensure that the proper interpreter path is set. <code>REPLACE_PERL</code> should contain a list of scripts, relative to <code>WRKSRC</code>, that you want adjusted. Every occurrence of <code>*/bin/perl</code> in a she-bang line will be replaced with the full path to the Perl executable.</p>
</div>
<div class="paragraph">
<p>If a particular version of Perl is needed, set the <code>PERL5_REQD</code> variable to the version number. The default is “5.0”.</p>
</div>
<div class="paragraph">
<p>See <a href="http://netbsd.org/docs/pkgsrc/fixes.html#perl-modules">Section 21.6.6, “Packages installing Perl modules”</a> for information about handling Perl modules.</p>
</div>
<div class="paragraph">
<p>There is also the <code>REPLACE_PERL6</code> variable for the language now known as Raku.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_4_6_packages_containing_shell_scripts">21.4.6. Packages containing shell scripts</h3>
<div class="paragraph">
<p><code>REPLACE_SH</code>, <code>REPLACE_BASH</code>, <code>REPLACE_CSH</code>, and <code>REPLACE_KSH</code> can be used to replace shell she-bangs in files. Please use the appropriate one, preferring <code>REPLACE_SH</code> when this shell is sufficient. Each should contain a list of scripts, relative to <code>WRKSRC</code>, that you want adjusted. Every occurrence of the matching shell in a she-bang line will be replaced with the full path to the shell executable. When using <code>REPLACE_BASH</code>, don&#8217;t forget to add <code>bash</code> to <code>USE_TOOLS</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_4_7_other_programming_languages">21.4.7. Other programming languages</h3>
<div class="paragraph">
<p>There are further similar REPLACE variables available, e.g., <code>REPLACE_AWK</code> for packages containing awk scripts, and <code>REPLACE_R</code> for R. These two, like the others noted above, have their actions defined centrally in <code>mk/configure/replace-interpreter.mk</code>. Other languages define the actions of these variables within their own dedicated part of the tree, e.g., <code>REPLACE_PHP</code> is actioned in <code>lang/php/phpversion.mk</code>, and <code>REPLACE_PYTHON</code> is actioned in <code>lang/python/application.mk</code>. For other languages, consult the mk files found within their specific directories (the naming convention varies), or check the list found in <a href="http://netbsd.org/docs/pkgsrc/help-topics.html">Appendix E, Help topics</a>.</p>
</div>
<div class="paragraph">
<p>Currently, special handling for other languages varies in pkgsrc. If a compiler package provides a <code>buildlink3.mk</code> file, include that, otherwise just add a (build) dependency on the appropriate compiler package.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_21_5_the_build_phase">21.5. The build phase</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The most common failures when building a package are that some platforms do not provide certain header files, functions or libraries, or they provide the functions in a library that the	original package author didn&#8217;t know. To work around this, you can rewrite the source code in most cases so that it does not use the missing functions or provides a replacement function.</p>
</div>
<div class="sect2">
<h3 id="_21_5_1_compiling_c_and_c_code_conditionally">21.5.1. Compiling C and C++ code conditionally</h3>
<div class="paragraph">
<p>If a package already comes with a GNU configure script, the	preferred way to fix the build failure is to change the configure script, not the code. In the other cases, you can	utilize the C preprocessor, which defines certain macros depending on the operating system and hardware architecture it	compiles for. These macros can be queried using for example	#if defined(<em>__i386). Almost every operating	system, hardware architecture and compiler has its own macro. For example, if the macros __GNUC__</em>, __i386__ and __NetBSD__ are all defined, you know that you are using NetBSD on an i386 compatible CPU, and your compiler is GCC.</p>
</div>
<div class="paragraph">
<p>The list of the following macros for hardware and operating system depends on the compiler that is used. For example, if you want to conditionally compile code on Solaris, don&#8217;t use <em>__sun__</em> , as the SunPro compiler	does not define it. Use __sun instead.</p>
</div>
<div class="sect4">
<h5 id="_21_5_1_1_c_preprocessor_macros_to_identify_the_operating_system">21.5.1.1. C preprocessor macros to identify the operating system</h5>
<div class="paragraph">
<p>To distinguish between specific NetBSD versions, you should use the following code.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>#ifdef __NetBSD__
#include &lt;sys/param.h&gt;
#if __NetBSD_Prereq__(9,99,17)
/* use a newer feature */
#else
/* older code */
#endif
#endif
#ifndef _WIN32
/* Unix-like specific code */
#endif</pre>
</div>
</div>
<div class="paragraph">
<p>To distinguish between 4.4 BSD-derived systems and the rest of the world, you should use the following code.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>#include &lt;sys/param.h&gt;
#if (defined(BSD) &amp;&amp; BSD &gt;= 199306)
/* BSD-specific code goes here */
#else
/* non-BSD-specific code goes here */
#endif</pre>
</div>
</div>
<div class="paragraph">
<p>You can also test for the following macros:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Cygwin      __CYGWIN__
DragonFly   __DragonFly__
FreeBSD     __FreeBSD__
Haiku       __HAIKU__
Interix     __INTERIX
IRIX        __sgi (TODO: get a definite source for this)
Linux       __linux
Mac OS X    __APPLE__
MirBSD      __MirBSD__ (__OpenBSD__ is also defined)
Minix3      __minix
NetBSD      __NetBSD__
OpenBSD     __OpenBSD__
Solaris     sun, __sun</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_21_5_1_2_c_preprocessor_macros_to_identify_the_hardware_architecture">21.5.1.2. C preprocessor macros to identify the hardware architecture</h5>
<div class="literalblock">
<div class="content">
<pre>i386        i386, __i386, __i386__
x86-64      __amd64__, __x86_64__
ARM         __arm__
MIPS        __mips
SPARC       sparc, __sparc
PowerPC     __powerpc</pre>
</div>
</div>
</div>
<div class="sect4">
<h5 id="_21_5_1_3_c_preprocessor_macros_to_identify_the_compiler">21.5.1.3. C preprocessor macros to identify the compiler</h5>
<div class="literalblock">
<div class="content">
<pre>GCC         __GNUC__ (major version), __GNUC_MINOR__
MIPSpro     _COMPILER_VERSION (0x741 for MIPSpro 7.41)
SunPro      __SUNPRO_C (0x570 for Sun C 5.7)
SunPro C++  __SUNPRO_CC (0x580 for Sun C++ 5.8)</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_21_5_2_how_to_handle_compiler_bugs">21.5.2. How to handle compiler bugs</h3>
<div class="paragraph">
<p>Some source files trigger bugs in the compiler, based on combinations of compiler version and architecture and almost always relation to optimisation being enabled. Common symptoms are gcc internal errors or never finishing compiling a	file.</p>
</div>
<div class="paragraph">
<p>Typically, a workaround involves testing the <code>MACHINE_ARCH</code> and compiler version, disabling optimisation for that combination of file, <code>MACHINE_ARCH</code> and compiler.</p>
</div>
<div class="paragraph">
<p>This used to be a big problem in the past, but is rarely needed now as compiler technology has matured. If you still need to add a compiler specific workaround, please do so in the file <code>hacks.mk</code> and describe the symptom and	compiler version as detailed as possible.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_5_3_no_such_file_or_directory">21.5.3. No such file or directory</h3>
<div class="paragraph">
<p>Compilation sometimes fails with an error message like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>.../x11/gtk3/work/gtk+-3.24.12/gdk/gdktypes.h:35:10:
fatal error: pango/pango.h: No such file or directory</pre>
</div>
</div>
<div class="paragraph">
<p>The proper way to fix this problem depends on the type of the header, which is described in the following sections.</p>
</div>
<div class="sect3">
<h4 id="_21_5_3_1_headers_from_other_packages">21.5.3.1. Headers from other packages</h4>
<div class="paragraph">
<p>If the header name looks like it comes from a different package, that other package should be included via the buildlink3 framework.</p>
</div>
<div class="paragraph">
<p>First, look whether the header is somewhere in the buildlink3 directory below <code>WRKDIR</code>. In the above case of the missing Pango header:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ find work/.buildlink/ -print | grep -F pango/pango.h</pre>
</div>
</div>
<div class="paragraph">
<p>In the case of Pango, the output is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>work/.buildlink/include/pango-1.0/pango/pango.h</pre>
</div>
</div>
<div class="paragraph">
<p>If the <code>pango/pango.h</code> file were placed directly in the <code>.buildlink</code> directory, it would have been found automatically. There is an extra <code>pango-1.0</code> path component though, which means that the compiler command line must contain an option of the form <code>-I${BUILDLINK3_PREFIX.pango}/include/pango-1.0</code>. In most cases this option is generated by the configure script, which can be examined using:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ $ grep -o '[-]I[^[:space:]]*/pango[^[:space:]]*' work/*/Makefile
-I/usr/pkg/include/pango-1.0
-I/usr/pkg/include/pango-1.0
-I/usr/pkg/include/pango-1.0
-I/usr/pkg/include/pango-1.0
-I/usr/pkg/include/pango-1.0</pre>
</div>
</div>
<div class="paragraph">
<p>This looks good. These options are transformed by the buildlink wrapper to refer to the correct path inside <code>work/.buildlink</code>.</p>
</div>
<div class="paragraph">
<p>Since the compilation fails though, examine the compiler command lines in <code>work/.work.log</code> to see whether the <code>-I</code> option is included in the particular command line.</p>
</div>
<div class="paragraph">
<p>To further analyze the situation, run <strong>bmake build-env</strong>, which sets up an interactive, realistic environment including all the pkgsrc wrapper commands and environment variables. From there, try to compile some simple example programs that use the header.</p>
</div>
</div>
<div class="sect3">
<h4 id="_21_5_3_2_headers_generated_during_the_build">21.5.3.2. Headers generated during the build</h4>
<div class="paragraph">
<p>If the name of the header seems to come from the package itself, and if the build is run with parallel jobs, the package may have some undeclared dependencies between the <code>.c</code> and the <code>.h</code> files, and a C file is compiled before its required header is generated.</p>
</div>
<div class="paragraph">
<p>To see whether the build runs with parallel jobs, run <strong>bmake show-all-build | grep JOBS</strong>. Its output looks like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>usr   MAKE_JOBS=              7
pkg   MAKE_JOBS_SAFE          # undefined
def   _MAKE_JOBS_N=           7</pre>
</div>
</div>
<div class="paragraph">
<p>In this case the pkgsrc user has asked pkgsrc to build packages with 7 jobs in parallel (<code>MAKE_JOBS</code>). The package could have disabled parallel builds by setting <code>MAKE_JOBS_SAFE</code> to <code>no</code>, but in this case it hasn&#8217;t.</p>
</div>
<div class="paragraph">
<p>To see whether the build failure is caused by parallel builds, first save the exact error message and a bit of context, maybe you need it later for reporting a bug. Next, run:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MAKE_JOBS_SAFE=no bmake clean build</pre>
</div>
</div>
<div class="paragraph">
<p>If that succeeds, <a href="https://www.NetBSD.org/cgi-bin/sendpr.cgi?gndb=netbsd">file a bug report</a> against the pkgsrc package, including the exact error message and the contents of your <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> file.</p>
</div>
</div>
<div class="sect3">
<h4 id="_21_5_3_3_symlinks">21.5.3.3. Symlinks</h4>
<div class="paragraph">
<p>Pkgsrc does not work reliably if any of <code>LOCALBASE</code>, <code>VARBASE</code> or <code>WRKDIR</code> contains a symlink. Since 2019Q2, the pkgsrc bootstrap program prevents installing pkgsrc in symlink-based directories. Existing pkgsrc installations are not checked for symlinks though.</p>
</div>
<div class="paragraph">
<p>The "No such file or directory" error messages are a typical symptom of symlinks, and it&#8217;s quite difficult to find out that this is the actual cause.</p>
</div>
</div>
<div class="sect3">
<h4 id="_21_5_3_4_stale_working_directories">21.5.3.4. Stale working directories</h4>
<div class="paragraph">
<p>When building a hierarchy of packages, it may happen that one package is built and then pkgsrc is updated. This situation can provoke various hard to diagnose build errors. To clean up the situation:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ (cd ../../ &amp;&amp; cat mk/bsd.pkg.mk &gt;/dev/null &amp;&amp; rm -rf */*/work)</pre>
</div>
</div>
<div class="paragraph">
<p>(The only purpose of the <code>bsd.pkg.mk</code> is to prevent running this command in the wrong directory.)</p>
</div>
<div class="paragraph">
<p>If you have set <code>WRKOBJDIR</code> in <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>, remove that directory as well.</p>
</div>
</div>
<div class="sect3">
<h4 id="_21_5_3_5_other_possible_reasons">21.5.3.5. Other possible reasons</h4>
<div class="paragraph">
<p>On platforms other than BSD, third-party packages are installed in <code>/usr/include</code>, together with the base system. This means that pkgsrc cannot distinguish between headers provided by the base system (which it needs) and headers from third-party packages (which are often included in pkgsrc as well). This can lead to subtle version mismatches.</p>
</div>
<div class="paragraph">
<p>In pkgsrc installations that have been active for several years, it may happen that some files are manually deleted. To exclude this unlikely reason, run <strong>pkg_admin check</strong>.</p>
</div>
<div class="paragraph">
<p>It may help to run <strong>pkg_admin rebuild-tree</strong> to check/fix dependencies.</p>
</div>
<div class="paragraph">
<p>If all of the above doesn&#8217;t help, see <a href="http://netbsd.org/docs/pkgsrc/help-user.html">Chapter 2, Getting help</a> for contact information. Be prepared to describe what you have tried so far and what any error messages were.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_21_5_4_undefined_reference_to">21.5.4. Undefined reference to “&#8230;&#8203;”</h3>
<div class="paragraph">
<p>This error message often means that a package did not link to a shared library it needs. The following functions are known to cause this error message over and over.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 33.3333%;">
<col style="width: 33.3333%;">
<col style="width: 33.3334%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top"><strong>Function</strong></th>
<th class="tableblock halign-left valign-top"><strong>Library</strong></th>
<th class="tableblock halign-left valign-top"><strong>Affected platforms</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">accept, bind, connect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-lsocket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solaris</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">crypt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-lcrypt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DragonFly, NetBSD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dlopen, dlsym</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-ldl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gethost*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-lnsl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solaris</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">inet_aton</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-lresolv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solaris</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nanosleep, sem_*, timer_*</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-lrt</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Solaris</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">openpty</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-lutil</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Linux</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>To fix these linker errors, it is often sufficient to add <code>LIBS.<em>OperatingSystem+= -lfoo</em></code> to the package <code>Makefile</code> and then run <strong>bmake clean; bmake</strong>.</p>
</div>
<div class="sect3">
<h4 id="_21_5_4_1_the_sunpro_compiler_and_inline_functions">21.5.4.1. The SunPro compiler and inline functions</h4>
<div class="paragraph">
<p>When you are using the SunPro compiler, there is another possibility. That compiler cannot handle the following code:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>extern int extern_func(int);
static inline int
inline_func(int x)
{
        return extern_func(x);
}</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>int main(void)
{
        return 0;
}</pre>
</div>
</div>
<div class="paragraph">
<p>It generates the code for <code>inline_func</code> even if that function is never used. This code then refers to <code>extern_func</code>, which can usually not be resolved. To solve this problem you can try to tell the package to disable inlining of functions.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_21_5_5_running_out_of_memory">21.5.5. Running out of memory</h3>
<div class="paragraph">
<p>Sometimes packages fail to build because the compiler runs into an operating system specific soft limit. With the <code>UNLIMIT_RESOURCES</code> variable pkgsrc can be told to unlimit the resources. The allowed values are any combination of “cputime”, “datasize”, “memorysize”, “stacksize” and “virtualsize”. Setting this variable is similar to running the shell builtin <strong>ulimit</strong> command to raise the maximum data segment size or maximum stack size of a process, respectively, to their hard limits.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_21_6_the_install_phase">21.6. The install phase</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_21_6_1_creating_needed_directories">21.6.1. Creating needed directories</h3>
<div class="paragraph">
<p>The BSD-compatible <strong>install</strong> supplied with some operating systems cannot create more than one directory at a time. As such, you should call <code>${INSTALL_*_DIR}</code> like this:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>${INSTALL_DATA_DIR} ${PREFIX}/dir1
${INSTALL_DATA_DIR} ${PREFIX}/dir2</pre>
</div>
</div>
<div class="paragraph">
<p>Instead of running the <strong>install</strong> commands directly, you can also append “dir1 dir2” to the <code>INSTALLATION_DIRS</code> variable, which will automatically do the right thing.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_2_where_to_install_documentation">21.6.2. Where to install documentation</h3>
<div class="paragraph">
<p>In general, documentation should be installed into <code>${PREFIX}/share/doc/${PKGBASE}</code> or <code>${PREFIX}/share/doc/${PKGNAME_NOREV}</code> (the latter includes the version number of the package).</p>
</div>
<div class="paragraph">
<p>Many modern packages using GNU autoconf allow to set the directory where HTML documentation is installed with the “--with-html-dir” option. Sometimes using this flag is needed because otherwise the documentation ends up in <code>${PREFIX}/share/doc/html</code> or other places. In pkgsrc, the HTML documentation should go into the package-specific directory, just like any other documentation.</p>
</div>
<div class="paragraph">
<p>An exception to the above is that library API documentation generated with the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/textproc/gtk-doc/index.html"><code>textproc/gtk-doc</code></a> tools, for use by special browsers (devhelp) should be left at their default location, which is <code>${PREFIX}/share/gtk-doc</code>.  Such documentation can be recognized from files ending in <code>.devhelp</code> or <code>.devhelp2</code>. (It is also acceptable to install such files in <code>${PREFIX}/share/doc/${PKGBASE}</code> or <code>${PREFIX}/share/doc/${PKGNAME}</code>; the <code>.devhelp*</code> file must be directly in that directory then, no additional subdirectory level is allowed in this case. This is usually achieved by using “--with-html-dir=${PREFIX}/share/doc”. <code>${PREFIX}/share/gtk-doc</code> is preferred though.)</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_3_installing_highscore_files">21.6.3. Installing highscore files</h3>
<div class="paragraph">
<p>Certain packages, most of them in the games category, install a score file that allows all users on the system to record their highscores. In order for this to work, the binaries need to be installed setgid and the score files owned by the appropriate group and/or owner (traditionally the "games" user/group). Set <code>USE_GAMESGROUP</code> to yes to support this. The following variables, documented in more detail in <code>mk/defaults/mk.conf</code>, control this behaviour: <code>GAMEDATAMODE</code>, <code>GAMEDIRMODE</code>, <code>GAMES_GROUP</code>, <code>GAMEMODE</code>, <code>GAME_USER</code>. Other useful variables are: <code>GAMEDIR_PERMS</code>, <code>GAMEDATA_PERMS</code> and <code>SETGID_GAMES_PERMS</code>.</p>
</div>
<div class="paragraph">
<p>An example that illustrates some of the variables described above is <code>games/moon-buggy</code>. <code>OWN_DIRS_PERMS</code> is used to properly set directory permissions of the directory where the scorefile is saved, <code>REQD_FILES_PERMS</code> is used to create a dummy scorefile (<code>mbscore</code>) with the proper permissions and <code>SPECIAL_PERMS</code> is used to install setgid the game binary:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>USE_GAMESGROUP=         yes
BUILD_DEFS+=            VARBASE
OWN_DIRS_PERMS+=        ${VARBASE}/games/moon-buggy ${GAMEDIR_PERMS}
REQD_FILES_PERMS+=      /dev/null ${VARBASE}/games/moon-buggy/mbscore ${GAMEDATA_PERMS}
SPECIAL_PERMS+=         ${PREFIX}/bin/moon-buggy ${SETGID_GAMES_PERMS}</pre>
</div>
</div>
<div class="paragraph">
<p>Various <code>INSTALL_*</code> variables are also available: <code>INSTALL_GAME</code> to install setgid game binaries, <code>INSTALL_GAME_DIR</code> to install game directories that are needed to be accessed by setgid games and <code>INSTALL_GAME_DATA</code> to install scorefiles.</p>
</div>
<div class="paragraph">
<p>A package should therefore never hard code file ownership or access permissions but rely on <code>*_PERMS</code> as described above or alternatively on <code>INSTALL_GAME</code>,   <code>INSTALL_GAME_DATA</code> and <code>INSTALL_GAME_DIR</code> to set these correctly.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_4_adding_destdir_support_to_packages">21.6.4. Adding DESTDIR support to packages</h3>
<div class="paragraph">
<p><code>DESTDIR</code> support means that a package installs into a staging directory, not the final location of the files. Then a binary package is created which can be used for installation as usual. There are two ways: Either the package must install as root (“destdir”) or the package can install as non-root user (“user-destdir”).</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>PKG_DESTDIR_SUPPORT</code> has to be set to “destdir” or “user-destdir”. By default <code>PKG_DESTDIR_SUPPORT</code> is set to “user-destdir” to help catching more potential packaging problems. If bsd.prefs.mk is included in the Makefile, <code>PKG_DESTDIR_SUPPORT</code> needs to be set before the inclusion.</p>
</li>
<li>
<p>All installation operations have to be prefixed with <code>${DESTDIR}</code>.</p>
</li>
<li>
<p>automake gets this DESTDIR mostly right automatically. Many manual rules and pre/post-install often are incorrect; fix them.</p>
</li>
<li>
<p>If files are installed with special owner/group use <code>SPECIAL_PERMS</code>.</p>
</li>
<li>
<p>In general, packages should support <code>UNPRIVILEGED</code> to be able to use DESTDIR.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_5_packages_with_hardcoded_paths_to_other_interpreters">21.6.5. Packages with hardcoded paths to other interpreters</h3>
<div class="paragraph">
<p>Your package may also contain scripts with hardcoded paths to other interpreters besides (or as well as) Perl.  To correct the full pathname to the script interpreter, you need to set the following definitions in your <code>Makefile</code> (we shall use <strong>tclsh</strong> in this example):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>REPLACE_INTERPRETER+=   tcl
REPLACE.tcl.old=        .*/bin/tclsh
REPLACE.tcl.new=        ${PREFIX}/bin/tclsh
REPLACE_FILES.tcl=      # list of tcl scripts which need to be fixed,
# relative to ${WRKSRC}, just as in REPLACE_PERL</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_6_packages_installing_perl_modules">21.6.6. Packages installing Perl modules</h3>
<div class="paragraph">
<p>Makefiles of packages providing perl5 modules should include the Makefile fragment <code>../../lang/perl5/module.mk</code>. It provides a <strong>do-configure</strong> target for the standard perl configuration for such modules as well as various hooks to tune this configuration. See comments in this file for details.</p>
</div>
<div class="paragraph">
<p>Perl5 modules will install into different places depending on the version of perl used during the build process. To address this, pkgsrc will append lines to the <code>PLIST</code> corresponding to the files listed in the installed <code>.packlist</code> file generated by most perl5 modules. This is invoked by defining <code>PERL5_PACKLIST</code> to a space-separated list of packlist files relative to <code>PERL5_PACKLIST_DIR</code> (<code>PERL5_INSTALLVENDORARCH</code> by default), e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>PERL5_PACKLIST= auto/Pg/.packlist</pre>
</div>
</div>
<div class="paragraph">
<p>The perl5 config variables <code>installarchlib</code>, <code>installscript</code>, <code>installvendorbin</code>, <code>installvendorscript</code>, <code>installvendorarch</code>, <code>installvendorlib</code>, <code>installvendorman1dir</code>, and <code>installvendorman3dir</code> represent those locations in which components of perl5 modules may be installed, provided as variable with uppercase and prefixed with <code>PERL5_</code>, e.g. <code>PERL5_INSTALLARCHLIB</code> and may be used by perl5 packages that don&#8217;t have a packlist. These variables are also substituted for in the <code>PLIST</code> as uppercase prefixed with <code>PERL5_SUB_</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_7_packages_installing_info_files">21.6.7. Packages installing info files</h3>
<div class="paragraph">
<p>Some packages install info files or use the “makeinfo”  or “install-info” commands.  <code>INFO_FILES</code> should be defined in the package Makefile so that <code>INSTALL</code> and <code>DEINSTALL</code> scripts will be generated to handle registration of the info files in the Info directory file. The “install-info” command used for the info files registration is either provided by the system, or by a special purpose package automatically added as dependency if needed.</p>
</div>
<div class="paragraph">
<p><code>PKGINFODIR</code> is the directory under <code>${PREFIX}</code> where info files are primarily located. <code>PKGINFODIR</code> defaults to “info” and can be overridden by the user.</p>
</div>
<div class="paragraph">
<p>The info files for the package should be listed in the package <code>PLIST</code>; however any split info files need not be listed.</p>
</div>
<div class="paragraph">
<p>A package which needs the “makeinfo” command at build time must add “makeinfo” to <code>USE_TOOLS</code> in its Makefile. If a minimum version of the “makeinfo” command is needed it should be noted with the <code>TEXINFO_REQD</code> variable in the package <code>Makefile</code>. By default, a minimum version of 3.12 is required. If the system does not provide a <strong>makeinfo</strong> command or if it does not match the required minimum, a build dependency on the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/devel/gtexinfo/index.html"><code>devel/gtexinfo</code></a> package will be added automatically.</p>
</div>
<div class="paragraph">
<p>The build and installation process of the software provided by the package should not use the <strong>install-info</strong> command as the registration of info files is the task of the package <code>INSTALL</code> script, and it must use the appropriate <strong>makeinfo</strong> command.</p>
</div>
<div class="paragraph">
<p>To achieve this goal, the pkgsrc infrastructure creates overriding scripts for the <strong>install-info</strong> and <strong>makeinfo</strong> commands in a directory listed early in <code>PATH</code>.</p>
</div>
<div class="paragraph">
<p>The script overriding <strong>install-info</strong> has no effect except the logging of a message. The script overriding <strong>makeinfo</strong> logs a message and according to the value of <code>TEXINFO_REQD</code> either runs the appropriate <strong>makeinfo</strong> command or exit on error.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_8_packages_installing_man_pages">21.6.8. Packages installing man pages</h3>
<div class="paragraph">
<p>All packages that install manual pages should install them into the same directory, so that there is one common place to look for them. In pkgsrc, this place is <code>${PREFIX}/${PKGMANDIR}</code>, and this expression should be used in packages. The default for <code>PKGMANDIR</code> is “<code>man</code>”. Another often-used value is “<code>share/man</code>”.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Note</strong>
The support for a custom <code>PKGMANDIR</code> is far from complete.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The <code>PLIST</code> files can just use <code>man/</code> as the top level directory for the man page file entries, and the pkgsrc framework will convert as needed. In all other places, the correct <code>PKGMANDIR</code> must be used.</p>
</div>
<div class="paragraph">
<p>Packages that are configured with <code>GNU_CONFIGURE</code> set as “yes”, by default will use the <code>./configure</code> --mandir switch to set where the man pages should be installed. The path is <code>GNU_CONFIGURE_MANDIR</code> which defaults to <code>${PREFIX}/${PKGMANDIR}</code>.</p>
</div>
<div class="paragraph">
<p>Packages that use <code>GNU_CONFIGURE</code> but do not use --mandir, can set <code>CONFIGURE_HAS_MANDIR</code> to “no”. Or if the <code>./configure</code> script uses a non-standard use of --mandir, you can set <code>GNU_CONFIGURE_MANDIR</code> as needed.</p>
</div>
<div class="paragraph">
<p>See <a href="http://netbsd.org/docs/pkgsrc/plist.html#manpage-compression">Section 19.5, “Man page compression”</a> for information on installation of compressed manual pages.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_9_packages_installing_x11_fonts">21.6.9. Packages installing X11 fonts</h3>
<div class="paragraph">
<p>If a package installs font files, you will need to rebuild the fonts database in the directory where they get installed at installation and deinstallation time. This can be automatically done by using the pkginstall framework.</p>
</div>
<div class="paragraph">
<p>You can list the directories where fonts are installed in the <code>FONTS_DIRS.<em>__type</code>__</em> variables, where __<code>type</code>_ can be one of “ttf”, “type1” or “x11”. Also make sure that the database file <code>fonts.dir</code> is not listed in the PLIST.</p>
</div>
<div class="paragraph">
<p>Note that you should not create new directories for fonts; instead use the standard ones to avoid that the user needs to manually configure his X server to find them.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_10_packages_installing_sgml_or_xml_data">21.6.10. Packages installing SGML or XML data</h3>
<div class="paragraph">
<p>If a package installs SGML or XML data files that need to be registered in system-wide catalogs (like DTDs, sub-catalogs, etc.), you need to take some extra steps:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Include <code>../../textproc/xmlcatmgr/catalogs.mk</code> in your <code>Makefile</code>, which takes care of registering those files in system-wide catalogs at installation and deinstallation time.</p>
</li>
<li>
<p>Set <code>SGML_CATALOGS</code> to the full path of any SGML catalogs installed by the package.</p>
</li>
<li>
<p>Set <code>XML_CATALOGS</code> to the full path of any XML catalogs installed by the package.</p>
</li>
<li>
<p>Set <code>SGML_ENTRIES</code> to individual entries to be added to the SGML catalog. These come in groups of three strings; see xmlcatmgr(1) for more information (specifically, arguments recognized by the 'add' action). Note that you will normally not use this variable.</p>
</li>
<li>
<p>Set <code>XML_ENTRIES</code> to individual entries to be added to the XML catalog. These come in groups of three strings; see xmlcatmgr(1) for more information (specifically, arguments recognized by the 'add' action).  Note that you will normally not use this variable.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_11_packages_installing_extensions_to_the_mime_database">21.6.11. Packages installing extensions to the MIME database</h3>
<div class="paragraph">
<p>If a package provides extensions to the MIME database by installing <code>.xml</code> files inside <code>${PREFIX}/share/mime/packages</code>, you need to take some extra steps to ensure that the database is kept consistent with respect to these new files:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Include <code>../../databases/shared-mime-info/mimedb.mk</code> (avoid using the <code>buildlink3.mk</code> file from	this same directory, which is reserved for inclusion from other <code>buildlink3.mk</code> files). It takes care of rebuilding the MIME database at installation and deinstallation time, and disallows any access to it directly	from the package.</p>
</li>
<li>
<p>Check the PLIST and remove any entries under the <code>share/mime</code> directory, <em>except</em> for files saved under <code>share/mime/packages</code>. The former are handled automatically by	the update-mime-database program, but the latter are package-dependent and must be removed by the package that installed them in the first place.</p>
</li>
<li>
<p>Remove any <code>share/mime/*</code> directories from the PLIST. They will be handled by the shared-mime-info package.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_12_packages_using_intltool">21.6.12. Packages using intltool</h3>
<div class="paragraph">
<p>If a package uses intltool during its build, add <code>intltool</code> to the <code>USE_TOOLS</code>, which forces it to use the intltool package provided by pkgsrc, instead of the one bundled with the distribution file.</p>
</div>
<div class="paragraph">
<p>This tracks intltool&#8217;s build-time dependencies and uses the latest available version; this way, the package benefits of any bug fixes that may have appeared since it was released.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_13_packages_installing_startup_scripts">21.6.13. Packages installing startup scripts</h3>
<div class="paragraph">
<p>If a package contains a rc.d script, it won&#8217;t be copied into the startup directory by default, but you can enable it, by adding the option <code>PKG_RCD_SCRIPTS=YES</code> in <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>. This option will copy the scripts into <code>/etc/rc.d</code> when a package is installed, and it will automatically remove the scripts when the package is deinstalled.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_14_packages_installing_tex_modules">21.6.14. Packages installing TeX modules</h3>
<div class="paragraph">
<p>If a package installs TeX packages into the texmf tree, the <code>ls-R</code> database of the tree needs to be updated.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Note</strong></p>
</div>
<div class="paragraph">
<p>Except the main TeX packages such as kpathsea, packages should install files into <code>${PREFIX}/share/texmf-dist</code>, not <code>${PREFIX}/share/texmf</code>.</p>
</div>
</td>
</tr>
</table>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Include <code>../../print/kpathsea/texmf.mk</code>. This takes care of rebuilding the <code>ls-R</code> database at installation and deinstallation time.</p>
</li>
<li>
<p>If your package installs files into a texmf tree other than the one at <code>${PREFIX}/share/texmf-dist</code>, set <code>TEX_TEXMF_DIRS</code> to the list of all texmf trees that need database update.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>If your package also installs font map files that need to be registered using <strong>updmap</strong>, include <code>../../print/tex-tetex/map.mk</code> and set <code>TEX_MAP_FILES</code> and/or <code>TEX_MIXEDMAP_FILES</code> to the list of all such font map files. Then <strong>updmap</strong> will be run automatically at installation/deinstallation to enable/disable font map files for TeX output drivers.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure that none of <code>ls-R</code> databases are included in <code>PLIST</code>, as they will be removed only by the kpathsea package.</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_15_packages_supporting_running_binaries_in_emulation">21.6.15. Packages supporting running binaries in emulation</h3>
<div class="paragraph">
<p>There are some packages that provide libraries and executables for running binaries from a one operating system on a different one (if the latter supports it). One example is running Linux binaries on NetBSD.</p>
</div>
<div class="paragraph">
<p>The <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/rpm2pkg/index.html"><code>pkgtools/rpm2pkg</code></a> helps in extracting and packaging Linux rpm packages.</p>
</div>
<div class="paragraph">
<p>The <code>CHECK_SHLIBS</code> can be set to no to avoid the <strong>check-shlibs</strong> target, which tests if all libraries for each installed executable can be found by the dynamic linker. Since the standard dynamic linker is run, this fails for emulation packages, because the libraries used by the emulation are not in the standard directories.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_16_packages_installing_hicolor_icons">21.6.16. Packages installing hicolor icons</h3>
<div class="paragraph">
<p>If a package installs images under the <code>share/icons/hicolor</code> and/or updates the <code>share/icons/hicolor/icon-theme.cache</code> database, you need to take some extra steps to make sure that the shared theme directory is handled appropriately and that the cache database is rebuilt:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Include <code>../../graphics/hicolor-icon-theme/buildlink3.mk</code>.</p>
</li>
<li>
<p>Check the <code>PLIST</code> and remove the entry that refers to the theme cache.</p>
</li>
<li>
<p>Ensure that the PLIST does not remove the shared icon directories from the <code>share/icons/hicolor</code> hierarchy because they will be handled automatically.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The best way to verify that the PLIST is correct with respect to the last two points is to regenerate it using <strong>make print-PLIST</strong>.</p>
</div>
</div>
<div class="sect2">
<h3 id="_21_6_17_packages_installing_desktop_files">21.6.17. Packages installing desktop files</h3>
<div class="paragraph">
<p>If a package installs <code>.desktop</code> files under <code>share/applications</code> and these include MIME information (MimeType key), you need to take extra steps to ensure that they are registered into the MIME database:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Include <code>../../sysutils/desktop-file-utils/desktopdb.mk</code>.</p>
</li>
<li>
<p>Check the PLIST and remove the entry that refers to the <code>share/applications/mimeinfo.cache</code> file. It will be handled automatically.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>The best way to verify that the PLIST is correct with respect to the last point is to regenerate it using <strong>make print-PLIST</strong>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_21_7_marking_packages_as_having_problems">21.7. Marking packages as having problems</h2>
<div class="sectionbody">
<div class="paragraph">
<p>In some cases one does not have the time to solve a problem immediately. In this case, one can plainly mark a package as broken. For this, one just sets the variable <code>BROKEN</code> to the reason why the package is broken (similar to the <code>PKG_FAIL_REASON</code> variable). A user trying to build the package will immediately be shown this message, and the build will not be even tried.</p>
</div>
<div class="paragraph">
<p><code>BROKEN</code> packages are removed from pkgsrc in irregular intervals.</p>
</div>
</div>
</div>
<h1 id="_chapter_22_gnome_packaging_and_porting" class="sect0">Chapter 22. GNOME packaging and porting</h1>
<div class="quoteblock">
<blockquote>
<div class="paragraph">
<p>The GNOME project provides two things: The GNOME desktop environment, an intuitive and attractive desktop for users, and the GNOME development platform, an extensive framework for building applications that integrate into the rest of the desktop.</p>
</div>
</blockquote>
<div class="attribution">
&#8212; GNOME's website
</div>
</div>
<div class="paragraph">
<p>pkgsrc provides a seamless way to automatically build and install a complete GNOME environment <em>under many different platforms</em>. We can say with confidence that pkgsrc is one of the most advanced build and packaging systems for GNOME due to its included technologies buildlink3, the wrappers and tools framework and automatic configuration file management. Lots of efforts are put into achieving a completely clean deinstallation of installed software components.</p>
</div>
<div class="paragraph">
<p>Given that pkgsrc is <a href="https://www.NetBSD.org/">NetBSD</a>'s official packaging system, the above also means that great efforts are put into making GNOME work under this operating system.</p>
</div>
<div class="paragraph">
<p>This chapter is aimed at pkgsrc developers and other people interested in helping our GNOME porting and packaging efforts. It provides instructions on how to manage the existing packages and some important information regarding their internals.</p>
</div>
<div class="sect1">
<h2 id="_22_1_meta_packages">22.1. Meta packages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>pkgsrc includes three GNOME-related meta packages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/meta-pkgs/gnome-base/index.html"><code>meta-pkgs/gnome-base</code></a>: Provides the core GNOME desktop environment. It only includes the necessary bits to get it to boo correctly, although it may lack important functionality for daily operation. The idea behind this package is to let end users build their own configurations on top of this one, first installing this meta package to achieve a functional setup and then adding individual applications.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/meta-pkgs/gnome/index.html"><code>meta-pkgs/gnome</code></a>: Provides a complete installation of the GNOME platform and desktop as defined by the GNOME project; this is based on the components distributed in the <code>platform/x.y/x.y.z/sources</code> and <code>desktop/x.y/x.y.z/sources</code> directories of the official FTP server. Developer-only tools found in those directories are not installed unless required by some other component to work properly. Similarly, packages from the bindings set (<code>bindings/x.y/x.y.z/sources</code>) are not pulled in unless required as a dependency for an end-user component. This package "extends" <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/meta-pkgs/gnome-base/index.html"><code>meta-pkgs/gnome-base</code></a>.</p>
</li>
<li>
<p><a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/meta-pkgs/gnome-devel/index.html"><code>meta-pkgs/gnome-devel</code></a>: Installs all the tools required to build a GNOME component when fetched from the CVS repository. These are required to let the <strong>autogen.sh</strong> scripts work appropriately.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>In all these packages, the <code>DEPENDS</code> lines are sorted in a way that eases updates: a package may depend on other packages listed before it but not on any listed after it. It is very important to keep this order to ease updates so&#8230;&#8203; <em>do not change it to alphabetical sorting!</em></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_22_2_packaging_a_gnome_application">22.2. Packaging a GNOME application</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Almost all GNOME applications are written in C and use a common set of tools as their build system. Things get different with the new bindings to other languages (such as Python), but the following will give you a general idea on the minimum required tools:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Almost all GNOME applications use the GNU Autotools as their build system. As a general rule you will need to tell this to your package:</p>
<div class="literalblock">
<div class="content">
<pre>GNU_CONFIGURE=  yes
USE_LIBTOOL=    yes
USE_TOOLS+=     gmake</pre>
</div>
</div>
</li>
<li>
<p>If the package uses pkg-config to detect dependencies, add this tool to the list of required utilities:</p>
<div class="literalblock">
<div class="content">
<pre>USE_TOOLS+=     pkg-config</pre>
</div>
</div>
</li>
</ul>
</div>
<div class="paragraph">
<p>Also use <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/verifypc/index.html"><code>pkgtools/verifypc</code></a> at the end of the build process to ensure that you did not miss to specify any dependency in your package and that the version requirements are all correct.</p>
</div>
<div class="paragraph">
<p>If the package uses intltool, be sure to add <code>intltool</code> to the <code>USE_TOOLS</code> to handle dependencies and to force the package to use the latest available version.</p>
</div>
<div class="paragraph">
<p>If the package uses gtk-doc (a documentation generation utility), do <em>not</em> add a dependency on it. The tool is rather big and the distfile should come with pregenerated documentation anyway; if it does not, it is a bug that you ought to report. For such packages you should disable gtk-doc (unless it is the default):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CONFIGURE_ARGS+=        --disable-gtk-doc</pre>
</div>
</div>
<div class="paragraph">
<p>The default location of installed HTML files (<code>share/gtk-doc/&lt;package-name&gt;</code>) is correct and should not be changed unless the package insists on installing them somewhere else. Otherwise programs as <strong>devhelp</strong> will not be able to open them. You can do that with an entry similar to:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CONFIGURE_ARGS+=        --with-html-dir=${PREFIX}/share/gtk-doc/...</pre>
</div>
</div>
<div class="paragraph">
<p>GNOME uses multiple <em>shared</em> directories and files under the installation prefix to maintain databases. In this context, shared means that those exact same directories and files are used among several different packages, leading to conflicts in the <code>PLIST</code>.  pkgsrc currently includes functionality to handle the most common cases, so you have to forget about using <code>@unexec ${RMDIR}</code> lines in your file lists and omitting shared files from them.  If you find yourself doing those,
<em>your package is most likely incorrect</em>.</p>
</div>
<div class="paragraph">
<p>The following table lists the common situations that result in using shared directories or files.  For each of them, the appropriate solution is given. After applying the solution be sure to <em>regenerate the package&#8217;s file list</em> with <strong>make print-PLIST</strong> and ensure it is correct.</p>
</div>
<div class="paragraph">
<p><strong>Table 22.1. PLIST handling for GNOME packages</strong></p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">If the package&#8230;&#8203;</th>
<th class="tableblock halign-left valign-top">Then&#8230;&#8203;</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Installs icons under the <code>share/icons/hicolor</code> hierarchy or updates <code>share/icons/hicolor/icon-theme.cache</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="http://netbsd.org/docs/pkgsrc/fixes.html#hicolor-theme">Section 21.6.16, “Packages installing hicolor icons”</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Installs files under <code>share/mime/packages</code>.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="http://netbsd.org/docs/pkgsrc/fixes.html#mime-database">Section 21.6.11, “Packages installing extensions to the MIME database”</a>.</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Installs <code>.desktop</code> files under <code>share/applications</code> and these include MIME information.</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">See <a href="http://netbsd.org/docs/pkgsrc/fixes.html#desktop-files">Section 21.6.17, “Packages installing desktop files”</a>.</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect1">
<h2 id="_22_3_updating_gnome_to_a_newer_version">22.3. Updating GNOME to a newer version</h2>
<div class="sectionbody">
<div class="paragraph">
<p>When seeing GNOME as a whole, there are two kinds of updates:</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Major update</dt>
<dd>
<p>Given that there is still a very long way for GNOME 3 (if it ever appears), we consider a major update one that goes from a <code>2.X</code> version to a <code>2.Y</code> one, where <code>Y</code> is even and greater than <code>X</code>. These are hard to achieve because they introduce lots of changes in the components' code and almost all GNOME distfiles are updated to newer versions. Some of them can even break API and ABI compatibility with the previous major version series. As a result, the update needs to be done all at once to minimize breakage.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A major update typically consists of around 80 package updates and the addition of some new ones.</p>
</div>
<div class="dlist">
<dl>
<dt class="hdlist1">Minor update</dt>
<dd>
<p>We consider a minor update one that goes from a <code>2.A.X</code> version to a <code>2.A.Y</code> one where <code>Y</code> is greater than <code>X</code>. These are easy to achieve because they do not update all GNOME components, can be done in an incremental way and do not break API nor ABI compatibility.</p>
</dd>
</dl>
</div>
<div class="paragraph">
<p>A minor update typically consists of around 50 package updates, although the numbers here may vary a lot.</p>
</div>
<div class="paragraph">
<p>In order to update the GNOME components in pkgsrc to a new stable release (either major or minor), the following steps should be followed:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Get a list of all the tarballs that form the new release by using the following commands. These will leave the full list of the components' distfiles into the <code>list.txt</code> file:</p>
<div class="literalblock">
<div class="content">
<pre>% echo ls "*.tar.bz2" | \
    ftp -V ftp://ftp.gnome.org/pub/gnome/platform/x.y/x.y.z/sources/ | \
    awk '{ print $9 }' &gt;list.txt
% echo ls "*.tar.bz2" | \
    ftp -V ftp://ftp.gnome.org/pub/gnome/desktop/x.y/x.y.z/sources/ | \
    awk '{ print $9 }' &gt;&gt;list.txt</pre>
</div>
</div>
</li>
<li>
<p>Open each meta package&#8217;s <code>Makefile</code> and bump their version to the release you are updating them to. The three meta packages should be always consistent with versioning. Obviously remove any <code>PKGREVISION</code>s that might be in them.</p>
</li>
<li>
<p>For each meta package, update all its <code>DEPENDS</code> lines to match the latest versions as shown by the above commands. Do <em>not</em> list any newer version (even if found in the FTP) because the meta packages are supposed to list the exact versions that form a specific GNOME release. Exceptions are permitted here if a newer version solves a serious issue in the overall desktop experience; these typically come in the form of a revision bump in pkgsrc, not in newer versions from the developers.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Packages not listed in the <code>list.txt</code> file should be updated to the latest version available (if found in pkgsrc). This is the case, for example, of the dependencies on the GNU Autotools in the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/meta-pkgs/gnome-devel/index.html"><code>meta-pkgs/gnome-devel</code></a> meta package.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Generate a patch from the modified meta packages and extract the list of "new" lines. This will provide you an outline on what packages need to be updated in pkgsrc and in what order:</p>
<div class="literalblock">
<div class="content">
<pre>% cvs diff -u gnome-devel gnome-base gnome | grep '^+D' &gt;todo.txt</pre>
</div>
</div>
</li>
<li>
<p>For major desktop updates it is recommended to zap all your
installed packages and start over from scratch at this point.</p>
</li>
<li>
<p>Now comes the longest step by far: iterate over the contents of <code>todo.txt</code> and update the packages listed in it in order. For major desktop updates none of these should be committed until the entire set is completed because there are chances of breaking not-yet-updated packages.</p>
</li>
<li>
<p>Once the packages are up to date and working, commit them to the tree one by one with appropriate log messages. At the end, commit the three meta package updates and all the corresponding changes to the <code>doc/CHANGES-&lt;YEAR&gt;</code> and <a href="http://cvsweb.NetBSD.org/bsdweb.cgi/pkgsrc/doc/TODO?rev=HEAD&amp;content-type=text/x-cvsweb-markup"><code>pkgsrc/doc/TODO</code></a> files.</p>
</li>
</ol>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_22_4_patching_guidelines">22.4. Patching guidelines</h2>
<div class="sectionbody">
<div class="paragraph">
<p>GNOME is a very big component in pkgsrc which approaches 100 packages. Please, it is very important that you always, always, <strong>always</strong> feed back any portability fixes you do to a GNOME package to the mainstream developers (see <a href="http://netbsd.org/docs/pkgsrc/components.html#components.patches.feedback">Section 12.3.5, “Feedback to the author”</a>). This is the only way to get their attention on portability issues and to ensure that future versions can be built out-of-the box on NetBSD. The less custom patches in pkgsrc, the easier further updates are. Those developers in charge of issuing major GNOME updates will be grateful if you do that.</p>
</div>
<div class="paragraph">
<p>The most common places to report bugs are the <a href="https://gitlab.gnome.org/GNOME">GNOME&#8217;s GitLab</a> and the <a href="https://gitlab.freedesktop.org/explore/groups">freedesktop.org&#8217;s
GitLab</a>. Not all components use these to track bugs, but most of them do. Do not be short on your reports: always provide detailed explanations of the current failure, how it can be improved to achieve maximum portability and, if at all possible, provide a patch against the main Git branch. The more verbose you are, the higher chances of your patch being accepted.</p>
</div>
<div class="paragraph">
<p>Also, please avoid using preprocessor magic to fix portability issues. While the FreeBSD GNOME people are doing a great job in porting GNOME to their operating system, the official GNOME sources are now plagued by conditionals that check for <code><em>FreeBSD</em></code> and similar macros. This hurts portability. Please see our patching guidelines (<a href="http://netbsd.org/docs/pkgsrc/components.html#components.patches.guidelines">Section 12.3.4, “Patching guidelines”</a>) for more details.</p>
</div>
</div>
</div>
<h1 id="_chapter_23_submitting_and_committing" class="sect0">Chapter 23. Submitting and Committing</h1>
<div class="sect1">
<h2 id="_23_1_submitting_binary_packages">23.1. Submitting binary packages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Our policy is that we accept binaries only from pkgsrc developers to guarantee that the packages don&#8217;t contain any trojan horses etc.This is not to annoy anyone but rather to protect our users! You&#8217;re still free to put up your home-made binary packages and tell the world where to get them. NetBSD developers doing bulk builds and wanting to upload them please see <a href="http://netbsd.org/docs/pkgsrc/bulk.html">Chapter 8, Creating binary packages for everything in pkgsrc (bulk builds)</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_23_2_submitting_source_packages_for_non_netbsd_developers">23.2. Submitting source packages (for non-NetBSD-developers)</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Firstly, you can import new packages into pkgsrc-wip (“pkgsrc work-in-progress”); see the homepage at <a href="https://pkgsrc.org/wip/">https://pkgsrc.org/wip/</a> for details.</p>
</div>
<div class="paragraph">
<p>Next, check that your package is complete, compiles and runs well; see <a href="http://netbsd.org/docs/pkgsrc/creating.html">Chapter 14, Creating a new pkgsrc package from scratch</a> and the rest of this document. Run the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkglint/index.html"><code>pkgtools/pkglint</code></a> tool and fix any errors that appear.</p>
</div>
<div class="paragraph">
<p>Finally, send a report to the pkgsrc bug tracking system, either with the <a href="http://man.NetBSD.org/NetBSD-9.2/i386/send-pr.1">send-pr(1)</a> command, or if you don&#8217;t have that, go to the web page <a href="https://www.NetBSD.org/support/send-pr.html">https://www.NetBSD.org/support/send-pr.html</a>, which contains some instructions and a link to a form where you can submit packages. The <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/sysutils/gtk-send-pr/index.html"><code>sysutils/gtk-send-pr</code></a> package is	also available as a substitute for either of the above two tools.</p>
</div>
<div class="paragraph">
<p>In the form of the problem report, the category should be “pkg”, the synopsis should include the package name and version number, and the description field should contain a short description of your package (contents of the COMMENT variable or DESCR file are OK).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_23_3_general_notes_when_adding_updating_or_removing_packages">23.3. General notes when adding, updating, or removing packages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please note all package additions, updates, moves, and removals in <code>pkgsrc/doc/CHANGES-<em>YYYY</code></em>. It&#8217;s very important to keep this file up to date and conforming to the existing format, because it will be used by scripts to automatically update pages on <a href="https://www.NetBSD.org/">www.NetBSD.org</a> and other sites. Additionally, check the <code>pkgsrc/doc/TODO</code> file and remove the entry for the package you updated or removed, in case it was mentioned there.</p>
</div>
<div class="paragraph">
<p>When the <code>PKGREVISION</code> of a package is bumped, the change should appear in <code>pkgsrc/doc/CHANGES-<em>YYYY</code></em> if it is security related or otherwise relevant. Mass bumps that result from a dependency being updated should not be mentioned. In all other cases it&#8217;s the developer&#8217;s decision.</p>
</div>
<div class="paragraph">
<p>There is a make target that helps in creating proper <code>CHANGES-<em>YYYY</code></em> entries:  <strong>make changes-entry</strong>. It uses the optional <code>CTYPE</code> and <code>NETBSD_LOGIN_NAME</code> variables. The general usage is to first make sure that your <code>CHANGES-<em>YYYY</code></em> file is up-to-date (to avoid having to resolve conflicts later-on) and then to <strong>cd</strong> to the package directory. For package updates, <strong>make changes-entry</strong> is enough. For new packages, or package moves or removals, set the <code>CTYPE</code> variable on the command line to "Added", "Moved", or "Removed".  You can set <code>NETBSD_LOGIN_NAME</code> in <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a> if your local login name is not the same as your NetBSD login name. The target also automatically removes possibly existing entries for the package in the <code>TODO</code> file. Don&#8217;t forget to commit the changes, e.g. by using <strong>make commit-changes-entry</strong>! If you are not using a checkout directly from cvs.NetBSD.org, but e.g. a local copy of the repository, you can set USE_NETBSD_REPO=yes. This makes the cvs commands use the main repository.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_23_4_commit_messages">23.4. Commit Messages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For several years, there have been mirrors of pkgsrc in fossil, git, and hg. Standard practise when using these tools is to make the first line of a commit message function as a summary that can be read without the rest, such as is commonly done with "git log --oneline". For this reason, we have the following guidelines for pkgsrc commit messages:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Start the commit message with a line that explains the big picture in 65 characters or less. When a commit is for one package, include the name of the package. For updates, include the version to which it is updated.</p>
</li>
<li>
<p>Leave the next line empty.</p>
</li>
<li>
<p>Then come the details for the commit (changes in that package, reason for a change) and any relevant PRs. Wrap this section.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Here is an example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>libxslt: update to 1.0.30
Changes since 1.0.29:
...</pre>
</div>
</div>
<div class="paragraph">
<p>Here is another example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>mk/bsd.pkg.mk: enable SSP by default on NetBSD
 (rationale)</pre>
</div>
</div>
<div class="paragraph">
<p>Commit messages are final: no “cvs admin” is allowed on the pkgsrc repository to change commit messages.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_23_5_committing_adding_a_package_to_cvs">23.5. Committing: Adding a package to CVS</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section is only of interest for pkgsrc developers with write access to the pkgsrc repository.</p>
</div>
<div class="paragraph">
<p>When the package is finished, “cvs add” the files. Start by adding the directory and then files in the directory. Don&#8217;t forget to add the new package to the category&#8217;s <code>Makefile</code>. Make sure you don&#8217;t forget any files; you can check by running “cvs status”. An example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ cd .../pkgsrc/category
$ cvs add pkgname
$ cd pkgname
$ cvs add DESCR Makefile PLIST distinfo buildlink3.mk patches
$ cvs add patches/p*
$ cvs status | less
$ cvs commit
$ cd ..
$ vi Makefile # add SUBDIRS+=pkgname line
$ cvs commit Makefile
$ cd pkgname
$ make CTYPE=Added commit-changes-entry</pre>
</div>
</div>
<div class="paragraph">
<p>The commit message of the initial import should include part of the <code>DESCR</code> file, so people reading the mailing lists know what the package is/does.</p>
</div>
<div class="paragraph">
<p>Also mention the new package in <code>pkgsrc/doc/CHANGES-20xx</code>.</p>
</div>
<div class="paragraph">
<p>Previously, “cvs import” was suggested, but it was much easier to get wrong than “cvs add”.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_23_6_updating_a_package_to_a_newer_version">23.6. Updating a package to a newer version</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Please always put a concise, appropriate and relevant summary of the changes between old and new versions into the commit log when updating a package.There are various reasons for this:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A URL is volatile, and can change over time. It may go away completely or its information may be overwritten by newer information.</p>
</li>
<li>
<p>Having the change information between old and new versions in our CVS repository is very useful for people who use either cvs or anoncvs.</p>
</li>
<li>
<p>Having the change information between old and new versions in our CVS repository is very useful for people who read the pkgsrc-changes mailing list, so that they can make tactical decisions about when to upgrade the package.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Please also recognize that, just because a new version of a package has been released, it should not automatically be upgraded in the CVS repository. We prefer to be conservative in the packages that are included in pkgsrc - development or beta packages are not really the best thing for most places in which pkgsrc is used. Please use your judgement about what should go into pkgsrc, and bear in mind that stability is to be preferred above new and possibly untested features.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_23_7_renaming_a_package_in_pkgsrc">23.7. Renaming a package in pkgsrc</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Renaming packages is not recommended.</p>
</div>
<div class="paragraph">
<p>When renaming packages, be sure to fix any references to the old name in other Makefiles, options, buildlink files, etc.</p>
</div>
<div class="paragraph">
<p>Also, when renaming a package, please add the package name and version pattern(s) of the previous package to <code>SUPERSEDES</code>. This may be repeated for multiple renames. The new package would be an exact replacement. Example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SUPERSEDES+=    p5-IO-Compress-Zlib&lt;2.017
SUPERSEDES+=    optcomp-[0-9]*</pre>
</div>
</div>
<div class="paragraph">
<p>Note that “successor” in the CHANGES-<em><code>YYYY</code></em> file doesn&#8217;t necessarily mean that it <em>supersedes</em>, as that successor may not be an exact replacement but is a suggestion for the replaced functionality.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_23_8_moving_a_package_in_pkgsrc">23.8. Moving a package in pkgsrc</h2>
<div class="sectionbody">
<div class="paragraph">
<p>It is preferred that packages are not renamed or moved, but if needed please follow these steps.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make a copy of the directory somewhere else.</p>
</li>
<li>
<p>Remove all CVS dirs.</p>
</li>
</ol>
</div>
<div class="paragraph">
<p>Alternatively to the first two steps you can also do:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% cvs -d user@cvs.NetBSD.org:/cvsroot export -D today pkgsrc/category/package</pre>
</div>
</div>
<div class="paragraph">
<p>and use that for further work.</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Fix <code>CATEGORIES</code> and any <code>DEPENDS</code> paths that just did “../package” instead of “../../category/package”.</p>
</li>
<li>
<p>In the modified package&#8217;s Makefile, consider setting <code>PREV_PKGPATH</code> to the previous category/package pathname. The <code>PREV_PKGPATH</code> can be used by tools for doing an update using pkgsrc building; for example, it can search the <a href="http://man.NetBSD.org/NetBSD-9.2/i386/pkg_summary.5">pkg_summary(5)</a> database for <code>PREV_PKGPATH</code> (if no <code>SUPERSEDES</code>) and then use the corresponding new <code>PKGPATH</code> for that moved package.  Note that it may have multiple matches, so the tool should also check on the <code>PKGBASE</code> too.  The <code>PREV_PKGPATH</code> probably has no value unless <code>SUPERSEDES</code> is not set, i.e.  <code>PKGBASE</code> stays the same.</p>
</li>
<li>
<p><strong>cvs import</strong> the modified package in the new place.</p>
</li>
<li>
<p>Check if any package depends on it:</p>
<div class="literalblock">
<div class="content">
<pre>% cd /usr/pkgsrc
% grep /package */*/Makefile* */*/buildlink*</pre>
</div>
</div>
</li>
<li>
<p>Fix paths in packages from step 5 to point to new location.</p>
</li>
<li>
<p><strong>cvs rm (-f)</strong> the package at the old location.</p>
</li>
<li>
<p>Remove from <code>oldcategory/Makefile</code>.</p>
</li>
<li>
<p>Add to <code>newcategory/Makefile</code>.</p>
</li>
<li>
<p>Commit the changed and removed files:</p>
<div class="literalblock">
<div class="content">
<pre>% cvs commit oldcategory/package oldcategory/Makefile newcategory/Makefile</pre>
</div>
</div>
</li>
</ol>
</div>
<div class="paragraph">
<p>(and any packages from step 5, of course).</p>
</div>
</div>
</div>
<h1 id="_chapter_24_frequently_asked_questions" class="sect0">Chapter 24. Frequently Asked Questions</h1>
<div class="paragraph">
<p>This section contains the answers to questions that may arise when you are writing a package. If you don&#8217;t find your question answered here, first have a look in the other chapters, and if you still don&#8217;t have the answer, ask on the <code>pkgsrc-users</code> mailing list.</p>
</div>
<div class="sect1">
<h2 id="_24_1_what_is_the_difference_between_makeflags_makeflags_and_make_flags">24.1. What is the difference between MAKEFLAGS, .MAKEFLAGS and MAKE_FLAGS?</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>MAKEFLAGS</code> are the flags passed to the pkgsrc-internal invocations of <a href="http://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a>.</p>
</div>
<div class="paragraph">
<p><code>MAKE_FLAGS</code> are the flags that are passed to the <code>MAKE_PROGRAM</code> when building the package.</p>
</div>
<div class="paragraph">
<p><code>.MAKEFLAGS</code> is an internal variable of <strong>bmake</strong> and should not be used by packages.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_24_2_what_is_the_difference_between_make_gmake_and_make_program">24.2. What is the difference between MAKE, GMAKE and MAKE_PROGRAM?</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>MAKE</code> is the path to the <a href="http://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> program that is used in the pkgsrc infrastructure.</p>
</div>
<div class="paragraph">
<p><code>GMAKE</code> is the path to GNU Make, but you need to say <code>USE_TOOLS+=gmake</code> to use that.</p>
</div>
<div class="paragraph">
<p><code>MAKE_PROGRAM</code> is the path to the Make program that is used for building the package.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_24_3_what_is_the_difference_between_cc_pkg_cc_and_pkgsrc_compiler">24.3. What is the difference between CC, PKG_CC and PKGSRC_COMPILER?</h2>
<div class="sectionbody">
<div class="paragraph">
<p><code>CC</code> is the path to the real C compiler, which can be configured by the pkgsrc user.</p>
</div>
<div class="paragraph">
<p><code>PKG_CC</code> is the path to the compiler wrapper.</p>
</div>
<div class="paragraph">
<p><code>PKGSRC_COMPILER</code> is <em>not</em> a path to a compiler, but the type of compiler that should be used. See <code>mk/compiler.mk</code> for more information about the latter variable.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_24_4_why_does_make_show_var_varnamebuildlink_prefix_foo_say_its_empty">24.4. Why does <strong>make show-var VARNAME=BUILDLINK_PREFIX.<em>foo</em></strong> say it&#8217;s empty?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>For optimization reasons, some variables are only available in the “wrapper” phase and later. To “simulate” the wrapper phase, append <strong>PKG_PHASE=wrapper</strong> to the above command.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_24_5_what_does_master_site_sourceforgepackage_mean_i_dont_understand_the_inside_it">24.5. What does ${MASTER_SITE_SOURCEFORGE:=package/} mean? I don&#8217;t understand the := inside it.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The <code>:=</code> is not an assignment operator, even though it may look like one. Instead, it is a degenerate form of <code>${LIST:<em>old_string</code></em>=<em><code>new_string</code></em>}, which is documented in the <a href="http://man.NetBSD.org/NetBSD-9.2/i386/make.1">make(1)</a> man page and which is commonly used in the form <code>${SRCS:.c=.o}</code>. In the case of <code>MASTER_SITE_*</code>, <em><code>old_string</code></em> is the empty string and <em><code>new_string</code></em> is <code>package/</code>. That&#8217;s where the <code>:</code> and the <code>=</code> fall together.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_24_6_which_mailing_lists_are_there_for_package_developers">24.6. Which mailing lists are there for package developers?</h2>
<div class="sectionbody">
<div class="dlist">
<dl>
<dt class="hdlist1"><a href="https://www.NetBSD.org/mailinglists/index.html#tech-pkg">tech-pkg</a></dt>
<dd>
<p>This is a list for technical discussions related to pkgsrc development, e.g. soliciting feedback for changes to pkgsrc infrastructure, proposed new features, questions related to porting pkgsrc to a new platform, advice for maintaining a package, patches that affect many packages, help requests moved from pkgsrc-users when an infrastructure bug is found, etc.</p>
</dd>
<dt class="hdlist1"><a href="https://www.NetBSD.org/mailinglists/index.html#pkgsrc-bugs">pkgsrc-bugs</a></dt>
<dd>
<p>All bug reports in category "pkg" sent with <a href="http://man.NetBSD.org/NetBSD-9.2/i386/send-pr.1">send-pr(1)</a> appear here. Please do not report your bugs here directly; use one of the other mailing lists.</p>
</dd>
</dl>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_24_7_where_is_the_pkgsrc_documentation">24.7. Where is the pkgsrc documentation?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are many places where you can find documentation about pkgsrc:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The pkgsrc guide (this document) is a collection of chapters that explain large parts of pkgsrc, but some chapters tend to be outdated. Which ones they are is hard to say.</p>
</li>
<li>
<p>On the mailing list archives (see <a href="https://mail-index.NetBSD.org/">https://mail-index.NetBSD.org/</a>), you can find discussions about certain features, announcements of new parts of the pkgsrc infrastructure and sometimes even announcements that a certain feature has been marked as obsolete. The benefit here is that each message has a date appended to it.</p>
</li>
<li>
<p>Many of the files in the <code>mk/</code> directory start with a comment that describes the purpose of the file and how it can be used by the pkgsrc user and package authors. An easy way to find this documentation is to run <strong>bmake	help</strong>.</p>
</li>
<li>
<p>The CVS log messages are a rich source of information, but they tend to be highly abbreviated, especially for actions that occur often. Some contain a detailed description of what has changed, but they are geared towards the	other pkgsrc developers, not towards an average pkgsrc user. They also only document <em>changes</em>, so if you don&#8217;t know what has been before, these messages may not be worth	too much to you.</p>
</li>
<li>
<p>Some parts of pkgsrc are only “implicitly documented”, that is the documentation exists only in the mind of the developer who wrote the code. To get this information, use the <strong>cvs annotate</strong> command to see who has written it and ask on the <code>tech-pkg</code> mailing list, so that others can find your questions later (see above). To be sure that the developer in charge reads the mail, you may CC him or her.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_24_8_i_have_a_little_time_to_kill_what_shall_i_do">24.8. I have a little time to kill. What shall I do?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This is not really an FAQ yet, but here&#8217;s the answer anyway.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Run <strong>pkg_chk -N</strong> (from the <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkg_chk/index.html"><code>pkgtools/pkg_chk</code></a> package). It will tell you about newer versions of installed packages that are available, but not yet updated in pkgsrc.</p>
</li>
<li>
<p>Browse <code>pkgsrc/doc/TODO</code>&#8201;&#8212;&#8201;it contains a list of suggested new packages and a list of cleanups and enhancements for pkgsrc that would be nice to have.</p>
</li>
<li>
<p>Review packages for which review was requested on the <a href="https://www.NetBSD.org/mailinglists/index.html#tech-pkg">tech-pkg</a> mailing list.</p>
</li>
</ul>
</div>
</div>
</div>
<h1 id="_chapter_25_design_of_the_pkgsrc_infrastructure" class="sect0">Chapter 25. Design of the pkgsrc infrastructure</h1>
<div class="paragraph">
<p>The pkgsrc infrastructure consists of many small Makefile fragments. Each such fragment needs a properly specified interface. This chapter explains how such an interface looks	like.</p>
</div>
<div class="sect1">
<h2 id="_25_1_the_meaning_of_variable_definitions">25.1. The meaning of variable definitions</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Whenever a variable is defined in the pkgsrc infrastructure, the location and the way of definition provide much information about the intended use of that variable. Additionally, more documentation may be found in a header comment or in this pkgsrc guide.</p>
</div>
<div class="paragraph">
<p>A special file is <code>mk/defaults/mk.conf</code>, which lists all variables that are intended to be user-defined. They are either defined using the <code>?=</code> operator or they are left undefined because defining them to anything would effectively mean “yes”. All these variables may be overridden by the pkgsrc user in the <code>MAKECONF</code> file.</p>
</div>
<div class="paragraph">
<p>Outside this file, the following conventions apply: Variables that are defined using the <code>?=</code> operator may be overridden by a package.</p>
</div>
<div class="paragraph">
<p>Variables that are defined using the <code>=</code> operator may be used read-only at run-time.</p>
</div>
<div class="paragraph">
<p>Variables whose name starts with an underscore must not be accessed outside the pkgsrc infrastructure at all. They may change without further notice.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<div class="paragraph">
<p><strong>Note</strong></p>
</div>
<div class="paragraph">
<p>These conventions are currently not applied consistently to the complete pkgsrc infrastructure.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_25_2_avoiding_problems_before_they_arise">25.2. Avoiding problems before they arise</h2>
<div class="sectionbody">
<div class="paragraph">
<p>All variables that contain lists of things should default to being empty. Two examples that do not follow this rule are <code>USE_LANGUAGES</code> and <code>DISTFILES</code>. These variables cannot simply be	modified using the <code>+=</code> operator in package <code>Makefile</code>s (or other files included by them), since there is no guarantee whether the variable is already set or not, and what its value is. In the case of <code>DISTFILES</code>, the packages “know” the default value and just define it as in the following example.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DISTFILES=      ${DISTNAME}${EXTRACT_SUFX} additional-files.tar.gz</pre>
</div>
</div>
<div class="paragraph">
<p>Because of the selection of this default value, the same value appears in many package Makefiles. Similarly for <code>USE_LANGUAGES</code>, but in this case the default value (“<code>c</code>”) is so short that it	doesn&#8217;t stand out. Nevertheless it is mentioned in many files.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_25_3_variable_evaluation">25.3. Variable evaluation</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_25_3_1_at_load_time">25.3.1. At load time</h3>
<div class="paragraph">
<p>Variable evaluation takes place either at load time or at runtime, depending on the context in which they occur. The contexts where variables are evaluated at load time are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>The right hand side of the <code>:=</code> and <code>!=</code> operators,</p>
</li>
<li>
<p>Make directives like <code>.if</code> or <code>.for</code>,</p>
</li>
<li>
<p>Dependency lines.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A special exception are references to the iteration	variables of <code>.for</code> loops, which are expanded inline, no matter in which context they appear.</p>
</div>
<div class="paragraph">
<p>As the values of variables may change during load time, care must be taken not to evaluate them by accident. Typical examples for variables that should not be evaluated at load time are <code>DEPENDS</code> and <code>CONFIGURE_ARGS</code>. To make the effect more clear, here is an example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>CONFIGURE_ARGS=         # none
CFLAGS=                 -O
CONFIGURE_ARGS+=        CFLAGS=${CFLAGS:Q}
CONFIGURE_ARGS:=        ${CONFIGURE_ARGS}
CFLAGS+=                -Wall</pre>
</div>
</div>
<div class="paragraph">
<p>This code shows how the use of the <code>:=</code> operator can quickly lead to unexpected results. The first paragraph is fairly common code. The second paragraph evaluates the <code>CONFIGURE_ARGS</code> variable, which results in <code>CFLAGS=-O</code>. In the third paragraph, the <code>-Wall</code> is appended to the <code>CFLAGS</code>, but this addition will not appear in <code>CONFIGURE_ARGS</code>. In actual code, the three paragraphs from above typically occur in completely unrelated files.</p>
</div>
</div>
<div class="sect2">
<h3 id="_25_3_2_at_runtime">25.3.2. At runtime</h3>
<div class="paragraph">
<p>After all the files have been loaded, the values of the variables cannot be changed anymore. Variables that are used in the shell commands are expanded at this point.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_25_4_how_can_variables_be_specified">25.4. How can variables be specified?</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are many ways in which the definition and use of a variable can be restricted in order to detect bugs and violations of the (mostly unwritten) policies. A package can be checked with <code>pkglint -Wall</code> to see whether it meets these rules.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_25_5_designing_interfaces_for_makefile_fragments">25.5. Designing interfaces for Makefile fragments</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Most of the <code>.mk</code> files fall into one of the following classes. Cases where a file falls into more than one class should be avoided as it often leads to subtle	bugs.</p>
</div>
<div class="sect2">
<h3 id="_25_5_1_procedures_with_parameters">25.5.1. Procedures with parameters</h3>
<div class="paragraph">
<p>In a traditional imperative programming language some of the <code>.mk</code> files could be described as	procedures. They take some input parameters and&#8212;&#8203;after inclusion&#8212;&#8203;provide a result in output parameters. Since all variables in <code>Makefile</code>s have global scope care must be taken not to use parameter names that have already another meaning. For example, <code>PKGNAME</code> is a bad choice for a parameter name.</p>
</div>
<div class="paragraph">
<p>Procedures are completely evaluated at preprocessing time. That is, when calling a procedure all input parameters must be completely resolvable. For example, <code>CONFIGURE_ARGS</code> should never be an input parameter since it is very likely that further text will be	added after calling the procedure, which would effectively apply the procedure to only a part of the variable. Also, references to other variables will be modified after calling the	procedure.</p>
</div>
<div class="paragraph">
<p>A procedure can declare its output parameters either as	suitable for use in preprocessing directives or as only available at runtime. The latter alternative is for variables that contain references to other runtime variables.</p>
</div>
<div class="paragraph">
<p>Procedures shall be written such that it is possible to	call the procedure more than once. That is, the file must not contain multiple-inclusion guards.</p>
</div>
<div class="paragraph">
<p>Examples for procedures are <code>mk/bsd.options.mk</code> and <code>mk/buildlink3/bsd.builtin.mk</code>. To express that the parameters are evaluated at load time, they should be assigned using the <code>:=</code> operator, which should be used only for this purpose.</p>
</div>
</div>
<div class="sect2">
<h3 id="_25_5_2_actions_taken_on_behalf_of_parameters">25.5.2. Actions taken on behalf of parameters</h3>
<div class="paragraph">
<p>Action files take some input parameters and may define runtime variables. They shall not define loadtime variables. There are action files that are included implicitly by the pkgsrc infrastructure, while other must be included explicitly.</p>
</div>
<div class="paragraph">
<p>An example for action files is <code>mk/subst.mk</code>.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_25_6_the_order_in_which_files_are_loaded">25.6. The order in which files are loaded</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Package <code>Makefile</code>s usually consist of a set of variable definitions, and include the file <code>../../mk/bsd.pkg.mk</code> in the very last line. Before that, they may also include various other <code>*.mk</code> files if they need to query the availability of certain features like the type of compiler or the X11 implementation. Due to the heavy use of preprocessor directives like <code>.if</code> and <code>.for</code>, the order in which the files are loaded matters.</p>
</div>
<div class="paragraph">
<p>This section describes at which point the various files are loaded and gives reasons for that order.</p>
</div>
<div class="sect2">
<h3 id="_25_6_1_the_order_in_bsd_prefs_mk">25.6.1. The order in bsd.prefs.mk</h3>
<div class="paragraph">
<p>The very first action in <code>bsd.prefs.mk</code> is to define some essential variables like <code>OPSYS</code>, <code>OS_VERSION</code> and <code>MACHINE_ARCH</code>.</p>
</div>
<div class="paragraph">
<p>Then, the user settings are loaded from the file specified in <code>MAKECONF</code>, which is usually <a href="http://netbsd.org/docs/pkgsrc/configuring.html#mk.conf"><code>mk.conf</code></a>. After that, those variables	that have not been overridden by the user are loaded from <code>mk/defaults/mk.conf</code>.</p>
</div>
<div class="paragraph">
<p>After the user settings, the system settings and platform settings are loaded, which may override the user	settings.</p>
</div>
<div class="paragraph">
<p>Then, the tool definitions are loaded. The tool wrappers are not yet in effect. This only happens when building a package, so the proper variables must be used instead of the direct tool names.</p>
</div>
<div class="paragraph">
<p>As the last steps, some essential variables from the wrapper and the package system flavor are loaded, as well as the variables that have been cached in earlier phases of a package build.</p>
</div>
</div>
<div class="sect2">
<h3 id="_25_6_2_the_order_in_bsd_pkg_mk">25.6.2. The order in bsd.pkg.mk</h3>
<div class="paragraph">
<p>First, <code>bsd.prefs.mk</code> is loaded.</p>
</div>
<div class="paragraph">
<p>Then, the various <code>*-vars.mk</code> files are loaded, which fill default values for those variables that have not been defined by the package. These variables may later be used even in unrelated files.</p>
</div>
<div class="paragraph">
<p>Then, the file <code>bsd.pkg.error.mk</code> provides the target <code>error-check</code> that is added as a special dependency to all other targets that use <code>DELAYED_ERROR_MSG</code> or <code>DELAYED_WARNING_MSG</code>.</p>
</div>
<div class="paragraph">
<p>Then, the package-specific hacks from <code>hacks.mk</code> are included.</p>
</div>
<div class="paragraph">
<p>Then, various other files follow. Most of them don&#8217;t have any dependencies on what they need to have included before or after them, though some do.</p>
</div>
<div class="paragraph">
<p>The code to check <code>PKG_FAIL_REASON</code> and <code>PKG_SKIP_REASON</code> is then executed, which restricts the use of these variables to all the files that have been included before. Appearances in later files will be silently ignored.</p>
</div>
<div class="paragraph">
<p>Then, the files for the main targets are included, in the order of later execution, though the actual order should not matter.</p>
</div>
<div class="paragraph">
<p>At last, some more files are included that don&#8217;t set any interesting variables but rather just define make targets to be	executed.</p>
</div>
<div class="paragraph">
<p>Unresolved directive in README.adoc - include::regression.adoc[]</p>
</div>
</div>
</div>
</div>
<h1 id="_chapter_27_porting_pkgsrc" class="sect0">Chapter 27. Porting pkgsrc</h1>
<div class="paragraph">
<p>The pkgsrc system has already been ported to many operating systems, hardware architectures and compilers. This chapter explains the necessary steps to make pkgsrc even more portable.</p>
</div>
<div class="sect1">
<h2 id="_27_1_porting_pkgsrc_to_a_new_operating_system">27.1. Porting pkgsrc to a new operating system</h2>
<div class="sectionbody">
<div class="paragraph">
<p>To port pkgsrc to a new operating system (called <code>MyOS</code> in this example), you need to touch the following files:</p>
</div>
<div class="paragraph">
<p><code>pkgtools/bootstrap-mk-files/files/mods/<em>MyOS</code></em>.sys.mk</p>
</div>
<div class="paragraph">
<p>This file contains some basic definitions, for example the name of the C compiler.</p>
</div>
<div class="paragraph">
<p><code>mk/bsd.prefs.mk</code></p>
</div>
<div class="paragraph">
<p>Insert code that defines the variables <code>OPSYS</code>, <code>OS_VERSION</code>, <code>OPSYS_VERSION</code>, <code>LOWER_VENDOR</code>, <code>MACHINE_ARCH</code>, <code>OBJECT_FMT</code>, <code>APPEND_ELF</code>, and the other variables that appear in this file.</p>
</div>
<div class="paragraph">
<p><code>mk/platform/<em>MyOS</code></em>.mk</p>
</div>
<div class="paragraph">
<p>This file contains the platform-specific definitions that are used by pkgsrc. Start by copying one of the	other files and edit it to your needs.</p>
</div>
<div class="paragraph">
<p><code>mk/tools/tools.<em>MyOS</code></em>.mk</p>
</div>
<div class="paragraph">
<p>This file defines the paths to all the tools that are needed by one or the other package in pkgsrc, as well as by pkgsrc itself. Find out where these tools are on your platform and add them.</p>
</div>
<div class="paragraph">
<p>Now, you should be able to build some basic packages, like <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/lang/perl5/index.html"><code>lang/perl5</code></a>, <a href="https://cdn.NetBSD.org/pub/pkgsrc/current/pkgsrc/shells/bash/index.html"><code>shells/bash</code></a>.</p>
</div>
</div>
</div>
<h1 id="_appendix_a_a_simple_example_package_bison" class="sect0">Appendix A. A simple example package: bison</h1>
<div class="paragraph">
<p>We checked to find a piece of software that wasn&#8217;t in the packages collection, and picked GNU bison. Quite why someone would want to have <strong>bison</strong> when Berkeley <strong>yacc</strong> is already present in the tree is beyond us, but it&#8217;s useful for the purposes of this exercise.</p>
</div>
<div class="sect1">
<h2 id="_a_1_files">A.1. files</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_a_1_1_makefile">A.1.1. Makefile</h3>
<div class="literalblock">
<div class="content">
<pre># $NetBSD: examples.html,v 1.225 2022/06/02 21:25:00 gutteridge Exp $
#
DISTNAME=       bison-1.25
CATEGORIES=     devel
MASTER_SITES=   ${MASTER_SITE_GNU:=bison/}
MAINTAINER=     pkgsrc-users@NetBSD.org
HOMEPAGE=       https://www.gnu.org/software/bison/bison.html
COMMENT=        GNU yacc clone
GNU_CONFIGURE=  yes
INFO_FILES=     yes
.include "../../mk/bsd.pkg.mk"</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_a_1_2_descr">A.1.2. DESCR</h3>
<div class="literalblock">
<div class="content">
<pre>GNU version of yacc.  Can make re-entrant parsers, and numerous other
improvements.  Why you would want this when Berkeley yacc(1) is part
of the NetBSD source tree is beyond me.</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_a_1_3_plist">A.1.3. PLIST</h3>
<div class="literalblock">
<div class="content">
<pre>@comment $NetBSD: examples.html,v 1.225 2022/06/02 21:25:00 gutteridge Exp $
bin/bison
man/man1/bison.1.gz
share/bison.simple
share/bison.hairy</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_a_1_4_checking_a_package_with_pkglint">A.1.4. Checking a package with pkglint</h3>
<div class="paragraph">
<p>The NetBSD package system comes with <a href="https://cdn.netbsd.org/pub/pkgsrc/current/pkgsrc/pkgtools/pkglint/index.html"><code>pkgtools/pkglint</code></a> which helps to check the contents of these files. After installation it is quite easy to use, just change to the directory of the package you wish to examine and run <strong>pkglint</strong>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ pkglint
ERROR: Makefile: Each package must define its LICENSE.
WARN: Makefile:9: HOMEPAGE should migrate from http to https.
NOTE: PLIST:3: The .gz extension is unnecessary for manual pages.
WARN: PLIST:5: "share/bison.hairy" should be sorted before "share/bison.simple".
1 error, 2 warnings and 1 note found.
(Run "pkglint -e" to show explanations.)
(Run "pkglint -fs" to show what can be fixed automatically.)
(Run "pkglint -F" to automatically fix some issues.)</pre>
</div>
</div>
<div class="paragraph">
<p>Depending on the supplied command line arguments (see pkglint(1)), more checks will be performed. Use e.g. <strong>pkglint -Wall</strong> for a very thorough check.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_a_2_steps_for_building_installing_packaging">A.2. Steps for building, installing, packaging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Create the directory where the package lives, plus any auxiliary directories:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># cd /usr/pkgsrc/lang
# mkdir bison
# cd bison
# mkdir patches</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Create ``Makefile``, ``DESCR`` and ``PLIST`` (see http://www.netbsd.org/docs/pkgsrc/components.html[Chapter 12, Package components - files, directories and contents]) then continue with fetching the distfile:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre> # make fetch
&gt;&gt; bison-1.25.tar.gz doesn't seem to exist on this system.
&gt;&gt; Attempting to fetch from ftp://prep.ai.mit.edu/pub/gnu//.
Requesting ftp://prep.ai.mit.edu/pub/gnu//bison-1.25.tar.gz (via ftp://orpheus.amdahl.com:80/)
ftp: Error retrieving file: 500 Internal error
&gt;&gt; Attempting to fetch from ftp://wuarchive.wustl.edu/systems/gnu//.
Requesting ftp://wuarchive.wustl.edu/systems/gnu//bison-1.25.tar.gz (via ftp://orpheus.amdahl.com:80/)
ftp: Error retrieving file: 500 Internal error
&gt;&gt; Attempting to fetch from ftp://ftp.freebsd.org/pub/FreeBSD/distfiles//.
Requesting ftp://ftp.freebsd.org/pub/FreeBSD/distfiles//bison-1.25.tar.gz (via ftp://orpheus.amdahl.com:80/)
Successfully retrieved file.</pre>
</div>
</div>
<div class="paragraph">
<p>Generate the checksum of the distfile into <code>distinfo</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># make makedistinfo</pre>
</div>
</div>
<div class="paragraph">
<p>Now compile:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># make
&gt;&gt; Checksum OK for bison-1.25.tar.gz.
===&gt;  Extracting for bison-1.25
===&gt;  Patching for bison-1.25
===&gt;   Ignoring empty patch directory
===&gt;  Configuring for bison-1.25
creating cache ./config.cache
checking for gcc... cc
checking whether we are using GNU C... yes
checking for a BSD compatible install... /usr/bin/install -c -o bin -g bin
checking how to run the C preprocessor... cc -E
checking for minix/config.h... no
checking for POSIXized ISC... no
checking whether cross-compiling... no
checking for ANSI C header files... yes
checking for string.h... yes
checking for stdlib.h... yes
checking for memory.h... yes
checking for working const... yes
checking for working alloca.h... no
checking for alloca... yes
checking for strerror... yes
updating cache ./config.cache
creating ./config.status
creating Makefile
===&gt;  Building for bison-1.25
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g LR0.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g allocate.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g closure.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g conflicts.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g derives.c
cc -c -DXPFILE=\"/usr/pkg/share/bison.simple\"  -DXPFILE1=\"/usr/pkg/share/bison.hairy\" -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1  -g  ./files.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g getargs.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g gram.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g lalr.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g lex.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g main.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g nullable.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g output.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g print.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g reader.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g reduce.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g symtab.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g warshall.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g version.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g getopt.c
cc -c -DSTDC_HEADERS=1 -DHAVE_STRING_H=1 -DHAVE_STDLIB_H=1 -DHAVE_MEMORY_H=1 -DHAVE_ALLOCA=1 -DHAVE_STRERROR=1 -I./../include  -g getopt1.c
cc  -g -o bison LR0.o allocate.o closure.o conflicts.o derives.o files.o         getargs.o gram.o lalr.o lex.o                                   main.o nullable.o output.o print.o reader.o reduce.o symtab.o   warshall.o version.o getopt.o getopt1.o
./files.c:240: warning: mktemp() possibly used unsafely, consider using mkstemp()
rm -f bison.s1
sed -e "/^#line/ s|bison|/usr/pkg/share/bison|" &lt; ./bison.simple &gt; bison.s1</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Everything seems OK, so install the files:</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre># make install
&gt;&gt; Checksum OK for bison-1.25.tar.gz.
===&gt;  Installing for bison-1.25
sh ./mkinstalldirs /usr/pkg/bin /usr/pkg/share  /usr/pkg/info /usr/pkg/man/man1
rm -f /usr/pkg/bin/bison
cd /usr/pkg/share; rm -f bison.simple bison.hairy
rm -f /usr/pkg/man/man1/bison.1 /usr/pkg/info/bison.info*
install -c  -o bin -g bin -m 555 bison /usr/pkg/bin/bison
/usr/bin/install -c -o bin -g bin -m 644 bison.s1 /usr/pkg/share/bison.simple
/usr/bin/install -c -o bin -g bin -m 644 ./bison.hairy /usr/pkg/share/bison.hairy
cd .; for f in bison.info*;  do /usr/bin/install -c -o bin -g bin -m 644 $f /usr/pkg/info/$f; done
/usr/bin/install -c -o bin -g bin -m 644 ./bison.1 /usr/pkg/man/man1/bison.1
===&gt;  Registering installation for bison-1.25</pre>
</div>
</div>
<div class="paragraph">
<p>You can now use bison, and also - if you decide so - remove it with <strong>pkg_delete bison</strong>. Should you decide that you want a binary package, do this now:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># make package
&gt;&gt; Checksum OK for bison-1.25.tar.gz.
===&gt;  Building package for bison-1.25
Creating package bison-1.25.tgz
Registering depends:.
Creating gzip'd tar ball in '/u/pkgsrc/lang/bison/bison-1.25.tgz'</pre>
</div>
</div>
<div class="paragraph">
<p>Now that you don&#8217;t need the source and object files any more, clean up:</p>
</div>
<div class="literalblock">
<div class="content">
<pre># make clean
===&gt;  Cleaning for bison-1.25</pre>
</div>
</div>
</div>
</div>
<h1 id="_appendix_b_security_hardening" class="sect0">Appendix B. Security hardening</h1>
<div class="paragraph">
<p>A number of mechanisms are available in pkgsrc to improve the security of the resulting system. This page describes the mechanisms, and gives hints about detecting and fixing problems.</p>
</div>
<div class="paragraph">
<p>Mechanisms can be enabled individually in <code>mk.conf</code>, and are individually described below.</p>
</div>
<div class="paragraph">
<p>Typically, a feature will cause some programs to fail to build or work when first enabled. This can be due to latent problems in the program, and can be due to other reasons. After enough testing to have confidence that user problems will be quite rare, individual mechanisms will be enabled by default.</p>
</div>
<div class="paragraph">
<p>For each mechanism, see the Caveats section below for an explanation of what might go wrong at compile time and at run time, and how to notice and address these problems.</p>
</div>
<div class="sect1">
<h2 id="_b_1_mechanisms">B.1. Mechanisms</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_b_1_1_enabled_by_default">B.1.1. Enabled by default</h3>
<div class="sect3">
<h4 id="_b_1_1_1_pkgsrc_use_fortify">B.1.1.1. PKGSRC_USE_FORTIFY</h4>
<div class="paragraph">
<p>This allows substitute wrappers to be used for some commonly used library functions that do not have built-in bounds checking - but could in some cases.</p>
</div>
<div class="paragraph">
<p>Two mitigation levels are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"weak" only enables checks at compile-time.</p>
</li>
<li>
<p>"strong" enables checks at compile-time and runtime. "strong" has been enabled by default since pkgsrc-2017Q3.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_b_1_1_2_pkgsrc_use_ssp">B.1.1.2. PKGSRC_USE_SSP</h4>
<div class="paragraph">
<p>This enables a stack-smashing protection mitigation. It is done by adding a guard variable to functions with vulnerable objects. The guards are initialized when a function is entered and then checked when the function exits. The guard check will fail and the program forcibly exited if the variable was modified in the meantime. This can happen in case of buffer overflows or memory corruption, and therefore exposing these bugs.</p>
</div>
<div class="paragraph">
<p>Different mitigation levels are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"yes", which will only protect functions considered vulnerable by the compiler;</p>
</li>
<li>
<p>"all", which will protect every function;</p>
</li>
<li>
<p>"strong", the default, which will apply a better balance between the two settings above.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This mitigation is supported by both GCC and clang. It may be supported in additional compilers, possibly under a different name. It is particularly useful for unsafe programming languages, such as C/C++.</p>
</div>
<div class="ulist">
<ul>
<li>
<p>"yes" is enabled by default where known supported since pkgsrc-2017Q3.</p>
</li>
<li>
<p>"strong" is enabled by default where known supported since pkgsrc-2021Q4.
More details can be found here:</p>
</li>
<li>
<p><a href="https://en.wikipedia.org/wiki/Buffer_overflow_protection">Buffer overflow protection on Wikipedia</a></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_b_1_1_3_pkgsrc_mkpie">B.1.1.3. PKGSRC_MKPIE</h4>
<div class="paragraph">
<p>This requests the creation of PIE (Position Independent Executables) for all executables. The PIE mechanism is normally used for shared libraries, so that they can be loaded at differing addresses at runtime. PIE itself does not have useful security properties; however, it is necessary to fully leverage some, such as ASLR. Some operating systems support Address Space Layout Randomization (ASLR), which causes different addresses to be used each time a program is run. This makes it more difficult for an attacker to guess addresses and thus makes exploits harder to construct. With PIE, ASLR can really be applied to the entire program, instead of the stack and heap only.</p>
</div>
<div class="paragraph">
<p>PIE executables will only be built for toolchains that are known to support PIE. Currently, this means NetBSD on x86, ARM, SPARC64, m68k, and MIPS.</p>
</div>
<div class="paragraph">
<p><code>PKGSRC_MKPIE</code> was enabled by default after the pkgsrc-2021Q3 branch.</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_1_1_4_pkgsrc_use_relro">B.1.1.4. PKGSRC_USE_RELRO</h4>
<div class="paragraph">
<p>This also makes the exploitation of some security vulnerabilities more difficult in some cases.</p>
</div>
<div class="paragraph">
<p>Two different mitigation levels are available:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>partial (the default): the ELF sections are reordered so that internal data sections precede the program&#8217;s own data sections, and non-PLT GOT is read-only;</p>
</li>
<li>
<p>full: in addition to partial RELRO, every relocation is performed immediately when starting the program, allowing the entire GOT to be read-only. This can greatly slow down startup of large programs.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>This is currently supported by GCC. Many software distributions now enable this feature by default, at the "partial"     level.</p>
</div>
<div class="paragraph">
<p>More details can be found here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://www.redhat.com/en/blog/hardening-elf-binaries-using-relocation-read-only-relro">Hardening ELF binaries using Relocation Read-Only (RELRO)</a></p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_b_1_2_not_enabled_by_default">B.1.2. Not enabled by default</h3>
<div class="sect3">
<h4 id="_b_1_2_1_pkgsrc_mkrepro">B.1.2.1. PKGSRC_MKREPRO</h4>
<div class="paragraph">
<p>With this option, pkgsrc will try to build packages reproducibly. This allows packages built from the same tree and with the same options, to produce identical results bit by bit. This option should be combined with ASLR and <code>PKGSRC_MKPIE</code> to avoid predictable address offsets for attackers attempting to exploit security vulnerabilities.</p>
</div>
<div class="paragraph">
<p>More details can be found here:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="https://reproducible-builds.org/">Reproducible Builds - a set of software development practices that create an independently-verifiable path from source to binary code</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>More work likely needs to be done before pkgsrc is fully reproducible.</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_1_2_2_pkgsrc_use_stack_check">B.1.2.2. PKGSRC_USE_STACK_CHECK</h4>
<div class="paragraph">
<p>This uses <code>-fstack-check</code> with GCC for another stack protection mitigation.</p>
</div>
<div class="paragraph">
<p>It asks the compiler to generate code verifying that it does not corrupt the stack. According to GCC&#8217;s manual page, this is really only useful for multi-threaded programs.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_b_2_caveats">B.2. Caveats</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_b_2_1_problems_with_pkgsrc_mkpie">B.2.1. Problems with PKGSRC_MKPIE</h3>
<div class="sect3">
<h4 id="_b_2_1_1_packages_failing_to_build">B.2.1.1. Packages failing to build</h4>
<div class="paragraph">
<p>A number of packages may fail to build with this option enabled. The failures are often related to the absence of the <code>-fPIC</code> compilation flag when building libraries or executables (or ideally <code>-fPIE</code> in the latter case). This flag is added to the <code>CFLAGS</code> already, but requires the package to actually support it.</p>
</div>
<div class="sect4">
<h5 id="_b_2_1_1_1_how_to_fix">B.2.1.1.1. How to fix</h5>
<div class="paragraph">
<p>These instructions are meant as a reference only; they likely need to be adapted for many packages individually.</p>
</div>
<div class="paragraph">
<p>For packages using <code>Makefiles</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MAKE_FLAGS+=	CFLAGS=${CFLAGS:Q}
MAKE_FLAGS+=	LDFLAGS=${LDFLAGS:Q}</pre>
</div>
</div>
<div class="paragraph">
<p>For packages using <code>Imakefiles</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>MAKE_FLAGS+=	CCOPTIONS=${CFLAGS:Q}
MAKE_FLAGS+=	LOCAL_LDFLAGS=${LDFLAGS:Q}</pre>
</div>
</div>
</div>
</div>
<div class="sect3">
<h4 id="_b_2_1_2_run_time_crashes">B.2.1.2. Run-time crashes</h4>
<div class="paragraph">
<p>Some programs may fail to run, or crash at random times once built as PIE. Two scenarios are essentially possible. This is nearly always due to a bug in the program being exposed due to ASLR.</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_2_1_3_disabling_pkgsrc_mkpie_on_a_per_package_basis">B.2.1.3. Disabling PKGSRC_MKPIE on a per-package basis</h4>
<div class="paragraph">
<p>Ideally, packages should be fixed for compatibility with MKPIE. However, in some cases this is very difficult, due to complex build systems, packages using non-standard toolchains, or programming languages with odd bootstrapping mechanisms.</p>
</div>
<div class="paragraph">
<p>To disable <code>PKGSRC_MKPIE</code> on a per-package basis, set <code>MKPIE_SUPPORTED= no</code> in the package&#8217;s Makefile before <code>bsd.prefs.mk</code> is included.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_b_2_2_problems_with_pkgsrc_use_fortify">B.2.2. Problems with PKGSRC_USE_FORTIFY</h3>
<div class="sect3">
<h4 id="_b_2_2_1_packages_failing_to_build">B.2.2.1. Packages failing to build</h4>
<div class="paragraph">
<p>This feature makes use of pre-processing directives to look for hardened, alternative implementations of essential library calls. Some programs may fail to build as a result; this usually happens for those trying too hard to be portable, or otherwise abusing definitions in the standard library.</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_2_2_2_run_time_crashes">B.2.2.2. Run-time crashes</h4>
<div class="paragraph">
<p>This feature may cause some programs to crash, usually indicating an actual bug in the program. The fix will typically involve patching the original program&#8217;s source code.</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_2_2_3_optimization_is_required">B.2.2.3. Optimization is required</h4>
<div class="paragraph">
<p>At least in the case of GCC, FORTIFY will only be applied if optimization is applied while compiling. This means that the <code>CFLAGS</code> should also contain <code>-O</code>, <code>-O2</code> or another optimization level. This cannot easily be applied globally, as some packages may require specific optimization levels.</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_2_2_4_disabling_fortify_on_a_per_package_basisnote">B.2.2.4. Disabling FORTIFY on a per-package basis[NOTE]</h4>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Note</strong></p>
</div>
<div class="paragraph">
<p>FORTIFY should not be disabled to work around runtime crashes in the program! This is a very bad idea and will expose you to security vulnerabilities.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>To disable FORTIFY on a per-package basis, set the following in the package&#8217;s <code>Makefile</code> before <code>bsd.prefs.mk</code> is included:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>FORTIFY_SUPPORTED=	no</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_b_2_3_problems_with_pkgsrc_use_relro">B.2.3. Problems with PKGSRC_USE_RELRO</h3>
<div class="sect3">
<h4 id="_b_2_3_1_performance_impact">B.2.3.1. Performance impact</h4>
<div class="paragraph">
<p>For better protection, full RELRO requires every symbol to be resolved when the program starts, rather than simply when required at run-time. This will have more impact on programs using a lot of symbols, or linked to libraries exposing a lot of symbols. Therefore, daemons or programs otherwise running in background are affected only when started. Programs loading plug-ins at run-time are affected when loading the plug-ins.</p>
</div>
<div class="paragraph">
<p>The impact is not expected to be noticeable on modern hardware, except in some cases for big programs.</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_2_3_2_run_time_crashes">B.2.3.2. Run-time crashes</h4>
<div class="paragraph">
<p>Some programs handle plug-ins and dependencies in a way that conflicts with RELRO: for instance, with an initialization routine listing any other plug-in required. With full RELRO, the missing symbols are resolved before the initialization routine can run, and the dynamic loader will not be able to find them directly and abort as a result. Unfortunately, this is how Xorg loads its drivers. Partial RELRO can be applied instead in this case.</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_2_3_3_disabling_relro_on_a_per_package_basis">B.2.3.3. Disabling RELRO on a per-package basis</h4>
<div class="paragraph">
<p>To disable RELRO on a per-package basis, set the following in the package&#8217;s <code>Makefile</code> before <code>bsd.prefs.mk</code> is included:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>RELRO_SUPPORTED=	no</pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to at most enable partial RELRO, by setting <code>RELRO_SUPPORTED</code> to <code>partial</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_b_2_4_problems_with_pkgsrc_use_ssp">B.2.4. Problems with PKGSRC_USE_SSP</h3>
<div class="sect3">
<h4 id="_b_2_4_1_packages_failing_to_build">B.2.4.1. Packages failing to build</h4>
<div class="paragraph">
<p>The stack-smashing protection provided by this option does not work for some programs. The most common situation in which this happens is when the program allocates variables on the stack, with the size determined at run-time.</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_2_4_2_run_time_crashes">B.2.4.2. Run-time crashes</h4>
<div class="paragraph">
<p>Again, this feature may cause some programs to crash via a <code>SIGABRT</code>, usually indicating an actual bug in the program.</p>
</div>
<div class="paragraph">
<p>On NetBSD <code>LOG_CRIT</code> level syslog messages are sent and - by default - appended to <code>/var/log/messages</code>, e.g.:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Jan  6 15:42:51 hostname -: hostname program - - - buffer overflow detected; terminated</pre>
</div>
</div>
<div class="paragraph">
<p>(where <code>hostname</code> is the hostname(1) and <code>program</code> is the basename(1) of the program crashed).</p>
</div>
<div class="paragraph">
<p>Patching the original program is then required.</p>
</div>
<div class="paragraph">
<p>Rebuilding the package via:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>% env CFLAGS=-g INSTALL_UNSTRIPPED=yes make replace</pre>
</div>
</div>
<div class="paragraph">
<p>and inspecting the backtrace of the coredump via the debugger should point out the problematic call by inspecting the frame calling the _chk() (SSP) function.</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_2_4_3_performance_impact">B.2.4.3. Performance impact</h4>
<div class="paragraph">
<p>The compiler emits extra code when using this feature: a check for buffer overflows is performed when entering and exiting functions, requiring an extra variable on the stack. The level of protection can otherwise be adjusted to affect only those functions considered more sensitive by the compiler (with -fstack-protector instead of -fstack-protector-all).</p>
</div>
<div class="paragraph">
<p>The impact is not expected to be noticeable on modern hardware. However, programs with a hard requirement to run at the fastest possible speed should avoid using this feature, or using libraries built with this feature.</p>
</div>
</div>
<div class="sect3">
<h4 id="_b_2_4_4_disabling_ssp_on_a_per_package_basisnote">B.2.4.4. Disabling SSP on a per-package basis[NOTE]</h4>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Note</strong></p>
</div>
<div class="paragraph">
<p>SSP should not be disabled to work around runtime crashes in the program! This is a very bad idea and will expose you to security vulnerabilities.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>To disable SSP on a per-package basis, set the following in the package&#8217;s <code>Makefile</code> before <code>bsd.prefs.mk</code> is included:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>SSP_SUPPORTED=	no</pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_b_3_auditing_the_system">B.3. Auditing the system</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The illusion of security is worse than having no security at all. This section lists a number of ways to ensure the security features requested are actually effective.</p>
</div>
<div class="paragraph">
<p>These instructions were obtained and tested on a system derived from NetBSD 7 (amd64). YMMV.</p>
</div>
<div class="sect2">
<h3 id="_b_3_1_checking_for_pie">B.3.1. Checking for PIE</h3>
<div class="paragraph">
<p>The ELF executable type in use changes for binaries built as PIE; without:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ file /path/to/bin/ary
/path/to/bin/ary: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for NetBSD 7.0, not stripped</pre>
</div>
</div>
<div class="paragraph">
<p>as opposed to the following binary, built as PIE:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ file /path/to/pie/bin/ary
/path/to/pie/bin/ary: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked (uses shared libs), for NetBSD 7.0, not stripped</pre>
</div>
</div>
<div class="paragraph">
<p>The latter result is then what is expected.</p>
</div>
</div>
<div class="sect2">
<h3 id="_b_3_2_checking_for_partial_relro">B.3.2. Checking for partial RELRO</h3>
<div class="paragraph">
<p>The following command should list a section called RELRO:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ objdump -p /path/to/bin/ary
/path/to/bin/ary:     file format elf64-x86-64
Program Header:
[...]
RELRO off    0x0000000000000d78 vaddr 0x0000000000600d78 paddr 0x0000000000600d78 align 2**0</pre>
</div>
</div>
<div class="paragraph">
<p>This check is now performed automatically if <code>PKG_DEVELOPER</code> is set and RELRO is enabled.</p>
</div>
</div>
<div class="sect2">
<h3 id="_b_3_3_checking_for_full_relro">B.3.3. Checking for full RELRO</h3>
<div class="paragraph">
<p>The dynamic loader will apply RELRO immediately when detecting the presence of the <code>BIND_NOW</code> flag:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ objdump -x /path/to/bin/ary
/path/to/bin/ary:     file format elf64-x86-64
Dynamic Section:
[...]
BIND_NOW             0x0000000000000000</pre>
</div>
</div>
<div class="paragraph">
<p>This has to be combined with partial RELRO (see above) to be fully efficient.</p>
</div>
<div class="paragraph">
<p>This check is now performed automatically (where supported) if <code>PKG_DEVELOPER</code> is set.</p>
</div>
</div>
<div class="sect2">
<h3 id="_b_3_4_checking_for_ssp">B.3.4. Checking for SSP</h3>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Note</strong></p>
</div>
<div class="paragraph">
<p>Checking for SSP using this method only works where the operating system uses <code>libssp</code>. <code>libssp</code> is not used on recent NetBSD/FreeBSD/Linux versions.</p>
</div>
</div>
</div>
<div class="paragraph">
<p>Building objects, binaries and libraries with SSP will affect the presence of additional symbols in the resulting file:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$ nm /path/to/bin/ary
[...]
                 U __stack_chk_fail
0000000000600ea0 B __stack_chk_guard</pre>
</div>
</div>
<div class="paragraph">
<p>This is an indicator that the program was indeed built with support for SSP.</p>
</div>
<div class="paragraph">
<p>This check is now performed automatically (where supported) if <code>PKG_DEVELOPER</code> is set and SSP is enabled.</p>
</div>
</div>
</div>
</div>
<h1 id="_appendix_c_build_logs" class="sect0">Appendix C. Build logs</h1>
<div class="sect1">
<h2 id="_c_1_building_figlet">C.1. Building figlet</h2>
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre># make
===&gt; Checking for vulnerabilities in figlet-2.2.1nb2
=&gt; figlet221.tar.gz doesn't seem to exist on this system.
=&gt; Attempting to fetch figlet221.tar.gz from ftp://ftp.figlet.org/pub/figlet/program/unix/.
=&gt; [172219 bytes]
Connected to ftp.plig.net.
220 ftp.plig.org NcFTPd Server (licensed copy) ready.
331 Guest login ok, send your complete e-mail address as password.
230-You are user #5 of 500 simultaneous users allowed.
230-
230-  ___ _             _ _
230- |  _| |_ ___   ___| |_|___   ___ ___ ___
230- |  _|  _| . |_| . | | | . |_| . |  _| . |
230- |_| |_| |  _|_|  _|_|_|_  |_|___|_| |_  |
230-         |_|   |_|     |___|         |___|
230-
230-** Welcome to ftp.plig.org **
230-
230-Please note that all transfers from this FTP site are logged. If you
230-do not like this, please disconnect now.
230-
230-This archive is available via
230-
230-HTTP:  http://ftp.plig.org/
230-FTP:   ftp://ftp.plig.org/     (max 500 connections)
230-RSYNC: rsync://ftp.plig.org/   (max  30 connections)
230-
230-Please email comments, bug reports and requests for packages to be
230-mirrored to ftp-admin@plig.org.
230-
230-
230 Logged in anonymously.
Remote system type is UNIX.
Using binary mode to transfer files.
200 Type okay.
250 "/pub" is new cwd.
250-"/pub/figlet" is new cwd.
250-
250-Welcome to the figlet archive at ftp.figlet.org
250-
250-	ftp://ftp.figlet.org/pub/figlet/
250-
250-The official FIGlet web page is:
250-	http://www.figlet.org/
250-
250-If you have questions, please mailto:info@figlet.org. If you want to
250-contribute a font or something else, you can email us.
250
250 "/pub/figlet/program" is new cwd.
250 "/pub/figlet/program/unix" is new cwd.
local: figlet221.tar.gz remote: figlet221.tar.gz
502 Unimplemented command.
227 Entering Passive Mode (195,40,6,41,246,104)
150 Data connection accepted from 84.128.86.72:65131; transfer starting for figlet221.tar.gz (172219 bytes).
38% |**************                       | 65800      64.16 KB/s    00:01 ETA
226 Transfer completed.
172219 bytes received in 00:02 (75.99 KB/s)
221 Goodbye.
=&gt; Checksum OK for figlet221.tar.gz.
===&gt; Extracting for figlet-2.2.1nb2
===&gt; Required installed package ccache-[0-9]*: ccache-2.3nb1 found
===&gt; Patching for figlet-2.2.1nb2
===&gt; Applying pkgsrc patches for figlet-2.2.1nb2
===&gt; Overriding tools for figlet-2.2.1nb2
===&gt; Creating toolchain wrappers for figlet-2.2.1nb2
===&gt; Configuring for figlet-2.2.1nb2
===&gt; Building for figlet-2.2.1nb2
gcc -O2 -DDEFAULTFONTDIR=\"/usr/pkg/share/figlet\"  -DDEFAULTFONTFILE=\"standard.flf\"  figlet.c zipio.c crc.c inflate.c -o figlet
chmod a+x figlet
gcc -O2 -o chkfont chkfont.c
=&gt; Unwrapping files-to-be-installed.
#
# make install
===&gt; Checking for vulnerabilities in figlet-2.2.1nb2
===&gt; Installing for figlet-2.2.1nb2
install -d -o root -g wheel -m 755 /usr/pkg/bin
install -d -o root -g wheel -m 755 /usr/pkg/man/man6
mkdir -p /usr/pkg/share/figlet
cp figlet /usr/pkg/bin
cp chkfont /usr/pkg/bin
chmod 555 figlist showfigfonts
cp figlist /usr/pkg/bin
cp showfigfonts /usr/pkg/bin
cp fonts/*.flf /usr/pkg/share/figlet
cp fonts/*.flc /usr/pkg/share/figlet
cp figlet.6 /usr/pkg/man/man6
===&gt; Registering installation for figlet-2.2.1nb2
#</pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_c_2_packaging_figlet">C.2. Packaging figlet</h2>
<div class="sectionbody">
<div class="literalblock">
<div class="content">
<pre># make package
===&gt; Checking for vulnerabilities in figlet-2.2.1nb2
===&gt; Packaging figlet-2.2.1nb2
===&gt; Building binary package for figlet-2.2.1nb2
Creating package /home/cvs/pkgsrc/packages/i386/All/figlet-2.2.1nb2.tgz
Using SrcDir value of /usr/pkg
Registering depends:.
#</pre>
</div>
</div>
</div>
</div>
<h1 id="_appendix_d_directory_layout_of_the_pkgsrc_ftp_server" class="sect0">Appendix D. Directory layout of the pkgsrc FTP server</h1>
<div class="paragraph">
<p>As in other big projects, the directory layout of pkgsrc is quite complex for newbies. This chapter explains where you find things on the FTP server. The base directory on <code>ftp.NetBSD.org</code> is <a href="ftp://ftp.netbsd.org/pub/pkgsrc/"><code>/pub/pkgsrc/</code></a>. On other servers it may be different, but inside this directory, everything should look the same, no matter on which server you are. This directory contains some subdirectories, which are explained below.</p>
</div>
<div class="sect1">
<h2 id="_d_1_distfiles_the_distributed_source_files">D.1. distfiles: The distributed source files</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The directory <code>distfiles</code> contains lots of archive files from all pkgsrc packages, which are mirrored here. The subdirectories are called after their package names and are used when the distributed files have names that don&#8217;t explicitly contain a version number or are otherwise too generic (for example <code>release.tar.gz</code>).</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_d_2_misc_miscellaneous_things">D.2. misc: Miscellaneous things</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This directory contains things that individual pkgsrc developers find worth publishing.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_d_3_packages_binary_packages">D.3. packages: Binary packages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This directory contains binary packages for the various platforms that are supported by pkgsrc. Each subdirectory is of the form <em><code>OPSYS</code></em>/<em><code>ARCH</code></em>/<em><code>OSVERSION_TAG</code></em>. The meaning of these variables is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>OPSYS</code> is the name of the operating system for which the packages have been built. The name is taken from the output of the <strong>uname</strong> command, so it may differ from the one you are used to hear.</p>
</li>
<li>
<p><code>ARCH</code> is the hardware architecture of the platform for which the packages have been built. It also includes the <code>ABI</code> (Application Binary Interface) for platforms that have several of them.</p>
</li>
<li>
<p><code>OSVERSION</code> is the version of the operating system. For version numbers that change often (for example NetBSD-current), the often-changing part should be replaced with an <code>x</code>, for example <code>4.99.x</code>.</p>
</li>
<li>
<p><code>TAG</code> is either <code>20<em>&lt;code&gt;xx</code></em>Q<em><code>y</code></em>&lt;/code&gt; for a stable branch, or <code>head</code> for packages built from the HEAD branch. The latter should only be used when the packages are updated on a regular basis. Otherwise the date from checking out pkgsrc should be appended, for example <code>head_20071015</code>.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>The rationale for exactly this scheme is that the pkgsrc users looking for binary packages can quickly click through the directories on the server and find the best binary packages for their machines. Since they usually know the operating system and the hardware architecture, OPSYS and ARCH are placed first. After these choices, they can select the best combination of OSVERSION and TAG together, since it is usually the case that packages stay compatible between different version of the operating system.</p>
</div>
<div class="paragraph">
<p>In each of these directories, there is a whole binary packages collection for a specific platform. It has a directory called <code>All</code> which contains all binary packages. Besides that, there are various category directories that contain symbolic links to the real binary packages.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_d_4_reports_bulk_build_reports">D.4. reports: Bulk build reports</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here are the reports from bulk builds, for those who want to fix packages that didn&#8217;t build on some of the platforms. The structure of subdirectories should look like the one in <a href="http://www.netbsd.org/docs/pkgsrc/ftp-layout.html#ftp-packages">Section D.3, “<code>packages</code>: Binary packages”</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_d_5_current_stable_pkgsrc_20xxqy_source_packages">D.5. current, stable, pkgsrc-20xxQy: source packages</h2>
<div class="sectionbody">
<div class="paragraph">
<p>These directories contain the “real” pkgsrc, that is the files that define how to create binary packages from source archives.</p>
</div>
<div class="paragraph">
<p>Each of the <code>current</code>, <code>stable</code> and <code>pkgsrc-20<em>xx</code></em>Q<em><code>y</code></em> directories share the same structure. They each contain a <code>pkgsrc</code> directory and <code>pkgsrc.tar.{bz,gz,xz}</code> file.</p>
</div>
<div class="paragraph">
<p>The directory <code>pkgsrc</code> contains a snapshot of the CVS repository, which is updated regularly. The file <code>pkgsrc.tar.{bz,gz,xz}</code> contains the same as the directory, ready to be downloaded as a whole.</p>
</div>
<div class="paragraph">
<p>The <code>current</code> directory contains files related to the HEAD branch of the CVS repository. In this directory there is an additional file called <code>pkgsrc-readmes.tar.{bz,gz,xz}</code> that contains all pkgsrc <code>README</code>s with information about categories and packages.</p>
</div>
<div class="paragraph">
<p>The <code>stable</code> directory is a symlink to the latest <code>pkgsrc-20<em>xx</code></em>Q<em><code>y</code></em>.</p>
</div>
<div class="paragraph">
<p>The <code>pkgsrc-20<em>xx</code></em>Q<em><code>y</code></em>. directories contain files related to the <code>-20<em>xx</code></em>Q<em><code>y</code></em> stable branch of the CVS repository. In these directories there is an additional file called <code>pkgsrc-20<em>xx</code></em>Q<em><code>y</code></em>.tar.{bz,gz,xz}, which contains the state of pkgsrc when it was branched.</p>
</div>
</div>
</div>
<h1 id="_appendix_e_help_topics" class="sect0">Appendix E. Help topics</h1>
<div class="paragraph">
<p>The following list contains all help topics that are available when running <strong>bmake help topic=:index</strong>.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">#!</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">-lintl</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">32bit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">64bit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ABI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ACCEPTABLE_LICENSES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ACROREAD_FONTPATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ADDITIONAL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AFAIK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AIX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALLOW_VULNERABLE_PACKAGES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALL_ENV</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ALTERNATIVES_SRC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMANDA_TMP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMANDA_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AMANDA_VAR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">APACHE_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">APACHE_MODULE_NAME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">APACHE_MODULE_SRC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">APACHE_MODULE_SRCDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">APACHE_PKG_PREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">APACHE_SUEXEC_CONFIGURE_ARGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">APACHE_SUEXEC_DOCROOT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">APACHE_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">APPEND_ABI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">APPEND_ELF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ARLA_CACHE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AUDIT_PACKAGES_FLAGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AUTOCONF_REQD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AUTOMAKE_OVERRIDE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">AUTOMAKE_REQD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">AUTO_MKDIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BDB185_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BDBBASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BDB_ACCEPTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BDB_DEFAULT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BDB_LIBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BDB_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BINCIMAP_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BINCIMAP_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIND_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIND_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIND_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BINOWN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BINPKG_SITES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BIN_INSTALL_FLAGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BISON_PKGDATADIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BLAS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BLAS_ACCEPTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BLAS_C_INTERFACE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BLAS_INCLUDES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BLAS_INDEX64</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BLAS_LIBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BLAS_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BOOTSTRAP_DEPENDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BROKEN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BROKEN_EXCEPT_ON_PLATFORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BROKEN_ON_PLATFORM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BSDSRCDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BSDXSRCDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BSD_MAKE_ENV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_AUTO_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_AUTO_VARS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_CFLAGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_CONTENTS_FILTER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_CPPFLAGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_FILES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_FILES_CMD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_FNAME_TRANSFORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_LDFLAGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_LIBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_OPSYS_SUPPORT_PTHREAD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_PKGNAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_PREFIX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_RPATHDIRS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILDLINK_TREE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILD_DEFS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILD_DEFS_EFFECTS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILD_DEPENDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILD_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILD_ENV_SHELL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILD_MAKE_CMD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILD_MAKE_FLAGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILD_TARGET</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_FIND_FILES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_FIND_FILES_VAR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_FIND_GREP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_FIND_HEADERS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_FIND_HEADERS_VAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_FIND_PKGCONFIG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_FIND_PKGCONFIG_VAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_PKG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_TEST_CURSES_DEFINES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_TEST_CURSES_FUNCS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_VERSION_SCRIPT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_X11_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">BUILTIN_X11_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CACTI_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CACTI_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CANNA_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CANNA_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CAT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CBLAS_LIBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCACHE_BASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCACHE_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CCACHE_LOGFILE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CC_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CC_VERSION_STRING</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDRECORD_CONF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDROM_PKG_URL_DIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CDROM_PKG_URL_HOST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_COMPILER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_FAKEHOME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_FILES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_FILES_SKIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_FILES_STRICT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_HEADERS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_HEADERS_SKIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_INTERPRETER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_INTERPRETER_SKIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_PERMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_PERMS_AUTOFIX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_PERMS_SKIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_PIE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_PIE_SKIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_PIE_SUPPORTED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_PORTABILITY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_PORTABILITY_EXPERIMENTAL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_PORTABILITY_SKIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_RELRO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_RELRO_SKIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_RELRO_SUPPORTED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_SHLIBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_SHLIBS_SKIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_SHLIBS_SUPPORTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_SHLIBS_TOXIC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_SSP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_SSP_SKIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_SSP_SUPPORTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_STRIPPED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_STRIPPED_SKIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_WRKREF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_WRKREF_EXTRA_DIRS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CHECK_WRKREF_SKIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLAMAV_DBDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLAMAV_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLAMAV_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLANGBASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CLEANDEPENDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMAKE_DEPENDENCIES_REWRITE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMAKE_INSTALL_NAME_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMAKE_INSTALL_PREFIX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMAKE_MODULE_PATH_OVERRIDE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMAKE_PKGSRC_BUILD_FLAGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMAKE_PREFIX_PATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CMAKE_USE_GNU_INSTALL_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMPILER_RPATH_FLAG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">COMPILER_USE_SYMLINKS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIGURE_ARGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIGURE_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIGURE_ENV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIGURE_ENV_SHELL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIGURE_HAS_INFODIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIGURE_HAS_MANDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIGURE_SCRIPT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIG_SHELL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONFIG_SHELL_FLAGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONF_FILES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONF_FILES_MODE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONF_FILES_PERMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSERVER_DEFAULTHOST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CONSERVER_DEFAULTPORT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CPP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CPP_PRECOMP_FLAGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CREATE_WRKDIR_SYMLINK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CROSSBASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTFCONVERT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTF_FILES_SKIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTF_SUPPORTED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CTYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CUPS_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CUPS_SYSTEM_GROUPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CUPS_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CURSES_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CURSES_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CXX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CYRUS_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">CYRUS_IDLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">CYRUS_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DAEMONTOOLS_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DAEMONTOOLS_LOG_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DARWIN_NO_SYSTEM_LIBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DARWIN_REQUIRES_FILTER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DBUS_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DBUS_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEFANG_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEFANG_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEFAULT_ACCEPTABLE_LICENSES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEFAULT_DISTFILES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEFAULT_IRC_SERVER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEFAULT_SERIAL_DEVICE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEF_UMASK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEINSTALLDEPENDS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEINSTALL_SRC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEINSTALL_TEMPLATES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELAYED_ERROR_MSG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DELAYED_WARNING_MSG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEPENDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEPENDS_TARGET</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DEPENDS_TYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DESTDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DESTDIR_VARNAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DIALER_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DIGEST_REQD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DISTDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DISTFILES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DISTINFO_FILE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DISTNAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DIST_PATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DIST_SUBDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DJBDNS_AXFR_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DJBDNS_CACHE_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DJBDNS_DJBDNS_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DJBDNS_LOG_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DJBDNS_RBL_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DJBDNS_TINY_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DLOPEN_REQUIRE_PTHREADS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DL_AUTO_VARS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DL_CFLAGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DL_LDFLAGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DL_LIBS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DNS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOCOWN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DOWNLOADED_DISTFILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DQCACHE_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DQCACHE_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DT_LAYOUT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">DYNAMIC_SITES_CMD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">DYNAMIC_SITES_SCRIPT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECHO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ECHO_N</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ELK_GUI</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMACS_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMULDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMULSUBDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMULSUBDIRSLASH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_ARCH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_DISTRO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_EXEC_FMT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_IS_NATIVE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_MODULES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_OPSYS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_PKG_FMT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_PLATFORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_PLATFORMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_PREFER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_REQD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EMUL_TYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ERROR_MSG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXIM_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXIM_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXPORT_SYMBOLS_LDFLAGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTRACTOR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTRACT_CMD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTRACT_CMD_DEFAULT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTRACT_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTRACT_ELEMENTS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTRACT_ENV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTRACT_ONLY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTRACT_OPTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTRACT_SUFX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">EXTRACT_USING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAIL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAILOVER_FETCH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAIL_MSG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAKE_NCURSES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAM_ACCEPTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAM_DEFAULT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FAM_SERVER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FCPATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FEATURE_CPPFLAGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FEATURE_LDFLAGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FEATURE_LIBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FETCH_AFTER_ARGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FETCH_BEFORE_ARGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FETCH_CMD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FETCH_OUTPUT_ARGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FETCH_PROXY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FETCH_RESUME_ARGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FETCH_TIMEOUT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FETCH_USE_IPV4_ONLY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FETCH_USING</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FILES_SUBST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FILES_SUBST_SED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FIX_SYSTEM_HEADERS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FONTS_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FONTS_VERBOSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FOO_HACKS_MK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FOX_USE_XUNICODE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FREEWNN_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FREEWNN_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">FTP_PKG_URL_DIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">FTP_PKG_URL_HOST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GAMEDATAMODE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GAMEDATA_PERMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GAMEDIRMODE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GAMEDIR_PERMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GAMEGRP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GAMEMODE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GAMEOWN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GAMES_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GAMES_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCCBASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCC_REQD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GCC_VERSION_SUFFIX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_BUILD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_CLEANBUILD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_CLEANBUILD_EXTENSIONS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_DOCDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_EXTSDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_HOME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_KEEPBUILD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_LIBDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_NAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_PATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_PLUGINSDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GEM_SPECFILE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GENERATE_PLIST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GHC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GHOSTSCRIPT_REQD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GITHUB_PROJECT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GITHUB_RELEASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GITHUB_SUBMODULES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GITHUB_TAG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GITHUB_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GITLAB_PROJECT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GITLAB_RELEASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GITLAB_SUBMODULES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GITLAB_TAG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GITLAB_TYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GNU</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GNU_CONFIGURE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GNU_CONFIGURE_INFODIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GNU_CONFIGURE_MANDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GNU_CONFIGURE_QUIET</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GNU_CONFIGURE_STRICT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GODEP_REDIRECTS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GO_BUILD_PATTERN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GO_DEPS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GO_DIST_BASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GO_EXTRA_MOD_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GO_MODULE_FILES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GO_SRCPATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GO_VERSION_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GROUP_SPECIFIC_PKGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GRUB_NETWORK_CARDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GRUB_PRESET_COMMAND</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">GRUB_SCAN_ARGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">GZIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HASKELL_ENABLE_DYNAMIC_EXECUTABLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HASKELL_ENABLE_HADDOCK_DOCUMENTATION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HASKELL_ENABLE_LIBRARY_PROFILING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HASKELL_ENABLE_SHARED_LIBRARY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HASKELL_OPTIMIZATION_LEVEL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HAS_CONFIGURE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HEADER_TEMPLATES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HOMEPAGE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HOST_PKGTOOLS_ARGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HOST_SPECIFIC_PKGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">HOWL_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">HOWL_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ICCBASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ICECAST_CHROOTDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ICON_THEMES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IDOBASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IGNORE_CCACHE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IGNORE_INFO_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IGNORE_INTERACTIVE_FETCH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IMAKE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IMAKEOPTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IMAKE_MAKE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IMAKE_MANINSTALL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IMAP_UW_CCLIENT_MBOX_FMT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IMDICTDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INCOMPAT_CURSES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO_FILES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO_FILES_VERBOSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INFO_MSG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INIT_SYSTEM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INN_DATA_DIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INN_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INN_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INSTALLATION_DIRS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INSTALLATION_DIRS_FROM_PLIST</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INSTALL_ENV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INSTALL_SH_OVERRIDE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INSTALL_SRC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">INSTALL_TEMPLATES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">INSTALL_UNSTRIPPED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IRCD_HYBRID_IRC_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IRCD_HYBRID_IRC_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IRCD_HYBRID_MAXCONN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IRCD_HYBRID_NICLEN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IRCD_HYBRID_SYSLOG_EVENTS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IRCD_HYBRID_SYSLOG_FACILITY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IRCD_HYBRID_TOPICLEN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">IRIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">IRRD_USE_PGP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JABBERD_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JABBERD_LOGDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JABBERD_PIDDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JABBERD_SPOOLDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JABBERD_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAVA_BINPREFIX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAVA_CLASSPATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAVA_HOME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAVA_LD_LIBRARY_PATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAVA_NAME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAVA_UNLIMIT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JAVA_WRAPPERS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">JPEG_ACCEPTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">JPEG_DEFAULT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KERBEROS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KERMIT_SUID_UUCP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KJS_USE_PCRE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KNEWS_DOMAIN_FILE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KNEWS_DOMAIN_NAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">KRB5_ACCEPTED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">KRB5_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LANGUAGES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LAPACKE_LIBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LAPACK_LIBS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LATEX2HTML_ICONPATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LDCONFIG_ADD_CMD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LDCONFIG_REMOVE_CMD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LDD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LEAFNODE_DATA_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LEAFNODE_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LEAFNODE_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIBDVDCSS_HOMEPAGE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIBDVDCSS_MASTER_SITES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIBRSVG_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIBTOOL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIBTOOLIZE_PLIST</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIBTOOL_M4_OVERRIDE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LIBUSB_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LICENSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LINKER_RPATH_FLAG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LINK_RPATH_FLAG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LINUX_LOCALES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOCALBASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOCALBASE_LOCKTYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOCALPATCHES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOVE_DATA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOVE_GAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LOVE_VERSION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LP32PLATFORMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LP64PLATFORMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_BUSTED_ARGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_CDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_COMPILER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_DOCDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_EXAMPLESDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_INCDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_INTERPRETER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_LDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_LINKER_MAGIC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_PKGPREFIX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_SELF_CONFLICT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_USE_BUSTED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_VERSIONS_ACCEPTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_VERSIONS_INCOMPATIBLE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_VERSION_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">LUA_VERSION_REQD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Lua</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MACHINE_PLATFORM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAILAGENT_DOMAIN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAILAGENT_EMAIL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAILAGENT_FQDN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAILAGENT_ORGANIZATION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAJORDOMO_HOMEDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAKEINFO_ARGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAKE_DIRS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAKE_DIRS_PERMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAKE_ENV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAKE_FILE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAKE_FLAGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAKE_JOBS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAKE_JOBS_SAFE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MAKE_PROGRAM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MANCOMPRESSED_IF_MANZ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MANINSTALL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MANZ</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_BACKUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_LOCAL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_MOZILLA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_OVERRIDE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SITE_PERL_CPAN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SORT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SORT_RANDOM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MASTER_SORT_REGEX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MECAB_CHARSET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MEDIATOMB_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MEDIATOMB_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MIPSPROBASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MIREDO_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MIREDO_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MISSING_FEATURES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MKDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MKPIE_SUPPORTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MLDONKEY_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MLDONKEY_HOME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MLDONKEY_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MONOTONE_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MONOTONE_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MOTIFBASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MOTIF_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MOTIF_TYPE_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MPI_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MSGFMT_STRIP_MSGCTXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MSGFMT_STRIP_MSGID_PLURAL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MTOOLS_ENABLE_FLOPPYD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MV</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MYSQL_CHARSET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MYSQL_DATADIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MYSQL_EXTRA_CHARSET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MYSQL_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MYSQL_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MYSQL_VERSION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MYSQL_VERSIONS_ACCEPTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">MYSQL_VERSIONS_ALL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">MYSQL_VERSION_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAGIOSCMD_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAGIOSDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAGIOS_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NAGIOS_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NATIVE_APPEND_ABI</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NATIVE_APPEND_ELF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NATIVE_EXEC_FMT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NATIVE_MACHINE_PLATFORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NATIVE_OBJECT_FMT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NBPAX_PROGRAM_PREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NETBSD_LOGIN_NAME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NMH_EDITOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NMH_MTA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NMH_PAGER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NODE_VERSIONS_ACCEPTED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NODE_VERSIONS_INCOMPATIBLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NODE_VERSION_DEFAULT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NODE_VERSION_REQD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NOLOGIN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NOTE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NOT_FOR_PLATFORM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NOT_PAX_ASLR_SAFE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NOT_PAX_MPROTECT_SAFE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NO_BUILD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NO_CHECKSUM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NO_CONFIGURE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NO_SKIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NS_PREFERRED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">NULLMAILER_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">NULLMAILER_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OASIS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OASIS_BUILD_ARGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OBJHOSTNAME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OBJMACHINE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCAML_FINDLIB_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCAML_FINDLIB_REGISTER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCAML_FINDLIB_REGISTER_VERBOSE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCAML_SITELIBDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCAML_TOPKG_DOCDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCAML_USE_DUNE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCAML_USE_FINDLIB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCAML_USE_OASIS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCAML_USE_OASIS_DYNRUN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCAML_USE_OPAM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OCAML_USE_TOPKG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OMF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ONLY_FOR_COMPILER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ONLY_FOR_PLATFORM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPENSSH_CHROOT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPENSSH_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPENSSH_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPSYS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPSYS_EMULDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OPSYS_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OSS_TYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OSX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OSX_TOLERATE_SDK_SKEW</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OS_VARIANT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OS_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OTF_FONTS_DIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OVERRIDE_DIRDEPTH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OVERRIDE_GEMSPEC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OVERRIDE_GNU_CONFIG_SCRIPTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">OWN_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">OWN_DIRS_PERMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P4GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">P4PORT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">P4ROOT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">P4USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PACKAGES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PALMOS_DEFAULT_SDK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAMBASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAM_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PAPERSIZE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PASSIVE_FETCH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCHDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCHFILES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCH_ARGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCH_DEBUG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCH_DIST_ARGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCH_DIST_CAT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCH_DIST_STRIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCH_FUZZ_FACTOR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATCH_STRIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PCCBASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PEAR_CMD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PEAR_LIB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PEAR_PACKAGE_XML</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5_CONFIGURE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5_CONFIGURE_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5_LDFLAGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5_LICENSE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5_MODULE_TYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5_PACKLIST</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5_PACKLIST_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5_PERLBASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5_SITEBASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5_USE_PACKLIST</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PERL5_VENDORBASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PFCTL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PFVAR_H</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PF_VERSION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PGGROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PGHOME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PGPKGSRCDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PGSQL_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PGSQL_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PGSQL_VERSIONS_ACCEPTED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PGSQL_VERSION_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PGUSER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PG_LIB_EXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHPCOMMON_MK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHPPKGSRCDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHP_BASE_VERS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHP_CHECK_INSTALLED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHP_EXTENSION_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHP_INITIAL_TEENY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHP_PKG_PREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHP_VERSION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHP_VERSIONS_ACCEPTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHP_VERSIONS_INCOMPATIBLE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHP_VERSION_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PHP_VERSION_REQD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PILRC_USE_GTK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGCONFIG_BASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGCONFIG_FILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGCONFIG_OVERRIDE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGCONFIG_OVERRIDE_STAGE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGGNUDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGINFODIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGLOCALEDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGMANDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGNAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGNAME_REQD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGPATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGREVISION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_BLAS_TYPES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_CHANGES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_COMPILER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_KEEP_BIN_PKGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_LOCKTYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_MAKE_ENV</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_MESSAGE_RECIPIENTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_MKPIE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_MKREPRO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_OVERRIDE_MKPIE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_RUN_TEST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_SETENV</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_SLEEPSECS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_TODO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_USE_CTF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_USE_FORTIFY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_USE_RELRO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_USE_SSP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGSRC_USE_STACK_CHECK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGTASKS_DATAFILE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGTOOLS_ARGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKGTOOLS_ENV</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_ALTERNATIVES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_APACHE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_APACHE_ACCEPTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_APACHE_DEFAULT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_BEST_EXISTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_BUILD_OPTIONS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_COMPRESSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_CONFIG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_CONFIG_PERMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_CREATE_USERGROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_DB_TMPDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_DEBUG_LEVEL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_DEFAULT_OPTIONS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_DESTDIR_SUPPORT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_DEVELOPER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_DISABLED_OPTIONS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_FATAL_ERRORS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_FC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_FILELIST_CMD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_GECOS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_GID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_GROUPS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_GROUPS_VARS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_HOME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_INIT_SCRIPTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_JAVA_HOME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_JVM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_JVMS_ACCEPTED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_JVM_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_LEGACY_OPTIONS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_LIBTOOL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_OPTIONS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_OPTIONS_DEPRECATED_WARNINGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_OPTIONS_LEGACY_OPTS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_OPTIONS_LEGACY_VARS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_OPTIONS_NONEMPTY_SETS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_OPTIONS_OPTIONAL_GROUPS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_OPTIONS_REQUIRED_GROUPS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_OPTIONS_VAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_PHP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_PHP_MAJOR_VERS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_PHP_VERSION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_RCD_SCRIPTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_REFCOUNT_DBDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_REGISTER_SHELLS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_RESUME_TRANSFERS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_SHELL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_SUGGESTED_OPTIONS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_SUPPORTED_OPTIONS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_SYSCONFBASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_SYSCONFBASEDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_SYSCONFDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_SYSCONFDIR_PERMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_SYSCONFSUBDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_SYSCONFVAR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_TOOLS_BIN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_UID</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_UPDATE_FONTS_DB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_USERS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_USERS_VARS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PKG_VERBOSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLEASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLIST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLIST_AWK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLIST_AWK_ENV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLIST_SRC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLIST_SUBST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLIST_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PLIST_VARS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POPTOP_USE_MPPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">POSSIBLE_GFORTRAN_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">POST_FETCH_HOOK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PREFER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PREFER_NATIVE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PREFER_NATIVE_PTHREADS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PREFER_PKGSRC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PREPEND_PATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PRE_ROOT_CMD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PRIVILEGED_STAGES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PTHREAD_AUTO_VARS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PTHREAD_CFLAGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PTHREAD_LDFLAGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PTHREAD_LIBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PTHREAD_OPTS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PTHREAD_TYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PVM_SSH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PYPKGPREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PYTHON_FOR_BUILD_ONLY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PYTHON_SELF_CONFLICT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PYTHON_VERSIONED_DEPENDENCIES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PYTHON_VERSIONS_ACCEPTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PYTHON_VERSIONS_INCOMPATIBLE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PYTHON_VERSION_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">PYTHON_VERSION_REQD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">PYVERSSUFFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAILDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_ALIAS_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_DAEMON_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_LOG_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_NOFILES_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_PASSWD_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_QMAIL_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_QUEUE_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_QUEUE_EXTRA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_QUEUE_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_REMOTE_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_ROOT_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QMAIL_SEND_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QORE_LATEST_MODULE_API</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QORE_MODULE_API</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QORE_MODULE_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QORE_USER_MODULE_DIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QORE_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QPOPPER_FAC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">QPOPPER_SPOOL_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">QPOPPER_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RAKE_NAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RASMOL_DEPTH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RCD_SCRIPTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RCD_SCRIPTS_DIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RCD_SCRIPTS_EXAMPLEDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RCD_SCRIPTS_MODE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RCD_SCRIPTS_SHELL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RCD_SCRIPT_SRC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RDOC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">READLINE_DEFAULT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">READLINE_TYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REAL_ROOT_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REAL_ROOT_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RECURSIVE_MAKE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RELAY_CTRL_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RELRO_SUPPORTED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_AWK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_BASH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_CSH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_KSH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_LUA</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_NODEJS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_OCTAVE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_PERL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_PERL6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_PHP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_PYTHON</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_QORE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_R</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_RUBY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_RUBY_DIRS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_RUBY_PAT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_SH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_TEXLUA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REPLACE_WISH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQD_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQD_DIRS_PERMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQD_FILES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQD_FILES_MODE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">REQD_FILES_PERMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESOLV_AUTO_VARS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESOLV_LDFLAGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RESOLV_LIBS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ROOT_CMD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ROOT_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ROOT_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPCGEN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPM</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPM2PKG_PLIST</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPM2PKG_PREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPM2PKG_STAGE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPM2PKG_STRIP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPM2PKG_SUBPREFIX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPMFILES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPMIGNOREPATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RPM_DB_PREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSSH_CVS_PATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSSH_RDIST_PATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSSH_RSYNC_PATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSSH_SCP_PATH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RSSH_SFTP_SERVER_PATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBYGEM</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBYGEM_NAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBYGEM_OPTIONS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBYGEM_VERBOSE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_ABI_VERSION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_ARCH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_ARCHINC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_ARCHLIB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_BASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_BASERIDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_BUILD_DOCUMENT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_DLEXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_DOC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_DYNAMIC_DIRS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_EG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_ENCODING_ARG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_EXTCONF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_EXTCONF_CHECK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_EXTCONF_DEBUG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_EXTCONF_MAKEFILE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_GEM_ARCH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_GEM_BASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_INC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_LIB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_LIB_BASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_NAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_NOVERSION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_PKGPREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_RAILS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_RAILS52_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_RAILS60_VERSION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_RAILS61_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_RAILS70_VERSION</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_RAILS_ACCEPTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_RAILS_DEFAULT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_RAILS_REQD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_RAILS_STRICT_DEP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_RIDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SETUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SHLIB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SHLIBALIAS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SHLIBVER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SIMPLE_INSTALL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SITEARCHLIB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SITELIB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SITELIB_BASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SITERIDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SLEXT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SRCDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_STATICLIB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SUFFIX</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_SYSRIDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_USE_PTHREAD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_VENDORARCHLIB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_VENDORLIB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_VENDORLIB_BASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_VER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_VERSION</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_VERSIONS_ACCEPTED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_VERSIONS_INCOMPATIBLE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_VERSION_DEFAULT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_VERSION_REQD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUBY_VER_DIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUN_LDCONFIG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">RUST_TYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCREWS_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCREWS_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCRIPTS_ENV</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCROLLKEEPER_DATADIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCROLLKEEPER_REBUILDDB</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SCROLLKEEPER_UPDATEDB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SDIST_PAWD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SDL12_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SERIAL_DEVICES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SETGIDGAME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SETGID_GAMES_PERMS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SETUID_ROOT_PERMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SH</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SHLIB</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SIGN_PACKAGES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SILC_CLIENT_WITH_PERL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SITE_SPECIFIC_PKGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SKIP_DEPENDS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMF_INSTANCES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMF_MANIFEST</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMF_METHODS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMF_METHOD_SHELL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMF_METHOD_SRC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMF_NAME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMF_PREFIX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SMF_SRCDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SNIPROXY_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SNIPROXY_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SOURCE_BUFFSIZE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPECIAL_PERMS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SPECIFIC_PKGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSH_SUID</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSP_SUPPORTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SSYNC_PAWD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STEP_MSG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">STRIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STRIP_DBG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">STRIP_DEBUG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">STRIP_DEBUG_SUPPORTED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">STRIP_FILES_SKIP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SU</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBST_CLASSES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBST_FILES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBST_FILTER_CMD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBST_MESSAGE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBST_NOOP_OK</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBST_SED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBST_SHOW_DIFF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBST_SKIP_TEXT_CHECK</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBST_STAGE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUBST_VARS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUNWSPROBASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SUSE_PREFER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">SU_CMD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">SYSCONFBASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TARGET_ARCH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TBL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TERMCAP_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TERMINFO_DEFAULT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TERMINFO_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEST_DEPENDS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEST_DIRS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEST_ENV</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEST_ENV_SHELL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEST_MAKE_CMD</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEST_MAKE_FLAGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEST_TARGET</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEXLIVE_IGNORE_PATTERNS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEXLIVE_REV</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEXLIVE_UNVERSIONED</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEXMFSITE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEX_FORMATS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEX_HYPHEN_DAT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEX_HYPHEN_DEF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TEX_TEXMF_DIRS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">THTTPD_LOG_FACILITY</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TINYDYN_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TLSWRAPPER_CHROOT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TO</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_ALIASES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_ALWAYS_WRAP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_ARGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_BROKEN</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_CMD</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_CMDLINE_SED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_CREATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_CROSS_DESTDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_DIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_FAIL</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_GNU_MISSING</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_LDCONFIG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_NOOP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_PATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_SCRIPT</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOLS_USE_CROSS_COMPILE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TOOL_DEPENDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">TTF_FONTS_DIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">TYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UAC_REQD_EXECS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UCSPI_SSL_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UCSPI_SSL_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNLIMIT_RESOURCES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNPRIVILEGED</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNPRIVILEGED_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNPRIVILEGED_GROUPS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNPRIVILEGED_USER</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNWRAP_FILES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UNWRAP_PATTERNS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UPDATE_GEMSPEC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UPDATE_TARGET</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">URI</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USERGROUP_PHASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USERPPP_GROUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USER_SPECIFIC_PKGS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_ABI_DEPENDS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_APR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_BSD_MAKEFILE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_BUILTIN</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_CROSS_COMPILE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_CURSES</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_CWRAPPERS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_DB185</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_FEATURES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_GAMESGROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_GCC_RUNTIME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_IMAKE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_JAVA</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_JAVA2</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_LANGUAGES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_LIBTOOL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_NATIVE_GCC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_NETBSD_REPO</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_PKGSRC_GCC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_PKGSRC_GCC_RUNTIME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_PKGTASKS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_PKG_ADMIN_DIGEST</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_RUBY_EXTCONF</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_RUBY_INSTALL</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_RUBY_SETUP</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_RUBY_SETUP_PKG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">USE_TOOLS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">UUCP_GROUP</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">UUCP_USER</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARBASE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">VARNAME</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">VIM_EXTRA_OPTS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WARNING_MSG</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WCALC_CGIDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WCALC_CGIPATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WCALC_HTMLDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WCALC_HTMLPATH</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WDM_MANAGERS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WRAPPER_CC</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WRAPPER_REORDER_CMDS</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WRKDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WRKDIR_BASENAME</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WRKDIR_LOCKTYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WRKLOG</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">WRKOBJDIR</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">WRKSRC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X10_PORT</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X11</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X11BASE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X11_PKGSRCDIR</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X11_TYPE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">X509_CERTIFICATE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">X509_KEY</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XAW_TYPE</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XLOCK_DEFAULT_MODE</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMKMF</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">XMKMF_FLAGS</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">XXX</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">YES</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ZSH_STATIC</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><em>stdc</em></p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">_vargroups</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">accept</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">acquire-localbase-lock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">acquire-lock</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">add</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">administrator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">alloca</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">alternatives</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">aslr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">asprintf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">atlas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">autoconf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">automake</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">autoreconf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">awk</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bash</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">big-endian</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bin-install</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bind</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">binpkg-list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">blas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bootstrap-depends</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">broken</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">broken_on_platform</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">bsd</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">bsd.prog.mk</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">build</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">build-env</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">buildlink-directories</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">buildlink-oss-soundcard-h</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">c</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">c++</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ccache</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cce</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cdefs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ceil</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">changes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">changes-entry</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">changes-entry-noupdate</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">check</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">check-clean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">check-files</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">check-files-clean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">check-vulnerable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">checksum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">checksum-phase</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">clean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">clean-depends</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cleandir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">commit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">commit-changes-entry</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">compact</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">compiler</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">conf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">config.guess</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">config.sub</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configuration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">configure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configure-env</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">configure-help</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">configure_args</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">connect</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">cos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">cputime</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">create-usergroup</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">csh</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ctf</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">debug</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">declaration</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">declare</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">defined</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">depend</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dependencies</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">depends</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">depends-checksum</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">depends-fetch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">deps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">describe</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">destdir</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">disable</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">distclean</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">distinfo</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">dl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">dlopen</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">do-buildlink</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">do-clean</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">do-configure</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">do-configure-post-hook</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">do-extract</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">do-fetch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">do-install</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">emul</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">emul-distinfo</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">emul-fetch</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">emulation</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">emulator</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enable</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">endian</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">enomem</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ensurepip</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">err</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">errx</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">etc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">exp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">extract-rpm</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fabs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">feature</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">features</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fetch-list</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">follows</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">forbids</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">form</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">format</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fortify</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fortify_source</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">friend</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fts</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fts_close</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fts_open</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">fts_read</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">fts_set</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gcc</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gethostbyaddr</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gethostbyname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gethostbyname2</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">getopt_long</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">getprogname</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">getservbyname</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">getservbyport</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">getservent</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gettext</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">github</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gitlab</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">glob</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">gnu</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">gnu_configure_strict</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">go</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">go-deps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">golang</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">guess-license</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">hashbang</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">heimdal</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">help</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">imake</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">increment</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">indirect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">inet_aton</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">interp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">interpreter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">intl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ip6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ipv4</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ipv6</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">iso</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">kerberos</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">krb</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">krb5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ksh</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lapack</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">latex</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">libintl_bindtextdomain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">libintl_gettext</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">libintl_textdomain</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">libnbcompat</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">libs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">libtool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">licence</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">license</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lintl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">little-endian</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">locking</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">lua</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">lvalue</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">make</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">makesum</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">memory</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">meta</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">meta-package</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">meta_package</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mit-krb5</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mk.conf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mkl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mount</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">mprotect</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">mremap</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">nb</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nbcompat</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">netlib</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">node</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">node.js</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">nodejs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">obstack</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">obstack_ptr_grow</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">occurs</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">only</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">openblas</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">options</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">options.mk</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">order</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">override</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">override-intltool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">override-message-intltool</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">package</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">parallel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">path</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pax</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">paxctl</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pbulk-index</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pc</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">perl</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">perl5</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">perms</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">php</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pkg-build-options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pkg-config</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pkg_build_options</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">platform</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">plist</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-extract</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">post-wrapper</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-build-checks-hook</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-configure</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-configure-checks-hook</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-extract</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">pre-fetch</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">print-go-deps</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">print-plist</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">print-summary-data</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">privileged-install-hook</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">pypi</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">python</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">r</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">readme-all</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">recursive</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">recv</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">recvfrom</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">regcomp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">release-localbase-lock</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">release-lock</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">relro</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">rename</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">reorder</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">replace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">replace_interpreter</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">reproducible</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">resolv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">root</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ruby</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">send</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sendfile</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sendto</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setenv</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setgid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">setprogname</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">setuid</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sh</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">shebang</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-all</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-build-defs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-depends</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-depends-dirs</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-depends-pkgpaths</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-depends-recursive</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-deps</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-distfiles</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-downlevel</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-subdir-var</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-tools</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-var</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">show-vars</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">snprintf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">socket</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">ssp</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">st_mode</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">stage-install</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">strcasestr</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strict</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">strip</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strndup</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">strnlen</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">strsep</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">subst</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">substitutions</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sun</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">sunpro</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">sunwspro</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">symlink</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">test</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">test-env</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tex</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">texlive</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tmp</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tool</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">tools</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">tools-libtool-m4-override</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">transitive</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">type</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">ulimit</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">undefined</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">undo-replace</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unlimit</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">unprivileged</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">unprivileged-install-hook</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">unstripped</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">update</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">upload</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">upload-distfiles</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">use_tools</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">user</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">utimes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vasprintf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">verbose</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">vsnprintf</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">warn</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">warning</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">warnings</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">warnx</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">wattr_off</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">wattr_on</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">work</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">wrapper</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">wrkdir</p></td>
<td class="tableblock halign-left valign-top"></td>
</tr>
</tbody>
</table>
<h1 id="_appendix_f_editing_guidelines_for_the_pkgsrc_guide" class="sect0">Appendix F. Editing guidelines for the pkgsrc guide</h1>
<div class="paragraph">
<p>This section contains information on editing the pkgsrc guide itself.</p>
</div>
<div class="sect1">
<h2 id="_f_1_make_targets">F.1. Make targets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The pkgsrc guide&#8217;s source code is stored in <code>pkgsrc/doc/guide/files</code>, and several files are created from it:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>pkgsrc/doc/pkgsrc.txt</code></p>
</li>
<li>
<p><code>pkgsrc/doc/pkgsrc.html</code></p>
</li>
<li>
<p><a href="https://www.netbsd.org/docs/pkgsrc/">https://www.NetBSD.org/docs/pkgsrc/</a></p>
</li>
<li>
<p><a href="https://www.netbsd.org/docs/pkgsrc/pkgsrc.pdf">https://www.NetBSD.org/docs/pkgsrc/pkgsrc.pdf</a>: The PDF version of the pkgsrc guide.</p>
</li>
<li>
<p><a href="https://www.netbsd.org/docs/pkgsrc/pkgsrc.ps">https://www.NetBSD.org/docs/pkgsrc/pkgsrc.ps</a>: PostScript version of the pkgsrc guide.</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_f_2_procedure">F.2. Procedure</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The procedure to edit the pkgsrc guide is:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Make sure you have checked out the htdocs repository into a sibling directory of your pkgsrc directory. You will need the ability to commit from both pkgsrc and htdocs.</p>
</li>
<li>
<p>Make sure you have the packages needed to regenerate the pkgsrc guide (and other XML-based NetBSD documentation) installed. These are automatically installed when you install the <a href="https://cdn.netbsd.org/pub/pkgsrc/current/pkgsrc/meta-pkgs/pkgsrc-guide-tools/index.html"><code>meta-pkgs/pkgsrc-guide-tools</code></a> package.</p>
</li>
<li>
<p>Run <strong>cd doc/guide</strong> to get to the right directory. All further steps will take place here.</p>
</li>
<li>
<p>Edit the XML file(s) in <code>files/</code>.</p>
</li>
<li>
<p>Run <strong>bmake</strong> to check the pkgsrc guide for valid XML and to build the final output files. If you get any errors at this stage, you can just edit the files, as there are only symbolic links in the working directory, pointing to the files in <code>files/</code>.</p>
</li>
<li>
<p><strong>(cd files &amp;&amp; cvs commit)</strong></p>
</li>
<li>
<p>Run <strong>bmake clean &amp;&amp; bmake</strong> to regenerate the output files with the proper RCS Ids.</p>
</li>
<li>
<p>Run <strong>bmake regen</strong> to install and commit the files in both <code>pkgsrc/doc</code> and <code>htdocs</code>.</p>
</li>
</ol>
</div>
<div class="exampleblock">
<div class="content">
<div class="paragraph">
<p><strong>Note</strong></p>
</div>
<div class="paragraph">
<p>If you have added, removed or renamed some chapters, you need to synchronize them using <strong>cvs add</strong> or <strong>cvs delete</strong> in the htdocs directory.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-07-07 06:24:23 UTC
</div>
</div>
</body>
</html>